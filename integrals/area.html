<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 36&nbsp; Area under a curve</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../integrals/ftc.html" rel="next">
<link href="../integrals.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#approximating-areas" id="toc-approximating-areas" class="nav-link active" data-scroll-target="#approximating-areas"><span class="toc-section-number">36.1</span>  Approximating areas</a>
  <ul class="collapse">
  <li><a href="#adding-rectangles" id="toc-adding-rectangles" class="nav-link" data-scroll-target="#adding-rectangles"><span class="toc-section-number">36.1.1</span>  Adding rectangles</a></li>
  <li><a href="#other-sums" id="toc-other-sums" class="nav-link" data-scroll-target="#other-sums"><span class="toc-section-number">36.1.2</span>  Other sums</a></li>
  <li><a href="#some-immediate-consequences" id="toc-some-immediate-consequences" class="nav-link" data-scroll-target="#some-immediate-consequences"><span class="toc-section-number">36.1.3</span>  Some immediate consequences</a></li>
  <li><a href="#some-known-integrals" id="toc-some-known-integrals" class="nav-link" data-scroll-target="#some-known-integrals"><span class="toc-section-number">36.1.4</span>  Some known integrals</a></li>
  <li><a href="#some-other-consequences" id="toc-some-other-consequences" class="nav-link" data-scroll-target="#some-other-consequences"><span class="toc-section-number">36.1.5</span>  Some other consequences</a></li>
  </ul></li>
  <li><a href="#numeric-integration" id="toc-numeric-integration" class="nav-link" data-scroll-target="#numeric-integration"><span class="toc-section-number">36.2</span>  Numeric integration</a></li>
  <li><a href="#negative-area" id="toc-negative-area" class="nav-link" data-scroll-target="#negative-area"><span class="toc-section-number">36.3</span>  “Negative” area</a></li>
  <li><a href="#error-estimate" id="toc-error-estimate" class="nav-link" data-scroll-target="#error-estimate"><span class="toc-section-number">36.4</span>  Error estimate</a></li>
  <li><a href="#gauss-quadrature" id="toc-gauss-quadrature" class="nav-link" data-scroll-target="#gauss-quadrature"><span class="toc-section-number">36.5</span>  Gauss quadrature</a>
  <ul class="collapse">
  <li><a href="#the-quadgk-function" id="toc-the-quadgk-function" class="nav-link" data-scroll-target="#the-quadgk-function"><span class="toc-section-number">36.5.1</span>  The quadgk function</a></li>
  </ul></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="toc-section-number">36.6</span>  Questions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/integrals/area.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses these add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using Plots
using QuadGK
using Roots</code></pre>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"

using CalculusWithJulia.WeaveSupport

fig_size = (800, 600)
using Markdown, Mustache

const frontmatter = (
        title = "Area under a curve",
        description = "Calculus with Julia: Area under a curve",
        tags = ["CalculusWithJulia", "integrals", "area under a curve"],
);

nothing</code></pre>
<hr>
<p>The question of area has long fascinated human culture. As children, we learn early on the formulas for the areas of some geometric figures: a square is <span class="math inline">\(b^2\)</span>, a rectangle <span class="math inline">\(b\cdot h\)</span> a triangle <span class="math inline">\(1/2 \cdot b \cdot h\)</span> and for a circle, <span class="math inline">\(\pi r^2\)</span>. The area of a rectangle is often the intuitive basis for illustrating multiplication. The area of a triangle has been known for ages. Even complicated expressions, such as <a href="http://tinyurl.com/mqm9z">Heron’s</a> formula which relates the area of a triangle with measurements from its perimeter have been around for 2000 years. The formula for the area of a circle is also quite old. Wikipedia dates it as far back as the <a href="http://en.wikipedia.org/wiki/Rhind_Mathematical_Papyrus">Rhind</a> papyrus for 1700 BC, with the approximation of <span class="math inline">\(256/81\)</span> for <span class="math inline">\(\pi\)</span>.</p>
<p>The modern approach to area begins with a non-negative function <span class="math inline">\(f(x)\)</span> over an interval <span class="math inline">\([a,b]\)</span>. The goal is to compute the area under the graph. That is, the area between <span class="math inline">\(f(x)\)</span> and the <span class="math inline">\(x\)</span>-axis between <span class="math inline">\(a \leq x \leq b\)</span>.</p>
<p>For some functions, this area can be computed by geometry, for example, here we see the area under <span class="math inline">\(f(x)\)</span> is just <span class="math inline">\(1\)</span>, as it is a triangle with base <span class="math inline">\(2\)</span> and height <span class="math inline">\(1\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = 1 - abs(x)
plot(f, -1, 1)
plot!(zero)</code></pre>
<p>Similarly, we know this area is also <span class="math inline">\(1\)</span>, it being a square:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = 1
plot(f, 0, 1)
plot!(zero)</code></pre>
<p>This one, is simply <span class="math inline">\(\pi/2\)</span>, it being half a circle of radius <span class="math inline">\(1\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = sqrt(1 - x^2)
plot(f, -1, 1)
plot!(zero)</code></pre>
<p>And this area can be broken into a sum of the area of square and the area of a rectangle, or <span class="math inline">\(1 + 1/2\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = x &gt; 1 ? 2 - x : 1.0
plot(f, 0, 2)
plot!(zero)</code></pre>
<p>But what of more complicated areas? Can these have their area computed?</p>
<section id="approximating-areas" class="level2" data-number="36.1">
<h2 data-number="36.1" class="anchored" data-anchor-id="approximating-areas"><span class="header-section-number">36.1</span> Approximating areas</h2>
<p>In a previous section, we saw this animation:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
#| cache: true
## {{{archimedes_parabola}}}


f(x) = x^2
colors = [:black, :blue, :orange, :red, :green, :orange, :purple]

## Area of parabola

## Area of parabola
function make_triangle_graph(n)
    title = "Area of parabolic cup ..."
    n==1 &amp;&amp; (title = "Area = 1/2")
    n==2 &amp;&amp; (title = "Area = previous + 1/8")
    n==3 &amp;&amp; (title = "Area = previous + 2*(1/8)^2")
    n==4 &amp;&amp; (title = "Area = previous + 4*(1/8)^3")
    n==5 &amp;&amp; (title = "Area = previous + 8*(1/8)^4")
    n==6 &amp;&amp; (title = "Area = previous + 16*(1/8)^5")
    n==7 &amp;&amp; (title = "Area = previous + 32*(1/8)^6")



    plt = plot(f, 0, 1, legend=false, size = fig_size, linewidth=2)
    annotate!(plt, [(0.05, 0.9, text(title,:left))])  # if in title, it grows funny with gr
    n &gt;= 1 &amp;&amp; plot!(plt, [1,0,0,1, 0], [1,1,0,1,1], color=colors[1], linetype=:polygon, fill=colors[1], alpha=.2)
    n == 1 &amp;&amp; plot!(plt, [1,0,0,1, 0], [1,1,0,1,1], color=colors[1], linewidth=2)
    for k in 2:n
        xs = range(0, stop=1, length=1+2^(k-1))
        ys = map(f, xs)
        k &lt; n &amp;&amp; plot!(plt, xs, ys, linetype=:polygon, fill=:black, alpha=.2)
        if k == n
            plot!(plt, xs, ys, color=colors[k], linetype=:polygon, fill=:black, alpha=.2)
            plot!(plt, xs, ys, color=:black, linewidth=2)
        end
    end
    plt
end



n = 7
anim = @animate for i=1:n
    make_triangle_graph(i)
end

imgfile = tempname() * ".gif"
gif(anim, imgfile, fps = 1)


caption = L"""
The first triangle has area $1/2$, the second has area $1/8$, then $2$ have area $(1/8)^2$, $4$ have area $(1/8)^3$, ...
With some algebra, the total area then should be $1/2 \cdot (1 + (1/4) + (1/4)^2 + \cdots) = 2/3$.
"""

ImageFile(imgfile, caption)</code></pre>
<p>This illustrates a method of <a href="http://en.wikipedia.org/wiki/The_Quadrature_of_the_Parabola">Archimedes</a> to compute the area contained in a parabola using the method of exhaustion. Archimedes leveraged a fact he discovered relating the areas of triangle inscribed with parabolic segments to create a sum that could be computed.</p>
<p>The pursuit of computing areas persisted. The method of computing area by finding a square with an equivalent area was known as <em>quadrature</em>. Over the years, many figures had their area computed, for example, the area under the graph of the <a href="http://en.wikipedia.org/wiki/Cycloid">cycloid</a> (…Galileo tried empirically to find this using a tracing on sheet metal and a scale).</p>
<p>However, as areas of geometric objects were replaced by the more general question of area related to graphs of functions, a more general study was called for.</p>
<p>One such approach is illustrated in this figure due to Beeckman from 1618 (from <a href="http://www.math.harvard.edu/~knill/teaching/math1a_2011/exhibits/bressoud/">Bressoud</a>)</p>
<pre class="{julia}"><code>#| echo: false
imgfile = "figures/beeckman-1618.png"
caption = L"""

Figure of Beeckman (1618) showing a means to compute the area under a
curve, in this example the line connecting points $A$ and $B$. Using
approximations by geometric figures with known area is the basis of
Riemann sums.

"""
ImageFile(:integrals, imgfile, caption)
nothing</code></pre>
<p>Beeckman actually did more than find the area. He generalized the relationship of rate <span class="math inline">\(\times\)</span> time <span class="math inline">\(=\)</span> distance. The line was interpreting a velocity, the “squares”, then, provided an approximate distance traveled when the velocity is taken as a constant on the small time interval. Then the distance traveled can be approximated by a smaller quantity - just add the area of the rectangles squarely within the desired area (<span class="math inline">\(6+16+6\)</span>) - and a larger quantity - by including all rectangles that have a portion of their area within the desired area (<span class="math inline">\(10 + 16 + 10\)</span>). Beeckman argued that the error vanishes as the rectangles get smaller.</p>
<p>Adding up the smaller “squares” can be a bit more efficient if we were to add all those in a row, or column at once. We would then add the areas of a smaller number of rectangles. For this curve, the two approaches are basically identical. For other curves, identifying which squares in a row would be added is much more complicated (though useful), but for a curve generated by a function, identifying which “squares” go in a rectangle is quite easy, in fact we can see the rectangle’s area will be a base given by that of the squares, and height depending on the function.</p>
<section id="adding-rectangles" class="level3" data-number="36.1.1">
<h3 data-number="36.1.1" class="anchored" data-anchor-id="adding-rectangles"><span class="header-section-number">36.1.1</span> Adding rectangles</h3>
<p>The idea of the Riemann sum then is to approximate the area under the curve by the area of well-chosen rectangles in such a way that as the bases of the rectangles get smaller (hence adding more rectangles) the error in approximation vanishes.</p>
<p>Define a partition of <span class="math inline">\([a,b]\)</span> to be a selection of points <span class="math inline">\(a = x_0 &lt; x_1 &lt; \cdots &lt; x_{n-1} &lt; x_n = b\)</span>. The norm of the partition is the largest of all the differences <span class="math inline">\(\lvert x_i - x_{i-1} \rvert\)</span>. For a partition, consider an arbitrary selection of points <span class="math inline">\(c_i\)</span> satisfying <span class="math inline">\(x_{i-1} \leq c_i \leq x_{i}\)</span>, <span class="math inline">\(1 \leq i \leq n\)</span>. Then the following is a <strong>Riemann sum</strong>:</p>
<p><span class="math display">\[
S_n  = f(c_1) \cdot (x_1 - x_0) + f(c_2) \cdot (x_2 - x_1) + \cdots + f(c_n) \cdot (x_n - x_{n-1}).
\]</span></p>
<p>Clearly for a given partition and choice of <span class="math inline">\(c_i\)</span>, the above can be computed. Each term <span class="math inline">\(f(c_i)\cdot(x_i-x_{i-1})\)</span> can be visualized as the area of a rectangle with base spanning from <span class="math inline">\(x_{i-1}\)</span> to <span class="math inline">\(x_i\)</span> and height given by the function value at <span class="math inline">\(c_i\)</span>. The following visualizes left Riemann sums for different values of <span class="math inline">\(n\)</span> in a way that makes Beekman’s intuition plausible – that as the number of rectangles gets larger, the approximate sum will get closer to the actual area.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
rectangle(x, y, w, h) = Shape(x .+ [0,w,w,0], y .+ [0,0,h,h])
function ₙ(j)
    a = ("₋","","","₀","₁","₂","₃","₄","₅","₆","₇","₈","₉")
    join([a[Int(i)-44]  for i in string(j)])
end

function left_riemann(n)
    f = x -&gt; -(x+1/2)*(x-1)*(x-3) + 1
    p = plot(f, 1, 3, legend=false, linewidth=5)
    a, b= 1, 3
    Δ = (b-a)/n
    for i ∈ 0:n-1
        xᵢ = a + i*Δ
        plot!(rectangle(xᵢ, 0, Δ, f(xᵢ)), opacity=0.5, color=:red)
    end
    a = round(sum(f(a + i*Δ)*Δ for i ∈ 0:n-1), digits=3)

    title!("L$(ₙ(n)) = $a")
    p
end

anim = @animate for i ∈ (2,4,8,16,32,64)
    left_riemann(i)
end

imgfile = tempname() * ".gif"
gif(anim, imgfile, fps = 1)

caption = "Illustration of left Riemann sum for increasing ``n`` values"

ImageFile(imgfile, caption)</code></pre>
<p>To successfully compute a good approximation for the area, we would need to choose <span class="math inline">\(c_i\)</span> and the partition so that a formula can be found to express the dependence on the size of the partition.</p>
<p>For Archimedes’ problem - finding the area under <span class="math inline">\(f(x)=x^2\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> - if we take as a partition <span class="math inline">\(x_i = i/n\)</span> and <span class="math inline">\(c_i = x_i\)</span>, then the above sum becomes:</p>
<p><span class="math display">\[
\begin{align*}
S_n &amp;= f(c_1) \cdot (x_1 - x_0) + f(c_2) \cdot (x_2 - x_1) + \cdots + f(c_n) \cdot (x_n - x_{n-1})\\
&amp;= (x_1)^2 \cdot \frac{1}{n} + (x_2)^2 \cdot \frac{1}{n} + \cdot + (x_n)^2 \cdot \frac{1}{n}\\
&amp;= 1^2 \cdot \frac{1}{n^3}  + 2^2 \cdot \frac{1}{n^3} + \cdots + n^2 \cdot \frac{1}{n^3}\\
&amp;= \frac{1}{n^3} \cdot (1^2 + 2^2 + \cdots + n^2) \\
&amp;= \frac{1}{n^3} \cdot \frac{n\cdot(n-1)\cdot(2n+1)}{6}.
\end{align*}
\]</span></p>
<p>The latter uses a well-known formula for the sum of squares of the first <span class="math inline">\(n\)</span> natural numbers.</p>
<p>With this expression, it is readily seen that as <span class="math inline">\(n\)</span> gets large this value gets close to <span class="math inline">\(2/6 = 1/3\)</span>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The above approach, like Archimedes’, ends with a limit being taken. The answer comes from using a limit to add a big number of small values. As with all limit questions, worrying about whether a limit exists is fundamental. For this problem, we will see that for the general statement there is a stretching of the formal concept of a limit.</p>
</div>
</div>
<hr>
<p>There is a more compact notation to <span class="math inline">\(x_1 + x_2 + \cdots + x_n\)</span>, this using the <em>summation notation</em> or capital sigma. We have:</p>
<p><span class="math display">\[
\Sigma_{i = 1}^n x_i = x_1 + x_2 + \cdots + x_n
\]</span></p>
<p>The notation includes three pieces of information:</p>
<ul>
<li>The <span class="math inline">\(\Sigma\)</span> is an indication of a sum</li>
<li>The <span class="math inline">\({i=1}\)</span> and <span class="math inline">\(n\)</span> sub- and superscripts indicate the range to sum over.</li>
<li>The term <span class="math inline">\(x_i\)</span> is a general term describing the <span class="math inline">\(i\)</span>th entry, where it is understood that <span class="math inline">\(i\)</span> is just some arbitrary indexing value.</li>
</ul>
<p>With this notation, a Riemann sum can be written as <span class="math inline">\(\Sigma_{i=1}^n f(c_i)(x_i-x_{i-1})\)</span>.</p>
</section>
<section id="other-sums" class="level3" data-number="36.1.2">
<h3 data-number="36.1.2" class="anchored" data-anchor-id="other-sums"><span class="header-section-number">36.1.2</span> Other sums</h3>
<p>The choice of the <span class="math inline">\(c_i\)</span> will give different answers for the approximation, though for an integrable function these differences will vanish in the limit. Some common choices are:</p>
<ul>
<li>Using the right hand endpoint of the interval <span class="math inline">\([x_{i-1}, x_i]\)</span> giving the right-Riemann sum, <span class="math inline">\(R_n\)</span>.</li>
<li>The choice <span class="math inline">\(c_i = x_{i-1}\)</span> gives the left-Riemann sum, <span class="math inline">\(L_n\)</span>.</li>
<li>The choice <span class="math inline">\(c_i = (x_i + x_{i-1})/2\)</span> is the midpoint rule, <span class="math inline">\(M_n\)</span>.</li>
<li>If the function is continuous on the closed subinterval <span class="math inline">\([x_{i-1}, x_i]\)</span>, then it will take on its minimum and maximum values. By the extreme value theorem, we could take <span class="math inline">\(c_i\)</span> to correspond to either the maximum or the minimum. These choices give the “upper Riemann-sums” and “lower Riemann-sums”.</li>
</ul>
<p>The choice of partition can also give different answers. A common choice is to break the interval into <span class="math inline">\(n+1\)</span> equal-sized pieces. With <span class="math inline">\(\Delta = (b-a)/n\)</span>, these pieces become the arithmetic sequence <span class="math inline">\(a = a + 0 \cdot \Delta &lt; a + 1 \cdot \Delta &lt; a + 2 \cdot \Delta &lt; \cdots a + n \cdots &lt; \Delta = b\)</span> with <span class="math inline">\(x_i = a + i (b-a)/n\)</span>. (The <code>range(a, b, length=n+1)</code> command will compute these.) An alternate choice made below for one problem is to use a geometric progression:</p>
<p><span class="math display">\[
a = a(1+\alpha)^0 &lt; a(1+\alpha)^1 &lt; a (1+\alpha)^2 &lt; \cdots &lt; a (1+\alpha)^n = b.
\]</span></p>
<p>The general statement allows for any partition such that the largest gap goes to <span class="math inline">\(0\)</span>.</p>
<hr>
<p>Riemann sums weren’t named after Riemann because he was the first to approximate areas using rectangles. Indeed, others had been using even more efficient ways to compute areas for centuries prior to Riemann’s work. Rather, Riemann put the definition of the area under the curve on a firm theoretical footing with the following theorem which gives a concrete notion of what functions are integrable:</p>
<blockquote class="blockquote">
<p><strong>Riemann Integral</strong>: A function <span class="math inline">\(f\)</span> is Riemann integrable over the interval <span class="math inline">\([a,b]\)</span> and its integral will have value <span class="math inline">\(V\)</span> provided for every <span class="math inline">\(\epsilon &gt; 0\)</span> there exists a <span class="math inline">\(\delta &gt; 0\)</span> such that for any partition <span class="math inline">\(a =x_0 &lt; x_1 &lt; \cdots &lt; x_n=b\)</span> with <span class="math inline">\(\lvert x_i - x_{i-1} \rvert &lt; \delta\)</span> and for any choice of points <span class="math inline">\(x_{i-1} \leq c_i \leq x_{i}\)</span> this is satisfied:</p>
<p><span class="math display">\[
\lvert \sum_{i=1}^n f(c_i)(x_{i} - x_{i-1}) - V \rvert &lt; \epsilon.
\]</span></p>
<p>When the integral exists, it is written <span class="math inline">\(V = \int_a^b f(x) dx\)</span>.</p>
</blockquote>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
History note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The expression <span class="math inline">\(V = \int_a^b f(x) dx\)</span> is known as the <em>definite integral</em> of <span class="math inline">\(f\)</span> over <span class="math inline">\([a,b]\)</span>. Much earlier than Riemann, Cauchy had defined the definite integral in terms of a sum of rectangular products beginning with <span class="math inline">\(S=(x_1 - x_0) f(x_0) + (x_2 - x_1) f(x_1) + \cdots + (x_n - x_{n-1}) f(x_{n-1})\)</span> (the left Riemann sum). He showed the limit was well defined for any continuous function. Riemann’s formulation relaxes the choice of partition and the choice of the <span class="math inline">\(c_i\)</span> so that integrability can be better understood.</p>
</div>
</div>
</section>
<section id="some-immediate-consequences" class="level3" data-number="36.1.3">
<h3 data-number="36.1.3" class="anchored" data-anchor-id="some-immediate-consequences"><span class="header-section-number">36.1.3</span> Some immediate consequences</h3>
<p>The following formulas are consequences when <span class="math inline">\(f(x)\)</span> is integrable. These mostly follow through a judicious rearranging of the approximating sums.</p>
<p>The area is <span class="math inline">\(0\)</span> when there is no width to the interval to integrate over:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^a f(x) dx = 0.
\]</span></p>
</blockquote>
<p>Even our definition of a partition doesn’t really apply, as we assume <span class="math inline">\(a &lt; b\)</span>, but clearly if <span class="math inline">\(a=x_0=x_n=b\)</span> then our only”approximating” sum could be <span class="math inline">\(f(a)(b-a) = 0\)</span>.</p>
<p>The area under a constant function is found from the area of rectangle, a special case being <span class="math inline">\(c=0\)</span> yielding <span class="math inline">\(0\)</span> area:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b c dx = c \cdot (b-a).
\]</span></p>
</blockquote>
<p>For any partition of <span class="math inline">\(a &lt; b\)</span>, we have <span class="math inline">\(S_n = c(x_1 - x_0) + c(x_2 -x_1) + \cdots + c(x_n - x_{n-1})\)</span>. By factoring out the <span class="math inline">\(c\)</span>, we have a <em>telescoping sum</em> which means the sum simplifies to <span class="math inline">\(S_n = c(x_n-x_0) = c(b-a)\)</span>. Hence any limit must be this constant value.</p>
<p>Scaling the <span class="math inline">\(y\)</span> axis by a constant can be done before or after computing the area:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b cf(x) dx = c \int_a^b f(x) dx.
\]</span></p>
</blockquote>
<p>Let <span class="math inline">\(a=x_0 &lt; x_1 &lt; \cdots &lt; x_n=b\)</span> be any partition. Then we have <span class="math inline">\(S_n= cf(c_1)(x_1-x_0) + \cdots + cf(c_n)(x_n-x_0)\)</span> <span class="math inline">\(=\)</span> <span class="math inline">\(c\cdot\left[ f(c_1)(x_1 - x_0) + \cdots + f(c_n)(x_n - x_0)\right]\)</span>. The “limit” of the left side is <span class="math inline">\(\int_a^b c f(x) dx\)</span>. The “limit” of the right side is <span class="math inline">\(c \cdot \int_a^b f(x)\)</span>. We call this a “sketch” as a formal proof would show that for any <span class="math inline">\(\epsilon\)</span> we could choose a <span class="math inline">\(\delta\)</span> so that any partition with norm <span class="math inline">\(\delta\)</span> will yield a sum less than <span class="math inline">\(\epsilon\)</span>. Here, then our “any” partition would be one for which the <span class="math inline">\(\delta\)</span> on the left hand side applies. The computation shows that the same <span class="math inline">\(\delta\)</span> would apply for the right hand side when <span class="math inline">\(\epsilon\)</span> is the same.</p>
<p>The area is invariant under shifts left or right.</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b f(x - c) dx = \int_{a-c}^{b-c} f(x) dx.
\]</span></p>
</blockquote>
<p>Any partition <span class="math inline">\(a =x_0 &lt; x_1 &lt; \cdots &lt; x_n=b\)</span> is related to a partition of <span class="math inline">\([a-c, b-c]\)</span> through <span class="math inline">\(a-c &lt; x_0-c &lt; x_1-c &lt; \cdots &lt; x_n - c = b-c\)</span>. Let <span class="math inline">\(d_i=c_i-c\)</span> denote this partition, then we have:</p>
<p><span class="math display">\[
f(c_1 -c) \cdot (x_1 - x_0) + f(c_2 -c) \cdot (x_2 - x_1)  + \cdots + f(c_n -c) \cdot (x_n - x_{n-1}) =
f(d_1) \cdot(x_1-c - (x_0-c)) + f(d_2) \cdot(x_2-c - (x_1-c)) + \cdots + f(d_n) \cdot(x_n-c - (x_{n-1}-c)).
\]</span></p>
<p>The left side will have a limit of <span class="math inline">\(\int_a^b f(x-c) dx\)</span> the right would have a “limit” of <span class="math inline">\(\int_{a-c}^{b-c}f(x)dx\)</span>.</p>
<p>Similarly, reflections don’t effect the area under the curve, they just require a new parameterization:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b f(x) dx = \int_{-b}^{-a} f(-x) dx
\]</span></p>
</blockquote>
<p>The scaling operation <span class="math inline">\(g(x) = f(cx)\)</span> has the following:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b f(c\cdot x) dx = \frac{1}{c} \int_{ca}^{cb}f(x) dx
\]</span></p>
</blockquote>
<p>The scaling operation shifts <span class="math inline">\(a\)</span> to <span class="math inline">\(ca\)</span> and <span class="math inline">\(b\)</span> to <span class="math inline">\(cb\)</span> so the limits of integration make sense. However, the area stretches by <span class="math inline">\(c\)</span> in the <span class="math inline">\(x\)</span> direction, so must contract by <span class="math inline">\(c\)</span> in the <span class="math inline">\(y\)</span> direction to stay in balance. Hence the factor of <span class="math inline">\(1/c\)</span>.</p>
<p>Combining two operations above, the operation <span class="math inline">\(g(x) = \frac{1}{h}f(\frac{x-c}{h})\)</span> will leave the area between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> under <span class="math inline">\(g\)</span> the same as the area under <span class="math inline">\(g\)</span> between <span class="math inline">\((a-c)/h\)</span> and <span class="math inline">\((b-c)/h\)</span>.</p>
<hr>
<p>The area between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> can be broken up into the sum of the area between <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> and that between <span class="math inline">\(c\)</span> and <span class="math inline">\(b\)</span>.</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b f(x) dx = \int_a^c f(x) dx + \int_c^b f(x) dx.
\]</span></p>
</blockquote>
<p>For this, suppose we have a partition for both the integrals on the right hand side for a given <span class="math inline">\(\epsilon/2\)</span> and <span class="math inline">\(\delta\)</span>. Combining these into a partition of <span class="math inline">\([a,b]\)</span> will mean <span class="math inline">\(\delta\)</span> is still the norm. The approximating sum will combine to be no more than <span class="math inline">\(\epsilon/2 + \epsilon/2\)</span>, so for a given <span class="math inline">\(\epsilon\)</span>, this <span class="math inline">\(\delta\)</span> applies.</p>
<p>This is due to the area on the left and right of <span class="math inline">\(0\)</span> being equivalent.</p>
<p>The “reversed” area is the same, only accounted for with a minus sign.</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b f(x) dx = -\int_b^a f(x) dx.
\]</span></p>
</blockquote>
<p>A consequence of the last few statements is:</p>
<blockquote class="blockquote">
<p>If <span class="math inline">\(f(x)\)</span> is an even function, then <span class="math inline">\(\int_{-a}^a f(x) dx = 2 \int_0^a f(x) dx\)</span>. If <span class="math inline">\(f(x)\)</span> is an odd function, then <span class="math inline">\(\int_{-a}^a f(x) dx = 0\)</span>.</p>
</blockquote>
<p>If <span class="math inline">\(g\)</span> bounds <span class="math inline">\(f\)</span> then the area under <span class="math inline">\(g\)</span> will bound the area under <span class="math inline">\(f\)</span>, in particular if <span class="math inline">\(f(x)\)</span> is non negative, so will the area under <span class="math inline">\(f\)</span> be non negative for any <span class="math inline">\(a &lt; b\)</span>. (This assumes that <span class="math inline">\(g\)</span> and <span class="math inline">\(f\)</span> are integrable.)</p>
<blockquote class="blockquote">
<p>If <span class="math inline">\(0 \leq f(x) \leq g(x)\)</span> then <span class="math inline">\(\int_a^b f(x) dx \leq \int_a^b g(x) dx.\)</span></p>
</blockquote>
<p>For any partition of <span class="math inline">\([a,b]\)</span> and choice of <span class="math inline">\(c_i\)</span>, we have the term-by-term bound <span class="math inline">\(f(c_i)(x_i-x_{i-1}) \leq g(c_i)(x_i-x_{i-1})\)</span> So any sequence of partitions that converges to the limits will have this inequality maintained for the sum.</p>
</section>
<section id="some-known-integrals" class="level3" data-number="36.1.4">
<h3 data-number="36.1.4" class="anchored" data-anchor-id="some-known-integrals"><span class="header-section-number">36.1.4</span> Some known integrals</h3>
<p>Using the definition, we can compute a few definite integrals:</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b c dx = c \cdot (b-a).
\]</span></p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b x dx = \frac{b^2}{2} - \frac{a^2}{2}.
\]</span></p>
</blockquote>
<p>This is just the area of a trapezoid with heights <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and side length <span class="math inline">\(b-a\)</span>, or <span class="math inline">\(1/2 \cdot (b + a) \cdot (b - a)\)</span>. The right sum would be:</p>
<p><span class="math display">\[
\begin{align*}
S &amp;= x_1 \cdot (x_1 - x_0) + x_2 \cdot (x_2 - x_1) + \cdots x_n \cdot (x_n - x_{n-1}) \\
&amp;= (a + 1\frac{b-a}{n}) \cdot \frac{b-a}{n} + (a + 2\frac{b-a}{n}) \cdot \frac{b-a}{n} + \cdots  (a + n\frac{b-a}{n}) \cdot \frac{b-a}{n}\\
&amp;= n \cdot a \cdot (\frac{b-a}{n})  + (1 + 2 + \cdots n) \cdot (\frac{b-a}{n})^2 \\
&amp;= n \cdot a \cdot (\frac{b-a}{n})  + \frac{n(n+1)}{2} \cdot (\frac{b-a}{n})^2 \\
&amp; \rightarrow a \cdot(b-a) + \frac{(b-a)^2}{2} \\
&amp;= \frac{b^2}{2} - \frac{a^2}{2}.
\end{align*}
\]</span></p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b x^2 dx = \frac{b^3}{3} - \frac{a^3}{3}.
\]</span></p>
</blockquote>
<p>This is similar to the Archimedes case with <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=1\)</span> shown above.</p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b x^k dx = \frac{b^{k+1}}{k+1} - \frac{a^{k+1}}{k+1},\quad k \neq -1
\]</span></p>
<p>.</p>
</blockquote>
<p>Cauchy showed this using a <em>geometric series</em> for the partition, not the arithmetic series <span class="math inline">\(x_i = a + i (b-a)/n\)</span>. The series defined by <span class="math inline">\(1 + \alpha = (b/a)^{1/n}\)</span>, then <span class="math inline">\(x_i = a \cdot (1 + \alpha)^i\)</span>. Here the bases <span class="math inline">\(x_{i+1} - x_i\)</span> simplify to <span class="math inline">\(x_i \cdot \alpha\)</span> and <span class="math inline">\(f(x_i) = (a\cdot(1+\alpha)^i)^k = a^k (1+\alpha)^{ik}\)</span>, or <span class="math inline">\(f(x_i)(x_{i+1}-x_i) = a^{k+1}\alpha[(1+\alpha)^{k+1}]^i\)</span>, so, using <span class="math inline">\(u=(1+\alpha)^{k+1}=(b/a)^{(k+1)/n}\)</span>, <span class="math inline">\(f(x_i) \cdot(x_{i+1} - x_i) = a^{k+1}\alpha u^i\)</span>. This gives</p>
<p><span class="math display">\[
\begin{align*}
S &amp;= a^{k+1}\alpha u^0 + a^{k+1}\alpha u^1 + \cdots + a^{k+1}\alpha u^{n-1}
&amp;= a^{k+1} \cdot \alpha \cdot (u^0 + u^1 + \cdot u^{n-1}) \\
&amp;= a^{k+1} \cdot \alpha \cdot \frac{u^n - 1}{u - 1}\\
&amp;= (b^{k+1} - a^{k+1}) \cdot \frac{\alpha}{(1+\alpha)^{k+1} - 1} \\
&amp;\rightarrow \frac{b^{k+1} - a^{k+1}}{k+1}.
\end{align*}
\]</span></p>
<blockquote class="blockquote">
<p><span class="math display">\[
\int_a^b x^{-1} dx = \log(b) - \log(a), \quad (0 &lt; a &lt; b).
\]</span></p>
</blockquote>
<p>Again, Cauchy showed this using a geometric series. The expression <span class="math inline">\(f(x_i) \cdot(x_{i+1} - x_i)\)</span> becomes just <span class="math inline">\(\alpha\)</span>. So the approximating sum becomes:</p>
<p><span class="math display">\[
S = f(x_0)(x_1 - x_0) + f(x_1)(x_2 - x_1) + \cdots + f(x_{n-1}) (x_n - x_{n-1}) = \alpha + \alpha + \cdots \alpha = n\alpha.
\]</span></p>
<p>But, letting <span class="math inline">\(x = 1/n\)</span>, the limit above is just the limit of</p>
<p><span class="math display">\[
\lim_{x \rightarrow 0+} \frac{(b/a)^x - 1}{x} = \log(b/a) = \log(b) - \log(a).
\]</span></p>
<p>(Using L’Hopital’s rule to compute the limit.)</p>
<p>Certainly other integrals could be computed with various tricks, but we won’t pursue this. There is another way to evaluate integrals using the forthcoming Fundamental Theorem of Calculus.</p>
</section>
<section id="some-other-consequences" class="level3" data-number="36.1.5">
<h3 data-number="36.1.5" class="anchored" data-anchor-id="some-other-consequences"><span class="header-section-number">36.1.5</span> Some other consequences</h3>
<ul>
<li>The definition is defined in terms of any partition with its norm bounded by <span class="math inline">\(\delta\)</span>. If you know a function <span class="math inline">\(f\)</span> is Riemann integrable, then it is enough to consider just a regular partition <span class="math inline">\(x_i = a + i \cdot (b-a)/n\)</span> when forming the sums, as was done above. It is just that showing a limit for just this particular type of partition would not be sufficient to prove Riemann integrability.</li>
<li>The choice of <span class="math inline">\(c_i\)</span> is arbitrary to allow for maximum flexibility. The Darboux integrals use the maximum and minimum over the subinterval. It is sufficient to prove integrability to show that the limit exists with just these choices.</li>
<li>Most importantly,</li>
</ul>
<blockquote class="blockquote">
<p>A continuous function on <span class="math inline">\([a,b]\)</span> is Riemann integrable on <span class="math inline">\([a,b]\)</span>.</p>
</blockquote>
<p>The main idea behind this is that the difference between the maximum and minimum values over a partition gets small. That is if <span class="math inline">\([x_{i-1}, x_i]\)</span> is like <span class="math inline">\(1/n\)</span> is length, then the difference between the maximum of <span class="math inline">\(f\)</span> over this interval, <span class="math inline">\(M\)</span>, and the minimum, <span class="math inline">\(m\)</span> over this interval will go to zero as <span class="math inline">\(n\)</span> gets big. That <span class="math inline">\(m\)</span> and <span class="math inline">\(M\)</span> exists is due to the extreme value theorem, that this difference goes to <span class="math inline">\(0\)</span> is a consequence of continuity. What is needed is that this value goes to <span class="math inline">\(0\)</span> at the same rate – no matter what interval is being discussed – is a consequence of a notion of uniform continuity, a concept discussed in advanced calculus, but which holds for continuous functions on closed intervals. Armed with this, the Riemann sum for a general partition can be bounded by this difference times <span class="math inline">\(b-a\)</span>, which will go to zero. So the upper and lower Riemann sums will converge to the same value.</p>
<ul>
<li>A “jump”, or discontinuity of the first kind, is a value <span class="math inline">\(c\)</span> in <span class="math inline">\([a,b]\)</span> where <span class="math inline">\(\lim_{x \rightarrow c+} f(x)\)</span> and <span class="math inline">\(\lim_{x \rightarrow c-}f(x)\)</span> both exist, but are not equal. It is true that a function that is not continuous on <span class="math inline">\(I=[a,b]\)</span>, but only has discontinuities of the first kind on <span class="math inline">\(I\)</span> will be Riemann integrable on <span class="math inline">\(I\)</span>.</li>
</ul>
<p>For example, the function <span class="math inline">\(f(x) = 1\)</span> for <span class="math inline">\(x\)</span> in <span class="math inline">\([0,1]\)</span> and <span class="math inline">\(0\)</span> otherwise will be integrable, as it is continuous at all but two points, <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, where it jumps.</p>
<ul>
<li>Some functions can have infinitely many points of discontinuity and still be integrable. The example of <span class="math inline">\(f(x) = 1/q\)</span> when <span class="math inline">\(x=p/q\)</span> is rational, and <span class="math inline">\(0\)</span> otherwise is often used as an example.</li>
</ul>
</section>
</section>
<section id="numeric-integration" class="level2" data-number="36.2">
<h2 data-number="36.2" class="anchored" data-anchor-id="numeric-integration"><span class="header-section-number">36.2</span> Numeric integration</h2>
<p>The Riemann sum approach gives a method to approximate the value of a definite integral. We just compute an approximating sum for a large value of <span class="math inline">\(n\)</span>, so large that the limiting value and the approximating sum are close.</p>
<p>To see the mechanics, let’s again return to Archimedes’ problem and compute <span class="math inline">\(\int_0^1 x^2 dx\)</span>.</p>
<p>Let us fix some values:</p>
<pre class="{julia}"><code>a, b = 0, 1
f(x) = x^2</code></pre>
<p>Then for a given <span class="math inline">\(n\)</span> we have some steps to do: create the partition, find the <span class="math inline">\(c_i\)</span>, multiply the pieces and add up. Here is one way to do all this:</p>
<pre class="{julia}"><code>n = 5
xs = a:(b-a)/n:b       # also range(a, b, length=n)
deltas = diff(xs)      # forms x2-x1, x3-x2, ..., xn-xn-1
cs = xs[1:end-1]       # finds left-hand end points. xs[2:end] would be right-hand ones.</code></pre>
<p>Now to multiply the values. We want to sum the product <code>f(cs[i]) * deltas[i]</code>, here is one way to do so:</p>
<pre class="{julia}"><code>sum(f(cs[i]) * deltas[i] for i in 1:length(deltas))</code></pre>
<p>Our answer is not so close to the value of <span class="math inline">\(1/3\)</span>, but what did we expect - we only used <span class="math inline">\(n=5\)</span> intervals. Trying again with <span class="math inline">\(50,000\)</span> gives us:</p>
<pre class="{julia}"><code>#| hold: true
n = 50_000
xs = a:(b-a)/n:b
deltas = diff(xs)
cs = xs[1:end-1]
sum(f(cs[i]) * deltas[i] for i in 1:length(deltas))</code></pre>
<p>This value is about <span class="math inline">\(10^{-5}\)</span> off from the actual answer of <span class="math inline">\(1/3\)</span>.</p>
<p>We should expect that larger values of <span class="math inline">\(n\)</span> will produce better approximate values, as long as numeric issues don’t get involved.</p>
<p>Before continuing, we define a function to compute the Riemann sum for us with an extra argument to specifying one of four methods for computing <span class="math inline">\(c_i\)</span>:</p>
<pre class="{julia}"><code>#| eval: false
function riemann(f::Function, a::Real, b::Real, n::Int; method="right")
    if method == "right"
        meth = f -&gt; (lr -&gt; begin l,r = lr; f(r) * (r-l) end)
    elseif method == "left"
        meth = f -&gt; (lr -&gt; begin l,r = lr; f(l) * (r-l) end)
    elseif method == "trapezoid"
        meth = f -&gt; (lr -&gt; begin l,r = lr; (1/2) * (f(l) + f(r)) * (r-l) end)
    elseif method == "simpsons"
        meth = f -&gt; (lr -&gt; begin l,r=lr; (1/6) * (f(l) + 4*(f((l+r)/2)) + f(r)) * (r-l) end)
    end

    xs = range(a, b, n+1)
    pairs = zip(xs[begin:end-1], xs[begin+1:end]) # (x₀,x₁), …, (xₙ₋₁,xₙ)
    sum(meth(f), pairs)

end</code></pre>
<p>(This function is defined in <code>CalculusWithJulia</code> and need not be copied over if that package is loaded.)</p>
<p>With this, we can easily find an approximate answer. We wrote the function to use the familiar template <code>action(function, arguments...)</code>, so we pass in a function and arguments to describe the problem (<code>a</code>, <code>b</code>, and <code>n</code> and, optionally, the <code>method</code>):</p>
<pre class="{julia}"><code>𝒇(x) = exp(x)
riemann(𝒇, 0, 5, 10)   # S_10</code></pre>
<p>Or with more intervals in the partition</p>
<pre class="{julia}"><code>riemann(𝒇, 0, 5, 50_000)</code></pre>
<p>(The answer is <span class="math inline">\(e^5 - e^0 = 147.4131591025766\dots\)</span>, which shows that even <span class="math inline">\(50,000\)</span> partitions is not enough to guarantee many digits of accuracy.)</p>
</section>
<section id="negative-area" class="level2" data-number="36.3">
<h2 data-number="36.3" class="anchored" data-anchor-id="negative-area"><span class="header-section-number">36.3</span> “Negative” area</h2>
<p>So far, we have had the assumption that <span class="math inline">\(f(x) \geq 0\)</span>, as that allows us to define the concept of area. We can define the signed area between <span class="math inline">\(f(x)\)</span> and the <span class="math inline">\(x\)</span> axis through the definite integral:</p>
<p><span class="math display">\[
A = \int_a^b f(x) dx.
\]</span></p>
<p>The right hand side is defined whenever the Riemann limit exists and in that case we call <span class="math inline">\(f(x)\)</span> Riemann integrable. (The definition does not suppose <span class="math inline">\(f\)</span> is non-negative.)</p>
<p>Suppose <span class="math inline">\(f(a) = f(b) = 0\)</span> for <span class="math inline">\(a &lt; b\)</span> and for all <span class="math inline">\(a &lt; x &lt; b\)</span> we have <span class="math inline">\(f(x) &lt; 0\)</span>. Then we can see easily from the geometry (or from the Riemann sum approximation) that</p>
<p><span class="math display">\[
\int_a^b f(x) dx = - \int_a^b \lvert f(x) \rvert dx.
\]</span></p>
<p>If we think of the area below the <span class="math inline">\(x\)</span> axis as “signed” area carrying a minus sign, then the total area can be seen again as a sum, only this time some of the summands may be negative.</p>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example</h5>
<p>Consider a function <span class="math inline">\(g(x)\)</span> defined through its piecewise linear graph:</p>
<pre class="{julia}"><code>#| echo: false
g(x) = abs(x) &gt; 2 ? 1.0 : abs(x) - 1.0
plot(g, -3,3)
plot!(zero)</code></pre>
<ul>
<li>Compute <span class="math inline">\(\int_{-3}^{-1} g(x) dx\)</span>. The area comprised of a square of area <span class="math inline">\(1\)</span> and a triangle with area <span class="math inline">\(1/2\)</span>, so should be <span class="math inline">\(3/2\)</span>.</li>
<li>Compute <span class="math inline">\(\int_{-3}^{0} g(x) dx\)</span>. In addition to the above, there is a triangle with area <span class="math inline">\(1/2\)</span>, but since the function is negative, this area is added in as <span class="math inline">\(-1/2\)</span>. In total then we have <span class="math inline">\(1 + 1/2 - 1/2 = 1\)</span> for the answer.</li>
<li>Compute <span class="math inline">\(\int_{-3}^{1} g(x) dx\)</span>:</li>
</ul>
<p>We could add the signed area over <span class="math inline">\([0,1]\)</span> to the above, but instead see a square of area <span class="math inline">\(1\)</span>, a triangle with area <span class="math inline">\(1/2\)</span> and a triangle with signed area <span class="math inline">\(-1\)</span>. The total is then <span class="math inline">\(1/2\)</span>.</p>
<ul>
<li>Compute <span class="math inline">\(\int_{-3}^{3} g(x) dx\)</span>:</li>
</ul>
<p>We could add the area, but let’s use a symmetry trick. This is clearly twice our second answer, or <span class="math inline">\(2\)</span>. (This is because <span class="math inline">\(g(x)\)</span> is an even function, as we can tell from the graph.)</p>
</section>
<section id="example-1" class="level5">
<h5 class="anchored" data-anchor-id="example-1">Example</h5>
<p>Suppose <span class="math inline">\(f(x)\)</span> is an odd function, then <span class="math inline">\(f(x) = - f(-x)\)</span> for any <span class="math inline">\(x\)</span>. So the signed area between <span class="math inline">\([-a,0]\)</span> is related to the signed area between <span class="math inline">\([0,a]\)</span> but of different sign. This gives <span class="math inline">\(\int_{-a}^a f(x) dx = 0\)</span> for odd functions.</p>
<p>An immediate consequence would be <span class="math inline">\(\int_{-\pi}^\pi \sin(x) = 0\)</span>, as would <span class="math inline">\(\int_{-a}^a x^k dx\)</span> for any <em>odd</em> integer <span class="math inline">\(k &gt; 0\)</span>.</p>
</section>
<section id="example-2" class="level5">
<h5 class="anchored" data-anchor-id="example-2">Example</h5>
<p>Numerically estimate the definite integral <span class="math inline">\(\int_0^e x\log(x) dx\)</span>. (We redefine the function to be <span class="math inline">\(0\)</span> at <span class="math inline">\(0\)</span>, so it is continuous.)</p>
<p>We have to be a bit careful with the Riemann sum, as the left Riemann sum will have an issue at <span class="math inline">\(0=x_0\)</span> (<code>0*log(0)</code> returns <code>NaN</code> which will poison any subsequent arithmetic operations, so the value returned will be <code>NaN</code> and not an approximate answer). We could define our function with a check:</p>
<pre class="{julia}"><code>𝒉(x) = x &gt; 0 ? x * log(x) : 0.0</code></pre>
<p>This is actually inefficient, as the check for the size of <code>x</code> will slow things down a bit. Since we will call this function 50,000 times, we would like to avoid this, if we can. In this case just using the right sum will work:</p>
<pre class="{julia}"><code>h(x) = x * log(x)
riemann(h, 0, 2, 50_000, method="right")</code></pre>
<p>(The default is <code>"right"</code>, so no method specified would also work.)</p>
</section>
<section id="example-3" class="level5">
<h5 class="anchored" data-anchor-id="example-3">Example</h5>
<p>Let <span class="math inline">\(j(x) = \sqrt{1 - x^2}\)</span>. The area under the curve between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span> is <span class="math inline">\(\pi/2\)</span>. Using a Riemann sum with 4 equal subintervals and the midpoint, estimate <span class="math inline">\(\pi\)</span>. How close are you?</p>
<p>The partition is <span class="math inline">\(-1 &lt; -1/2 &lt; 0 &lt; 1/2 &lt; 1\)</span>. The midpoints are <span class="math inline">\(-3/4, -1/4, 1/4, 3/4\)</span>. We thus have that <span class="math inline">\(\pi/2\)</span> is approximately:</p>
<pre class="{julia}"><code>#| hold: true
xs = range(-1, 1, length=5)
deltas = diff(xs)
cs = [-3/4, -1/4, 1/4, 3/4]
j(x) = sqrt(1 - x^2)
a = sum(j(c)*delta for (c,delta) in zip(cs, deltas))
a, pi/2  # π ≈  2a</code></pre>
<p>(For variety, we used an alternate way to sum over two vectors.)</p>
<p>So <span class="math inline">\(\pi\)</span> is about <code>2a</code>.</p>
</section>
<section id="example-4" class="level5">
<h5 class="anchored" data-anchor-id="example-4">Example</h5>
<p>We have the well-known triangle <a href="http://en.wikipedia.org/wiki/Triangle_inequality">inequality</a> which says for an individual sum: <span class="math inline">\(\lvert a + b \rvert \leq \lvert a \rvert +\lvert b \rvert\)</span>. Applying this recursively to a partition with <span class="math inline">\(a &lt; b\)</span> gives:</p>
<p><span class="math display">\[
\begin{align*}
\lvert f(c_1)(x_1-x_0) + f(c_2)(x_2-x_1) + \cdots + f(c_n) (x_n-x_1) \rvert
&amp; \leq
\lvert f(c_1)(x_1-x_0) \rvert + \lvert f(c_2)(x_2-x_1)\rvert + \cdots +\lvert f(c_n) (x_n-x_1) \rvert \\
&amp;= \lvert f(c_1)\rvert (x_1-x_0) + \lvert f(c_2)\rvert (x_2-x_1)+ \cdots +\lvert f(c_n) \rvert(x_n-x_1).
\end{align*}
\]</span></p>
<p>This suggests that the following inequality holds for integrals:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(\lvert \int_a^b f(x) dx \rvert \leq \int_a^b \lvert f(x) \rvert dx\)</span>.</p>
</blockquote>
<p>This can be used to give bounds on the size of an integral. For example, suppose you know that <span class="math inline">\(f(x)\)</span> is continuous on <span class="math inline">\([a,b]\)</span> and takes its maximum value of <span class="math inline">\(M\)</span> and minimum value of <span class="math inline">\(m\)</span>. Letting <span class="math inline">\(K\)</span> be the larger of <span class="math inline">\(\lvert M\rvert\)</span> and <span class="math inline">\(\lvert m \rvert\)</span>, gives this bound when <span class="math inline">\(a &lt; b\)</span>:</p>
<p><span class="math display">\[
\lvert\int_a^b f(x) dx \rvert \leq \int_a^b \lvert f(x) \rvert dx \leq \int_a^b K dx = K(b-a).
\]</span></p>
<p>While such bounds are disappointing, often, when looking for specific values, they are very useful when establishing general truths, such as is done with proofs.</p>
</section>
</section>
<section id="error-estimate" class="level2" data-number="36.4">
<h2 data-number="36.4" class="anchored" data-anchor-id="error-estimate"><span class="header-section-number">36.4</span> Error estimate</h2>
<p>The Riemann sum above is actually extremely inefficient. To see how much, we can derive an estimate for the error in approximating the value using an arithmetic progression as the partition. Let’s assume that our function <span class="math inline">\(f(x)\)</span> is increasing, so that the right sum gives an upper estimate and the left sum a lower estimate, so the error in the estimate will be between these two values:</p>
<p><span class="math display">\[
\begin{align*}
\text{error} &amp;\leq
\left[
f(x_1) \cdot (x_{1} - x_0)  + f(x_2) \cdot  (x_{2} - x_1) + \cdots + f(x_{n-1})(x_{n-1} - x_n) + f(x_n) \cdot (x_n - x_{n-1})\right]\\
&amp;-
\left[f(x_0) \cdot (x_{1} - x_0)  + f(x_1) \cdot  (x_{2} - x_1) + \cdots + f(x_{n-1})(x_{n-1} - x_n)\right] \\
&amp;= \frac{b-a}{n} \cdot (\left[f(x_1) + f(x_2) + \cdots f(x_n)\right] - \left[f(x_0) + \cdots f(x_{n-1})\right]) \\
&amp;= \frac{b-a}{n} \cdot (f(b) - f(a)).
\end{align*}
\]</span></p>
<p>We see the error goes to <span class="math inline">\(0\)</span> at a rate of <span class="math inline">\(1/n\)</span> with the constant depending on <span class="math inline">\(b-a\)</span> and the function <span class="math inline">\(f\)</span>. In general, a similar bound holds when <span class="math inline">\(f\)</span> is not monotonic.</p>
<p>There are other ways to approximate the integral that use fewer points in the partition. <a href="http://tinyurl.com/7b9pmu">Simpson’s</a> rule is one, where instead of approximating the area with rectangles that go through some <span class="math inline">\(c_i\)</span> in <span class="math inline">\([x_{i-1}, x_i]\)</span> instead the function is approximated by the quadratic polynomial going through <span class="math inline">\(x_{i-1}\)</span>, <span class="math inline">\((x_i + x_{i-1})/2\)</span>, and <span class="math inline">\(x_i\)</span> and the exact area under that polynomial is used in the approximation. The explicit formula is:</p>
<p><span class="math display">\[
A \approx \frac{b-a}{3n} (f(x_0) + 4 f(x_1) + 2f(x_2) + 4f(x_3) + \cdots + 2f(x_{n-2}) + 4f(x_{n-1}) + f(x_n)).
\]</span></p>
<p>The error in this approximation can be shown to be</p>
<p><span class="math display">\[
\text{error} \leq \frac{(b-a)^5}{180n^4} \text{max}_{\xi \text{ in } [a,b]} \lvert f^{(4)}(\xi) \rvert.
\]</span></p>
<p>That is, the error is like <span class="math inline">\(1/n^4\)</span> with constants depending on the length of the interval, <span class="math inline">\((b-a)^5\)</span>, and the maximum value of the fourth derivative over <span class="math inline">\([a,b]\)</span>. This is significant, the error in <span class="math inline">\(10\)</span> steps of Simpson’s rule is on the scale of the error of <span class="math inline">\(10,000\)</span> steps of the Riemann sum for well-behaved functions.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Wikipedia article mentions that Kepler used a similar formula <span class="math inline">\(100\)</span> years prior to Simpson, or about <span class="math inline">\(200\)</span> years before Riemann published his work. Again, the value in Riemann’s work is not the computation of the answer, but the framework it provides in determining if a function is Riemann integrable or not.</p>
</div>
</div>
</section>
<section id="gauss-quadrature" class="level2" data-number="36.5">
<h2 data-number="36.5" class="anchored" data-anchor-id="gauss-quadrature"><span class="header-section-number">36.5</span> Gauss quadrature</h2>
<p>The formula for Simpson’s rule was the <em>composite</em> formula. If just a single rectangle is approximated over <span class="math inline">\([a,b]\)</span> by a parabola interpolating the points <span class="math inline">\(x_1=a\)</span>, <span class="math inline">\(x_2=(a+b)/2\)</span>, and <span class="math inline">\(x_3=b\)</span>, the formula is:</p>
<p><span class="math display">\[
\frac{b-a}{6}(f(x_1) + 4f(x_2) + f(x_3)).
\]</span></p>
<p>This formula will actually be exact for any 3rd degree polynomial. In fact an entire family of similar approximations using <span class="math inline">\(n\)</span> points can be made exact for any polynomial of degree <span class="math inline">\(n-1\)</span> or lower. But with non-evenly spaced points, even better results can be found.</p>
<p>The formulas for an approximation to the integral <span class="math inline">\(\int_{-1}^1 f(x) dx\)</span> discussed so far can be written as:</p>
<p><span class="math display">\[
\begin{align*}
S &amp;= f(x_1) \Delta_1 + f(x_2) \Delta_2 + \cdots + f(x_n) \Delta_n\\
  &amp;= w_1 f(x_1) + w_2 f(x_2) + \cdots + w_n f(x_n).
\end{align*}
\]</span></p>
<p>The <span class="math inline">\(w\)</span>s are “weights” and the <span class="math inline">\(x\)</span>s are nodes. A <a href="http://en.wikipedia.org/wiki/Gaussian_quadrature">Gaussian</a> <em>quadrature rule</em> is a set of weights and nodes for <span class="math inline">\(i=1, \dots n\)</span> for which the sum is <em>exact</em> for any <span class="math inline">\(f\)</span> which is a polynomial of degree <span class="math inline">\(2n-1\)</span> or less. Such choices then also approximate well the integrals of functions which are not polynomials of degree <span class="math inline">\(2n-1\)</span>, provided <span class="math inline">\(f\)</span> can be well approximated by a polynomial over <span class="math inline">\([-1,1]\)</span>. (Which is the case for the “nice” functions we encounter.) Some examples are given in the questions.</p>
<section id="the-quadgk-function" class="level3" data-number="36.5.1">
<h3 data-number="36.5.1" class="anchored" data-anchor-id="the-quadgk-function"><span class="header-section-number">36.5.1</span> The quadgk function</h3>
<p>In <code>Julia</code> a modification of the Gauss quadrature rule is implemented in the <code>quadgk</code> function (from the <code>QuadGK</code> package) to give numeric approximations to integrals. The <code>quadgk</code> function also has the familiar interface <code>action(function, arguments...)</code>. Unlike our <code>riemann</code> function, there is no <code>n</code> specified, as the number of steps is <em>adaptively</em> determined. (There is more partitioning occurring where the function is changing rapidly.) Instead, the algorithm outputs an estimate on the possible error along with the answer. Instead of <span class="math inline">\(n\)</span>, some trickier problems require a specification of an error threshold.</p>
<p>To use the function, we have:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = x * log(x)
quadgk(f, 0, 2)</code></pre>
<p>As mentioned, there are two values returned: an approximate answer, and an error estimate. In this example we see that the value of <span class="math inline">\(0.3862943610307017\)</span> is accurate to within <span class="math inline">\(10^{-9}\)</span>. (The actual answer is <span class="math inline">\(-1 + 2\cdot \log(2)\)</span> and the error is only <span class="math inline">\(10^{-11}\)</span>. The reported error is an upper bound, and may be conservative, as with this problem.) Our previous answer using <span class="math inline">\(50,000\)</span> right-Riemann sums was <span class="math inline">\(0.38632208884775737\)</span> and is only accurate to <span class="math inline">\(10^{-5}\)</span>. By contrast, this method uses just <span class="math inline">\(256\)</span> function evaluations in the above problem.</p>
<p>The method should be exact for polynomial functions:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = x^5 - x + 1
quadgk(f, -2, 2)</code></pre>
<p>The error term is <span class="math inline">\(0\)</span>, answer is <span class="math inline">\(4\)</span> up to the last unit of precision (1 ulp), so any error is only in floating point approximations.</p>
<p>For the numeric computation of definite integrals, the <code>quadgk</code> function should be used over the Riemann sums or even Simpson’s rule.</p>
<p>Here are some sample integrals computed with <code>quadgk</code>:</p>
<p><span class="math display">\[
\int_0^\pi \sin(x) dx
\]</span></p>
<pre class="{julia}"><code>quadgk(sin, 0, pi)</code></pre>
<p>(Again, the actual answer is off only in the last digit, the error estimate is an upper bound.)</p>
<p><span class="math display">\[
\int_0^2 x^x dx
\]</span></p>
<pre class="{julia}"><code>quadgk(x -&gt; x^x, 0, 2)</code></pre>
<p><span class="math display">\[
\int_0^5 e^x dx
\]</span></p>
<pre class="{julia}"><code>quadgk(exp, 0, 5)</code></pre>
<p>When composing the answer with other functions it may be desirable to drop the error in the answer. Two styles can be used for this. The first is to just name the two returned values:</p>
<pre class="{julia}"><code>#| hold: true
A, err = quadgk(cos, 0, pi/4)
A</code></pre>
<p>The second is to ask for just the first component of the returned value:</p>
<pre class="{julia}"><code>#| hold: true
A = quadgk(tan, 0, pi/4)[1] # or first(quadgk(tan, 0, pi/4))</code></pre>
<hr>
<p>To visualize the choice of nodes by the algorithm, we have for <span class="math inline">\(f(x)=\sin(x)\)</span> over <span class="math inline">\([0,\pi]\)</span> relatively few nodes used to get a high-precision estimate:</p>
<pre class="{julia}"><code>#| echo: false
function FnWrapper(f)
    xs=Any[]
    ys=Any[]
    x -&gt; begin
        fx = f(x)
        push!(xs, x)
        push!(ys, fx)
        fx
    end
end
nothing</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
let
    a, b= 0, pi
    f(x) = sin(x)
    F = FnWrapper(f)
    ans,err = quadgk(F, a, b)
    plot(f, a, b, legend=false, title="Error ≈ $(round(err,sigdigits=2))")
            scatter!(F.xs, F.ys)
end</code></pre>
<p>For a more oscillatory function, more nodes are chosen:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
let
    a, b= 0, pi
    f(x) = exp(-x)*sinpi(x)
    F = FnWrapper(f)
    ans,err = quadgk(F, a, b)
    plot(f, a, b, legend=false, title="Error ≈ $(round(err,sigdigits=2))")
    scatter!(F.xs, F.ys)
end</code></pre>
<section id="example-5" class="level5">
<h5 class="anchored" data-anchor-id="example-5">Example</h5>
<p>In probability theory, a <em>univariate density</em> is a function, <span class="math inline">\(f(x)\)</span> such that <span class="math inline">\(f(x) \geq 0\)</span> and <span class="math inline">\(\int_a^b f(x) dx = 1\)</span>, where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the range of the distribution. The <a href="http://en.wikipedia.org/wiki/Von_Mises_distribution">Von Mises</a> distribution, takes the form</p>
<p><span class="math display">\[
k(x) = C \cdot \exp(\cos(x)), \quad -\pi \leq x \leq \pi
\]</span></p>
<p>Compute <span class="math inline">\(C\)</span> (numerically).</p>
<p>The fact that <span class="math inline">\(1 = \int_{-\pi}^\pi C \cdot \exp(\cos(x)) dx = C \int_{-\pi}^\pi \exp(\cos(x)) dx\)</span> implies that <span class="math inline">\(C\)</span> is the reciprocal of</p>
<pre class="{julia}"><code>k(x) = exp(cos(x))
A,err = quadgk(k, -pi, pi)</code></pre>
<p>So</p>
<pre class="{julia}"><code>C = 1/A
k₁(x) = C * exp(cos(x))</code></pre>
<p>The <em>cumulative distribution function</em> for <span class="math inline">\(k(x)\)</span> is <span class="math inline">\(K(x) = \int_{-\pi}^x k(u) du\)</span>, <span class="math inline">\(-\pi \leq x \leq \pi\)</span>. We just showed that <span class="math inline">\(K(\pi) = 1\)</span> and it is trivial that <span class="math inline">\(K(-\pi) = 0\)</span>. The quantiles of the distribution are the values <span class="math inline">\(q_1\)</span>, <span class="math inline">\(q_2\)</span>, and <span class="math inline">\(q_3\)</span> for which <span class="math inline">\(K(q_i) = i/4\)</span>. Can we find these?</p>
<p>First we define a function, that computes <span class="math inline">\(K(x)\)</span>:</p>
<pre class="{julia}"><code>K(x) = quadgk(k₁, -pi, x)[1]</code></pre>
<p>(The trailing <code>[1]</code> is so only the answer - and not the error - is returned.)</p>
<p>The question asks us to solve <span class="math inline">\(K(x) = 0.25\)</span>, <span class="math inline">\(K(x) = 0.5\)</span> and <span class="math inline">\(K(x) = 0.75\)</span>. The <code>Roots</code> package can be used for such work, in particular <code>find_zero</code>. We will use a bracketing method, as clearly <span class="math inline">\(K(x)\)</span> is increasing, as <span class="math inline">\(k(u)\)</span> is positive, so we can just bracket our answer with <span class="math inline">\(-\pi\)</span> and <span class="math inline">\(\pi\)</span>. (We solve <span class="math inline">\(K(x) - p = 0\)</span>, so <span class="math inline">\(K(\pi) - p &gt; 0\)</span> and <span class="math inline">\(K(-\pi)-p &lt; 0\)</span>.). We could do this with <code>[find_zero(x -&gt; K(x) - p, (-pi, pi)) for p in [0.25, 0.5, 0.75]]</code>, but that is a bit less performant than using the <code>solve</code> interface for this task:</p>
<pre class="{julia}"><code>#| hold: true
Z = ZeroProblem((x,p) -&gt; K(x) - p, (-pi, pi))
solve.(Z, (1/4, 1/2, 3/4))</code></pre>
<p>The middle one is clearly <span class="math inline">\(0\)</span>. This distribution is symmetric about <span class="math inline">\(0\)</span>, so half the area is to the right of <span class="math inline">\(0\)</span> and half to the left, so clearly when <span class="math inline">\(p=0.5\)</span>, <span class="math inline">\(x\)</span> is <span class="math inline">\(0\)</span>. The other two show that the area to the left of <span class="math inline">\(-0.809767\)</span> is equal to the area to the right of <span class="math inline">\(0.809767\)</span> and equal to <span class="math inline">\(0.25\)</span>.</p>
</section>
</section>
</section>
<section id="questions" class="level2" data-number="36.6">
<h2 data-number="36.6" class="anchored" data-anchor-id="questions"><span class="header-section-number">36.6</span> Questions</h2>
<section id="question" class="level6">
<h6 class="anchored" data-anchor-id="question">Question</h6>
<p>Using geometry, compute the definite integral:</p>
<p><span class="math display">\[
\int_{-5}^5 \sqrt{5^2 - x^2} dx.
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = sqrt(5^2 - x^2)
val, _ = quadgk(f, -5,5)
numericq(val)</code></pre>
</section>
<section id="question-1" class="level6">
<h6 class="anchored" data-anchor-id="question-1">Question</h6>
<p>Using geometry, compute the definite integral:</p>
<p><span class="math display">\[
\int_{-2}^2 (2 - \lvert x\rvert) dx
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = 2- abs(x)
a,b = -2, 2
val, _ = quadgk(f, a,b)
numericq(val)</code></pre>
</section>
<section id="question-2" class="level6">
<h6 class="anchored" data-anchor-id="question-2">Question</h6>
<p>Using geometry, compute the definite integral:</p>
<p><span class="math display">\[
\int_0^3 3 dx + \int_3^9 (3 + 3(x-3)) dx
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = x &lt;= 3 ? 3.0 : 3 + 3*(x-3)
a,b = 0, 9
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-3" class="level6">
<h6 class="anchored" data-anchor-id="question-3">Question</h6>
<p>Using geometry, compute the definite integral:</p>
<p><span class="math display">\[
\int_0^5 \lfloor x \rfloor dx
\]</span></p>
<p>(The notation <span class="math inline">\(\lfloor x \rfloor\)</span> is the integer such that <span class="math inline">\(\lfloor x \rfloor \leq x &lt; \lfloor x \rfloor + 1\)</span>.)</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = floor(x)
a, b = 0, 5
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-4" class="level6">
<h6 class="anchored" data-anchor-id="question-4">Question</h6>
<p>Using geometry, compute the definite integral between <span class="math inline">\(-3\)</span> and <span class="math inline">\(3\)</span> of this graph comprised of lines and circular arcs:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
function f(x)
  if x &lt; -1
    abs(x+1)
  elseif -1 &lt;= x &lt;= 1
    sqrt(1 - x^2)
  else
    abs(x-1)
  end
end
plot(f, -3, 3, aspect_ratio=:equal)</code></pre>
<p>The value is:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = (1/2 * 2 * 2) * 2 + pi*1^2/2
numericq(val)</code></pre>
</section>
<section id="question-5" class="level6">
<h6 class="anchored" data-anchor-id="question-5">Question</h6>
<p>For the function <span class="math inline">\(f(x) = \sin(\pi x)\)</span>, estimate the integral for <span class="math inline">\(-1\)</span> to <span class="math inline">\(1\)</span> using a left-Riemann sum with the partition <span class="math inline">\(-1 &lt; -1/2 &lt; 0 &lt; 1/2 &lt; 1\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = sin(x)
xs = -1:1/2:1
deltas = diff(xs)
val = sum(map(f, xs[1:end-1]) .* deltas)
numericq(val)</code></pre>
</section>
<section id="question-6" class="level6">
<h6 class="anchored" data-anchor-id="question-6">Question</h6>
<p>Without doing any <em>real</em> work, find this integral:</p>
<p><span class="math display">\[
\int_{-\pi/4}^{\pi/4} \tan(x) dx.
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = 0
numericq(val)</code></pre>
</section>
<section id="question-7" class="level6">
<h6 class="anchored" data-anchor-id="question-7">Question</h6>
<p>Without doing any <em>real</em> work, find this integral:</p>
<p><span class="math display">\[
\int_3^5 (1 - \lvert x-4 \rvert) dx
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = 1
numericq(val)</code></pre>
</section>
<section id="question-8" class="level6">
<h6 class="anchored" data-anchor-id="question-8">Question</h6>
<p>Suppose you know that for the integrable function <span class="math inline">\(\int_a^b f(u)du =1\)</span> and <span class="math inline">\(\int_a^c f(u)du = p\)</span>. If <span class="math inline">\(a &lt; c &lt; b\)</span> what is <span class="math inline">\(\int_c^b f(u)du\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``1``",
"``p``",
"``1-p``",
"``p^2``"]
 answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-9" class="level6">
<h6 class="anchored" data-anchor-id="question-9">Question</h6>
<p>What is <span class="math inline">\(\int_0^2 x^4 dx\)</span>? Use the rule for integrating <span class="math inline">\(x^n\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``2^5 - 0^5``",
"``2^5/5 - 0^5/5``",
"``2^4/4 - 0^4/4``",
"``3\\cdot 2^3 - 3 \\cdot 0^3``"]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-10" class="level6">
<h6 class="anchored" data-anchor-id="question-10">Question</h6>
<p>Solve for a value of <span class="math inline">\(x\)</span> for which:</p>
<p><span class="math display">\[
\int_1^x \frac{1}{u}du = 1.
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = exp(1)
numericq(val)</code></pre>
</section>
<section id="question-11" class="level6">
<h6 class="anchored" data-anchor-id="question-11">Question</h6>
<p>Solve for a value of <span class="math inline">\(n\)</span> for which</p>
<p><span class="math display">\[
\int_0^1 x^n dx = \frac{1}{12}.
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = 11
numericq(val)</code></pre>
</section>
<section id="question-12" class="level6">
<h6 class="anchored" data-anchor-id="question-12">Question</h6>
<p>Suppose <span class="math inline">\(f(x) &gt; 0\)</span> and <span class="math inline">\(a &lt; c &lt; b\)</span>. Define <span class="math inline">\(F(x) = \int_a^x f(u) du\)</span>. What can be said about <span class="math inline">\(F(b)\)</span> and <span class="math inline">\(F(c)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"The area between $c$ and $b$ must be positive, so $F(c) &lt; F(b)$.",
"``F(b) - F(c) = F(a).``",
L" $F(x)$ is continuous, so between $a$ and $b$ has an extreme value, which must be at $c$. So $F(c) \geq F(b)$."
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-13" class="level6">
<h6 class="anchored" data-anchor-id="question-13">Question</h6>
<p>For the right Riemann sum approximating <span class="math inline">\(\int_0^{10} e^x dx\)</span> with <span class="math inline">\(n=100\)</span> subintervals, what would be a good estimate for the error?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``(10 - 0)/100 \\cdot (e^{10} - e^{0})``",
"``10/100``",
"``(10 - 0) \\cdot e^{10} / 100^4``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-14" class="level6">
<h6 class="anchored" data-anchor-id="question-14">Question</h6>
<p>Use <code>quadgk</code> to find the following definite integral:</p>
<p><span class="math display">\[
\int_1^4 x^x dx   .
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = x^x
a, b = 1, 4
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-15" class="level6">
<h6 class="anchored" data-anchor-id="question-15">Question</h6>
<p>Use <code>quadgk</code> to find the following definite integral:</p>
<p><span class="math display">\[
\int_0^3 e^{-x^2} dx   .
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = exp(-x^2)
a, b = 0, 3
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-16" class="level6">
<h6 class="anchored" data-anchor-id="question-16">Question</h6>
<p>Use <code>quadgk</code> to find the following definite integral:</p>
<p><span class="math display">\[
\int_0^{9/10} \tan(u \frac{\pi}{2}) du.   .
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = tan(x*pi/2)
a, b = 0, 9/10
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-17" class="level6">
<h6 class="anchored" data-anchor-id="question-17">Question</h6>
<p>Use <code>quadgk</code> to find the following definite integral:</p>
<p><span class="math display">\[
\int_{-1/2}^{1/2} \frac{1}{\sqrt{1 - x^2}} dx
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = 1/sqrt(1 - x^2)
a, b =-1/2, 1/2
val, _ = quadgk(f, a, b)
numericq(val)</code></pre>
</section>
<section id="question-18" class="level6">
<h6 class="anchored" data-anchor-id="question-18">Question</h6>
<pre class="{julia}"><code>#| hold: true
#| echo: false
caption = """
The area under a curve approximated by a Riemann sum.
"""
#CalculusWithJulia.WeaveSupport.JSXGraph(joinpath(@__DIR__, "riemann.js"), caption)
# url = "riemann.js"
#CalculusWithJulia.WeaveSupport.JSXGraph(:integrals, url, caption)
# This is just wrong...
#CalculusWithJulia.WeaveSupport.JSXGraph(url, caption)
nothing</code></pre>
<div id="jsxgraph" style="width: 500px; height: 500px;"></div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb56" data-startfrom="1430" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1429;"><span id="cb56-1430"><a href="#cb56-1430" aria-hidden="true" tabindex="-1"></a>JXG <span class="op">=</span> <span class="pp">require</span>(<span class="st">"jsxgraph"</span>)<span class="op">;</span></span>
<span id="cb56-1431"><a href="#cb56-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1432"><a href="#cb56-1432" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> JXG<span class="op">.</span><span class="at">JSXGraph</span><span class="op">.</span><span class="fu">initBoard</span>(<span class="st">'jsxgraph'</span><span class="op">,</span> {</span>
<span id="cb56-1433"><a href="#cb56-1433" aria-hidden="true" tabindex="-1"></a>    <span class="dt">boundingbox</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.3</span><span class="op">,</span><span class="fl">1.5</span><span class="op">,-</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>]<span class="op">,</span> <span class="dt">axis</span><span class="op">:</span><span class="kw">true</span></span>
<span id="cb56-1434"><a href="#cb56-1434" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb56-1435"><a href="#cb56-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1436"><a href="#cb56-1436" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="kw">function</span>(x) { <span class="cf">return</span> x<span class="op">*</span>x<span class="op">*</span>x<span class="op">*</span>x <span class="op">+</span>  <span class="dv">10</span><span class="op">*</span>x<span class="op">*</span>x <span class="op">-</span> <span class="dv">60</span><span class="op">*</span> x <span class="op">+</span> <span class="dv">100</span>}</span>
<span id="cb56-1437"><a href="#cb56-1437" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">function</span>(x) {<span class="cf">return</span> <span class="dv">1</span><span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="fu">g</span>(x))}<span class="op">;</span></span>
<span id="cb56-1438"><a href="#cb56-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1439"><a href="#cb56-1439" aria-hidden="true" tabindex="-1"></a>type <span class="op">=</span> <span class="st">"right"</span><span class="op">;</span></span>
<span id="cb56-1440"><a href="#cb56-1440" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb56-1441"><a href="#cb56-1441" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb56-1442"><a href="#cb56-1442" aria-hidden="true" tabindex="-1"></a>rsum <span class="op">=</span> <span class="kw">function</span>() {</span>
<span id="cb56-1443"><a href="#cb56-1443" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> JXG<span class="op">.</span><span class="at">Math</span><span class="op">.</span><span class="at">Numerics</span><span class="op">.</span><span class="fu">riemannsum</span>(f<span class="op">,</span>n<span class="op">.</span><span class="fu">Value</span>()<span class="op">,</span> type<span class="op">,</span> l<span class="op">,</span> r)<span class="op">;</span></span>
<span id="cb56-1444"><a href="#cb56-1444" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb56-1445"><a href="#cb56-1445" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span>   b<span class="op">.</span><span class="fu">create</span>(<span class="st">'slider'</span><span class="op">,</span> [[<span class="fl">0.1</span><span class="op">,</span> <span class="op">-</span><span class="fl">0.05</span>]<span class="op">,</span>[<span class="fl">0.75</span><span class="op">,-</span><span class="fl">0.05</span>]<span class="op">,</span> [<span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">50</span>]]<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">'n'</span><span class="op">,</span><span class="dt">snapWidth</span><span class="op">:</span><span class="dv">1</span>})<span class="op">;</span></span>
<span id="cb56-1446"><a href="#cb56-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1447"><a href="#cb56-1447" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> b<span class="op">.</span><span class="fu">create</span>(<span class="st">'functiongraph'</span><span class="op">,</span> [f<span class="op">,</span> l<span class="op">,</span> r])<span class="op">;</span></span>
<span id="cb56-1448"><a href="#cb56-1448" aria-hidden="true" tabindex="-1"></a>os <span class="op">=</span> b<span class="op">.</span><span class="fu">create</span>(<span class="st">'riemannsum'</span><span class="op">,</span></span>
<span id="cb56-1449"><a href="#cb56-1449" aria-hidden="true" tabindex="-1"></a>                  [f<span class="op">,</span></span>
<span id="cb56-1450"><a href="#cb56-1450" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">function</span>(){ <span class="cf">return</span> n<span class="op">.</span><span class="fu">Value</span>()<span class="op">;</span>}<span class="op">,</span></span>
<span id="cb56-1451"><a href="#cb56-1451" aria-hidden="true" tabindex="-1"></a>                   type<span class="op">,</span> l<span class="op">,</span> r</span>
<span id="cb56-1452"><a href="#cb56-1452" aria-hidden="true" tabindex="-1"></a>                  ]<span class="op">,</span></span>
<span id="cb56-1453"><a href="#cb56-1453" aria-hidden="true" tabindex="-1"></a>                  {<span class="dt">fillColor</span><span class="op">:</span><span class="st">'#ffff00'</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span><span class="fl">0.3</span>})<span class="op">;</span></span>
<span id="cb56-1454"><a href="#cb56-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1455"><a href="#cb56-1455" aria-hidden="true" tabindex="-1"></a>b<span class="op">.</span><span class="fu">create</span>(<span class="st">'text'</span><span class="op">,</span> [<span class="fl">0.1</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span> <span class="kw">function</span>(){</span>
<span id="cb56-1456"><a href="#cb56-1456" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Riemann sum='</span><span class="op">+</span>(<span class="fu">rsum</span>()<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>))<span class="op">;</span></span>
<span id="cb56-1457"><a href="#cb56-1457" aria-hidden="true" tabindex="-1"></a>}])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-12" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>The interactive graphic shows the area of a right-Riemann sum for different partitions. The function is</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{ x^4 +  10x^2 - 60x + 100}}
\]</span></p>
<p>When <span class="math inline">\(n=5\)</span> what is the area of the Riemann sum?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(0.1224)</code></pre>
<p>When <span class="math inline">\(n=50\)</span> what is the area of the Riemann sum?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(0.1187)</code></pre>
<p>Using <code>quadgk</code> what is the area under the curve?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
g(x) = 1/sqrt(x^4 + 10x^2 - 60x + 100)
val, tmp = quadgk(g, 0, 1)
numericq(val)</code></pre>
</section>
<section id="question-19" class="level6">
<h6 class="anchored" data-anchor-id="question-19">Question</h6>
<p>Gauss nodes for approximating the integral <span class="math inline">\(\int_{-1}^1 f(x) dx\)</span> for <span class="math inline">\(n=4\)</span> are:</p>
<pre class="{julia}"><code>ns = [-0.861136, -0.339981, 0.339981, 0.861136]</code></pre>
<p>The corresponding weights are</p>
<pre class="{julia}"><code>wts = [0.347855, 0.652145, 0.652145, 0.347855]</code></pre>
<p>Use these to estimate the integral <span class="math inline">\(\int_{-1}^1 \cos(\pi/2 \cdot x)dx\)</span> with <span class="math inline">\(w_1f(x_1) + w_2 f(x_2) + w_3 f(x_3) + w_4 f(x_4)\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = cos(pi/2*x)
val = sum([f(wi)*ni for (wi, ni) in zip(wts, ns)])
numericq(val)</code></pre>
<p>The actual answer is <span class="math inline">\(4/\pi\)</span>. How far off is the approximation based on 4 points?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"around $10^{-1}$",
L"around $10^{-2}$",
L"around $10^{-4}$",
L"around $10^{-6}$",
L"around $10^{-8}$"]
answ = 4
radioq(choices, answ, keep_order=true)</code></pre>
</section>
<section id="question-20" class="level6">
<h6 class="anchored" data-anchor-id="question-20">Question</h6>
<p>Using the Gauss nodes and weights from the previous question, estimate the integral of <span class="math inline">\(f(x) = e^x\)</span> over <span class="math inline">\([-1, 1]\)</span>. The value is:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = exp(x)
val = sum([f(wi)*ni for (wi, ni) in zip(wts, ns)])
numericq(val)</code></pre>


</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpretLenient","cellName":"ojs-cell-1","inline":false,"source":"JXG = require(\"jsxgraph\");\n\nb = JXG.JSXGraph.initBoard('jsxgraph', {\n    boundingbox: [-0.5,0.3,1.5,-1/4], axis:true\n});\n\ng = function(x) { return x*x*x*x +  10*x*x - 60* x + 100}\nf = function(x) {return 1/Math.sqrt(g(x))};\n\ntype = \"right\";\nl = 0;\nr = 1;\nrsum = function() {\n    return JXG.Math.Numerics.riemannsum(f,n.Value(), type, l, r);\n};\nn =   b.create('slider', [[0.1, -0.05],[0.75,-0.05], [2,1,50]],{name:'n',snapWidth:1});\n\ngraph = b.create('functiongraph', [f, l, r]);\nos = b.create('riemannsum',\n                  [f,\n                   function(){ return n.Value();},\n                   type, l, r\n                  ],\n                  {fillColor:'#ffff00', fillOpacity:0.3});\n\nb.create('text', [0.1,0.25, function(){\n    return 'Riemann sum='+(rsum().toFixed(4));\n}]);\n"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../integrals";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../integrals.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Integrals</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../integrals/ftc.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>