<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 14&nbsp; Rational functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../precalc/exp_log_functions.html" rel="next">
<link href="../precalc/polynomials_package.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#rational-functions" id="toc-rational-functions" class="nav-link active" data-scroll-target="#rational-functions"><span class="toc-section-number">14.1</span>  Rational functions</a></li>
  <li><a href="#asymptotes" id="toc-asymptotes" class="nav-link" data-scroll-target="#asymptotes"><span class="toc-section-number">14.2</span>  Asymptotes</a>
  <ul class="collapse">
  <li><a href="#behaviour-as-x-rightarrow-infty-or-x-rightarrow--infty." id="toc-behaviour-as-x-rightarrow-infty-or-x-rightarrow--infty." class="nav-link" data-scroll-target="#behaviour-as-x-rightarrow-infty-or-x-rightarrow--infty."><span class="toc-section-number">14.2.1</span>  Behaviour as <span class="math inline">\(x \rightarrow \infty\)</span> or <span class="math inline">\(x \rightarrow -\infty\)</span>.</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="toc-section-number">14.2.2</span>  Examples</a></li>
  <li><a href="#vertical-asymptotes" id="toc-vertical-asymptotes" class="nav-link" data-scroll-target="#vertical-asymptotes"><span class="toc-section-number">14.2.3</span>  Vertical asymptotes</a></li>
  <li><a href="#sign-charts" id="toc-sign-charts" class="nav-link" data-scroll-target="#sign-charts"><span class="toc-section-number">14.2.4</span>  Sign charts</a></li>
  </ul></li>
  <li><a href="#pade-approximate" id="toc-pade-approximate" class="nav-link" data-scroll-target="#pade-approximate"><span class="toc-section-number">14.3</span>  Pade approximate</a></li>
  <li><a href="#the-polynomials-package-for-rational-functions" id="toc-the-polynomials-package-for-rational-functions" class="nav-link" data-scroll-target="#the-polynomials-package-for-rational-functions"><span class="toc-section-number">14.4</span>  The <code>Polynomials</code> package for rational functions</a>
  <ul class="collapse">
  <li><a href="#the-realpolynomialroots-package." id="toc-the-realpolynomialroots-package." class="nav-link" data-scroll-target="#the-realpolynomialroots-package."><span class="toc-section-number">14.4.1</span>  The <code>RealPolynomialRoots</code> package.</a></li>
  </ul></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="toc-section-number">14.5</span>  Questions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/precalc/rational_functions.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses the following add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using SymPy
using Plots
import Polynomials
using RealPolynomialRoots</code></pre>
<p>The <code>Polynomials</code> package is “imported” to avoid naming collisions with <code>SymPy</code>; names will need to be qualified.</p>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"
using CalculusWithJulia.WeaveSupport

const frontmatter = (
        title = "Rational functions",
        description = "Calculus with Julia: Rational functions",
        tags = ["CalculusWithJulia", "precalc", "rational functions"],
);

using Roots

nothing</code></pre>
<hr>
<p>A rational expression is the ratio of two polynomial expressions. Such expressions arise in many modeling situations. As many facts are known about polynomial expressions, much can be determined about rational expressions. This section covers some additional details that arise when graphing such expressions.</p>
<section id="rational-functions" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="rational-functions"><span class="header-section-number">14.1</span> Rational functions</h2>
<p>The rational numbers are simply ratios of integers, of the form <span class="math inline">\(p/q\)</span> for non-zero <span class="math inline">\(q\)</span>. A rational function is a ratio of <em>polynomial</em> <em>functions</em> of the form <span class="math inline">\(p(x)/q(x)\)</span>, again <span class="math inline">\(q\)</span> is non-zero, but may have zeros.</p>
<p>We know that polynomials have nice behaviors due to the following facts:</p>
<ul>
<li>Behaviors at <span class="math inline">\(-\infty\)</span>, <span class="math inline">\(\infty\)</span> are known just from the leading term.</li>
<li>There are possible wiggles up and down, the exact behavior depends on intermediate terms, but there can be no more than <span class="math inline">\(n-1\)</span> wiggles.</li>
<li>The number of real zeros is no more than <span class="math inline">\(n\)</span>, the degree of the polynomial.</li>
</ul>
<p>Rational functions are not quite so nice:</p>
<ul>
<li>behavior at <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(\infty\)</span> can be like a polynomial of any degree, including constants</li>
<li>behaviour at any value x can blow up due to division by <span class="math inline">\(0\)</span> - rational functions, unlike polynomials, need not be always defined</li>
<li>The function may or may not cross zero, even if the range includes every other point, as the graph of <span class="math inline">\(f(x) =1/x\)</span> will show.</li>
</ul>
<p>Here, as with our discussion on polynomials, we are interested for now in just a few properties:</p>
<ul>
<li>What happens to <span class="math inline">\(f(x)\)</span> when <span class="math inline">\(x\)</span> gets really big or really small (towards <span class="math inline">\(\infty\)</span> or <span class="math inline">\(-\infty\)</span>)?</li>
<li>What happens near the values where <span class="math inline">\(q(x) = 0\)</span>?</li>
<li>When is <span class="math inline">\(f(x) = 0\)</span>?</li>
</ul>
<p>These questions can often be answered with a graph, but with rational functions we will see that care must be taken to produce a useful graph.</p>
<p>For example, consider this graph generated from a simple rational function:</p>
<p><span class="math display">\[
f(x) = \frac{(x-1)^2 \cdot (x-2)}{(x+3) \cdot (x-3)}.
\]</span></p>
<pre class="{julia}"><code>f(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )
plot(f, -10, 10)</code></pre>
<p>We would be hard pressed to answer any of the three questions above from the graph, though, on inspection, we might think the strange spikes have something to do with <span class="math inline">\(x\)</span> values where <span class="math inline">\(q(x)=0\)</span>.</p>
<p>The question of big or small <span class="math inline">\(x\)</span> is not answered well with this graph, as the spikes dominate the scale of the <span class="math inline">\(y\)</span>-axis. Setting a much larger viewing window illuminates this question:</p>
<pre class="{julia}"><code>plot(f, -100, 100)</code></pre>
<p>We can see from this, that the function eventually looks like a slanted straight line. The <em>eventual</em> shape of the graph is something that can be determined just from the two leading terms.</p>
<p>The spikes haven’t vanished completely. It is just that with only a few hundred points to make the graph, there aren’t any values near enough to the problem to make a large spike. The spikes happen because the function has a <em>vertical asymptote</em> at these values. Though not quite right, it is reasonable to think of the graph being made by selecting a few hundred points in the specified domain, computing the corresponding <span class="math inline">\(y\)</span> values, plotting the pairs, and finally connecting the points with straight line segments. Near a vertical asymptote the function values can be arbitrarily large in absolute values, though at the vertical asymptote the function is undefined. This graph doesn’t show such detail.</p>
<p>The spikes will be related to the points where <span class="math inline">\(q(x) = 0\)</span>, though not necessarily all of them – not all such points will produce a vertical asymptote.</p>
<p>Where the function crosses <span class="math inline">\(0\)</span> is very hard to tell from these two graphs. As well, other finer features, such as local peaks or valleys, when present, can be hard to identify as the <span class="math inline">\(y\)</span>-scale is set to accommodate the asymptotes. Working around the asymptotes requires some extra effort. Strategies are discussed herein.</p>
</section>
<section id="asymptotes" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="asymptotes"><span class="header-section-number">14.2</span> Asymptotes</h2>
<p>Formally, an <a href="http://en.wikipedia.org/wiki/Asymptote">asymptote</a> of a curve is a line such that the distance between the curve and the line approaches <span class="math inline">\(0\)</span> as they tend to infinity. Tending to infinity can happen as <span class="math inline">\(x \rightarrow \pm \infty\)</span> <em>or</em> <span class="math inline">\(y \rightarrow \pm \infty\)</span>, the former being related to <em>horizontal asymptotes</em> or <em>slant asymptotes</em>, the latter being related to <em>vertical asymptotes</em>.</p>
<section id="behaviour-as-x-rightarrow-infty-or-x-rightarrow--infty." class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored" data-anchor-id="behaviour-as-x-rightarrow-infty-or-x-rightarrow--infty."><span class="header-section-number">14.2.1</span> Behaviour as <span class="math inline">\(x \rightarrow \infty\)</span> or <span class="math inline">\(x \rightarrow -\infty\)</span>.</h3>
<p>Let’s look more closely at our example rational function using symbolic math.</p>
<p>In particular, let’s rewrite the expression in terms of its numerator and denominator:</p>
<pre class="{julia}"><code>@syms x::real
num = (x-1)^2 * (x-2)
den = (x+3) * (x-3)</code></pre>
<p>Euclid’s <a href="https://en.wikipedia.org/wiki/Polynomial_greatest_common_divisor#Euclidean_division">division</a> algorithm can be used for polynomials <span class="math inline">\(a(x)\)</span> and <span class="math inline">\(b(x)\)</span> to produce <span class="math inline">\(q(x)\)</span> and <span class="math inline">\(r(x)\)</span> with <span class="math inline">\(a = b\cdot q + r\)</span> <em>and</em> the degree of <span class="math inline">\(r(x)\)</span> is less than the degree of <span class="math inline">\(b(x)\)</span>. This is in direct analogy to the division algorithm of integers, only there the value of the remainder, <span class="math inline">\(r(x)\)</span>, satisfies <span class="math inline">\(0 \leq r &lt; b\)</span>. Given <span class="math inline">\(q(x)\)</span> and <span class="math inline">\(r(x)\)</span> as above, we can reexpress the rational function</p>
<p><span class="math display">\[
\frac{a(x)}{b(x)} = q(x)  + \frac{r(x)}{b(x)}.
\]</span></p>
<p>The rational expression on the right-hand side has larger degree in the denominator.</p>
<p>The division algorithm is implemented in <code>Julia</code> generically through the <code>divrem</code> method:</p>
<pre class="{julia}"><code>q, r = divrem(num, den)</code></pre>
<p>This yields the decomposition of <code>num/den</code>:</p>
<pre class="{julia}"><code>q + r/den</code></pre>
<p>A similar result can be found using the <code>apart</code> function, which can be easier to use if the expression is not given in terms of a separate numerator and denominator.</p>
<pre class="{julia}"><code>g(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3))  # as a function
h = g(x)                                # a symbolic expression
apart(h)</code></pre>
<p>This decomposition breaks the rational expression into two pieces: <span class="math inline">\(x-4\)</span> and <span class="math inline">\(40/(3x+9) + 2/(3x-9)\)</span>. The first piece would have a graph that is the line with slope <span class="math inline">\(1\)</span> and <span class="math inline">\(y\)</span>-intercept <span class="math inline">\(4\)</span>. As <span class="math inline">\(x\)</span> goes to <span class="math inline">\(\infty\)</span>, the second piece will clearly go towards <span class="math inline">\(0,\)</span> as this simple graph shows:</p>
<pre class="{julia}"><code>plot(apart(h) - (x - 4), 10, 100)</code></pre>
<p>Similarly, a plot over <span class="math inline">\([-100, -10]\)</span> would show decay towards <span class="math inline">\(0\)</span>, though in that case from below. Combining these two facts then, it is now no surprise that the graph of the rational function <span class="math inline">\(f(x)\)</span> should approach a straight line, in this case <span class="math inline">\(y=x-4\)</span> as <span class="math inline">\(x \rightarrow \pm \infty\)</span>.</p>
<p>We can easily do most of this analysis without needing a computer or algebra. First, we should know the four eventual shapes of a polynomial, that the graph of <span class="math inline">\(y=mx\)</span> is a line with slope <span class="math inline">\(m\)</span>, the graph of <span class="math inline">\(y = c\)</span> is a constant line at height <span class="math inline">\(c\)</span>, and the graph of <span class="math inline">\(y=c/x^m\)</span>, <span class="math inline">\(m &gt; 0\)</span> will decay towards <span class="math inline">\(0\)</span> as <span class="math inline">\(x \rightarrow \pm\infty\)</span>. The latter should be clear, as <span class="math inline">\(x^m\)</span> gets big, so its reciprocal goes towards <span class="math inline">\(0\)</span>.</p>
<p>The factored form, as <span class="math inline">\(p\)</span> is presented, is a bit hard to work with, rather we use the expanded form, which we get through the <code>cancel</code> function</p>
<pre class="{julia}"><code>cancel(h)</code></pre>
<p>We can see that the numerator is of degree <span class="math inline">\(3\)</span> and the denominator of degree <span class="math inline">\(2\)</span>. The leading terms are <span class="math inline">\(x^3\)</span> and <span class="math inline">\(x^2\)</span>, respectively. If we were to pull those out we would get:</p>
<p><span class="math display">\[
\frac{x^3 \cdot (1 - 4/x + 5/x^2 - 2/x^3)}{x^2 \cdot (1 - 9/x^2)}.
\]</span></p>
<p>The terms <span class="math inline">\((1 - 4/x + 5/x^2 - 2/x^3)\)</span> and <span class="math inline">\((1 - 9/x^2)\)</span> go towards <span class="math inline">\(1\)</span> as <span class="math inline">\(x \rightarrow \pm \infty\)</span>, as each term with <span class="math inline">\(x\)</span> goes towards <span class="math inline">\(0\)</span>. So the dominant terms comes from the ratio of the leading terms, <span class="math inline">\(x^3\)</span> and <span class="math inline">\(x^2\)</span>. This ratio is <span class="math inline">\(x\)</span>, so their will be an asymptote around a line with slope <span class="math inline">\(1\)</span>. (The fact that the asymptote is <span class="math inline">\(y=x-4\)</span> takes a bit more work, as a division step is needed.)</p>
<p>Just by looking at the ratio of the two leading terms, the behaviour as <span class="math inline">\(x \rightarrow \pm \infty\)</span> can be discerned. If this ratio is of:</p>
<ul>
<li>the form <span class="math inline">\(c x^m\)</span> with <span class="math inline">\(m &gt; 1\)</span> then the shape will follow the polynomial growth of of the monomial <span class="math inline">\(c x^m\)</span>.</li>
<li>the form <span class="math inline">\(c x^m\)</span> with <span class="math inline">\(m=1\)</span> then there will be a line with slope <span class="math inline">\(c\)</span> as a <em>slant asymptote</em>.</li>
<li>the form <span class="math inline">\(cx^0\)</span> with <span class="math inline">\(m=0\)</span> (or just <span class="math inline">\(c\)</span>) then there will be a <em>horizontal asymptote</em> <span class="math inline">\(y=c\)</span>.</li>
<li>the form <span class="math inline">\(c/x^{m}\)</span> with <span class="math inline">\(m &gt; 0\)</span> then there will be a horizontal asymptote <span class="math inline">\(y=0\)</span>, or the <span class="math inline">\(y\)</span> axis.</li>
</ul>
<p>To expand on the first points where the degree of the numerator is greater than that of the denominator, we have from the division algorithm that if <span class="math inline">\(a(x)\)</span> is the numerator and <span class="math inline">\(b(x)\)</span> the denominator, then <span class="math inline">\(a(x)/b(x) = q(x) + r(x)/b(x)\)</span> where the degree of <span class="math inline">\(b(x)\)</span> is greater than the degree of <span class="math inline">\(r(x)\)</span>, so the right-most term will have a horizontal asymptote of <span class="math inline">\(0\)</span>. This says that the graph will eventually approach the graph of <span class="math inline">\(q(x)\)</span>, giving more detail than just saying it follows the shape of the leading term of <span class="math inline">\(q(x)\)</span>, at the expense of the work required to find <span class="math inline">\(q(x)\)</span>.</p>
</section>
<section id="examples" class="level3" data-number="14.2.2">
<h3 data-number="14.2.2" class="anchored" data-anchor-id="examples"><span class="header-section-number">14.2.2</span> Examples</h3>
<p>Consider the rational expression</p>
<p><span class="math display">\[
\frac{17x^5 - 300x^4 - 1/2}{x^5 - 2x^4 + 3x^3 - 4x^2 + 5}.
\]</span></p>
<p>The leading term of the numerator is <span class="math inline">\(17x^5\)</span> and the leading term of the denominator is <span class="math inline">\(x^5\)</span>. The ratio is <span class="math inline">\(17\)</span> (or <span class="math inline">\(17x^0 = 17x^{5-5}\)</span>). As such, we would have a horizontal asymptote <span class="math inline">\(y=17\)</span>.</p>
<hr>
<p>If we consider instead this rational expression:</p>
<p><span class="math display">\[
\frac{x^5 - 2x^4 + 3x^3 - 4x^2 + 5}{5x^4 + 4x^3 + 3x^2 + 2x + 1}
\]</span></p>
<p>Then we can see that the ratio of the leading terms is <span class="math inline">\(x^5 / (5x^4) = (1/5)x\)</span>. We expect a slant asymptote with slope <span class="math inline">\(1/5\)</span>, though we would need to divide to see the exact intercept. This is found with, say:</p>
<pre class="{julia}"><code>#| hold: true
p = (x^5 - 2x^4 + 3x^3 - 4x^2 + 5) / (5x^4 + 4x^3 + 3x^2 + 2x + 1)
quo, rem = divrem(numerator(p), denominator(p))  # or apart(p)
quo</code></pre>
<hr>
<p>The rational function</p>
<p><span class="math display">\[
\frac{5x^3 + 6x^2 + 2}{x-1}
\]</span></p>
<p>has decomposition <span class="math inline">\(5x^2 + 11x + 11 + 13/(x-1)\)</span>:</p>
<pre class="{julia}"><code>top = 5x^3 + 6x^2 +2
bottom = x-1
quo, rem = divrem(top, bottom)</code></pre>
<p>The graph of has nothing in common with the graph of the quotient for small <span class="math inline">\(x\)</span></p>
<pre class="{julia}"><code>plot(top/bottom, -3, 3)
plot!(quo, -3, 3)</code></pre>
<p>But the graphs do match for large <span class="math inline">\(x\)</span>:</p>
<pre class="{julia}"><code>plot(top/bottom, 5, 10)
plot!(quo, 5, 10)</code></pre>
<hr>
<p>Finally, consider this rational expression in factored form:</p>
<p><span class="math display">\[
\frac{(x-2)^3\cdot(x-4)\cdot(x-3)}{(x-5)^4 \cdot (x-6)^2}.
\]</span></p>
<p>By looking at the powers we can see that the leading term of the numerator will the <span class="math inline">\(x^5\)</span> and the leading term of the denominator <span class="math inline">\(x^6\)</span>. The ratio is <span class="math inline">\(1/x^1\)</span>. As such, we expect the <span class="math inline">\(y\)</span>-axis as a horizontal asymptote:</p>
<section id="partial-fractions" class="level4">
<h4 class="anchored" data-anchor-id="partial-fractions">Partial fractions</h4>
<p>The <code>apart</code> function was useful to express a rational function in terms of a polynomial plus additional rational functions whose horizontal asymptotes are <span class="math inline">\(0\)</span>. This function computes the partial fraction <a href="https://en.wikipedia.org/wiki/Partial_fraction_decomposition">decomposition</a> of a rational function. Outside of the initial polynomial, this decomposition is a reexpression of a rational function into a sum of rational functions, where the denominators are <em>irreducible</em>, or unable to be further factored (non-trivially) and the numerators have lower degree than the denominator. Hence the horizontal asymptotes of <span class="math inline">\(0\)</span>.</p>
<p>To see another example we have:</p>
<pre class="{julia}"><code>#| hold: true
p = (x-1)*(x-2)
q = (x-3)^3 * (x^2 - x - 1)
apart(p/q)</code></pre>
<p>The denominator, <span class="math inline">\(q\)</span>, has factors <span class="math inline">\(x-3\)</span> and <span class="math inline">\(x^2 - x - 1\)</span>, each irreducible. The answer is expressed in terms of a sum of rational functions each with a denominator coming from one of these factors, possibly with a power.</p>
</section>
</section>
<section id="vertical-asymptotes" class="level3" data-number="14.2.3">
<h3 data-number="14.2.3" class="anchored" data-anchor-id="vertical-asymptotes"><span class="header-section-number">14.2.3</span> Vertical asymptotes</h3>
<p>As just discussed, the graph of <span class="math inline">\(1/x\)</span> will have a horizontal asymptote. However it will also show a spike at <span class="math inline">\(0\)</span>:</p>
<pre class="{julia}"><code>plot(1/x, -1, 1)</code></pre>
<p>Again, this spike is an artifact of the plotting algorithm. The <span class="math inline">\(y\)</span> values for <span class="math inline">\(x\)</span>-values just smaller than <span class="math inline">\(0\)</span> are large negative values and the <span class="math inline">\(x\)</span> values just larger than <span class="math inline">\(0\)</span> produce large, positive <span class="math inline">\(y\)</span> values.</p>
<p>The two points with <span class="math inline">\(x\)</span> components closest to <span class="math inline">\(0\)</span> are connected with a line, though that is misleading. Here we deliberately use far fewer points to plot <span class="math inline">\(1/x\)</span> to show how this happens:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = 1/x
xs = range(-1, 1, length=12)
ys = f.(xs)
plot(xs, ys)
scatter!(xs, ys)</code></pre>
<p>The line <span class="math inline">\(x = 0\)</span> is a <em>vertical asymptote</em> for the graph of <span class="math inline">\(1/x\)</span>. As <span class="math inline">\(x\)</span> values get close to <span class="math inline">\(0\)</span> from the right, the <span class="math inline">\(y\)</span> values go towards <span class="math inline">\(\infty\)</span> and as the <span class="math inline">\(x\)</span> values get close to <span class="math inline">\(0\)</span> on the left, the <span class="math inline">\(y\)</span> values go towards <span class="math inline">\(-\infty\)</span>.</p>
<p>This has everything to do with the fact that <span class="math inline">\(0\)</span> is a root of the denominator.</p>
<p>For a rational function <span class="math inline">\(p(x)/q(x)\)</span>, the roots of <span class="math inline">\(q(x)\)</span> may or may not lead to vertical asymptotes. For a root <span class="math inline">\(c\)</span> if <span class="math inline">\(p(c)\)</span> is not zero then the line <span class="math inline">\(x=c\)</span> will be a vertical asymptote. If <span class="math inline">\(c\)</span> is a root of both <span class="math inline">\(p(x)\)</span> and <span class="math inline">\(q(x)\)</span>, then we can rewrite the expression as:</p>
<p><span class="math display">\[
\frac{p(x)}{q(x)} = \frac{(x-c)^m r(x)}{(x-c)^n s(x)},
\]</span></p>
<p>where both <span class="math inline">\(r(c)\)</span> and <span class="math inline">\(s(c)\)</span> are non zero. Knowing <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> (the multiplicities of the root <span class="math inline">\(c\)</span>) allows the following to be said:</p>
<ul>
<li>If <span class="math inline">\(m &lt; n\)</span> then <span class="math inline">\(x=c\)</span> will be a vertical asymptote.</li>
<li>If <span class="math inline">\(m \geq n\)</span> then <span class="math inline">\(x=c\)</span> will not be vertical asymptote. (The value <span class="math inline">\(c\)</span> will be known as a removable singularity). In this case, the graph of <span class="math inline">\(p(x)/q(x)\)</span> and the graph of <span class="math inline">\((x-c)^{m-n}r(x)/s(x)\)</span> will differ, though very slightly, as the latter will include a value for <span class="math inline">\(x=c\)</span>, whereas <span class="math inline">\(x=c\)</span> is not in the domain of <span class="math inline">\(p(x)/q(x)\)</span>.</li>
</ul>
<p>Finding the multiplicity may or may not be hard, but there is a very kludgy quick check that is often correct. With <code>Julia</code>, if you have a rational function that has <code>f(c)</code> evaluate to <code>Inf</code> or <code>-Inf</code> then there will be a vertical asymptote. If the expression evaluates to <code>NaN</code>, more analysis is needed. (The value of <code>0/0</code> is <code>NaN</code>, where as <code>1/0</code> is <code>Inf</code>.)</p>
<p>For example, the function <span class="math inline">\(f(x) = ((x-1)^2 \cdot (x-2)) / ((x+3) \cdot(x-3))\)</span> has vertical asymptotes at <span class="math inline">\(-3\)</span> and <span class="math inline">\(3\)</span>, as its graph illustrated. Without the graph we could see this as well:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )
f(3), f(-3)</code></pre>
<section id="graphing-with-vertical-asymptotes" class="level4">
<h4 class="anchored" data-anchor-id="graphing-with-vertical-asymptotes">Graphing with vertical asymptotes</h4>
<p>As seen in several graphs, the basic plotting algorithm does a poor job with vertical asymptotes. For example, it may erroneously connect their values with a steep vertical line, or the <span class="math inline">\(y\)</span>-axis scale can get so large as to make reading the rest of the graph impossible. There are some tricks to work around this.</p>
<p>Consider again the function <span class="math inline">\(f(x) = ((x-1)^2 \cdot (x-2)) / ((x+3) \cdot(x-3))\)</span>. Without much work, we can see that <span class="math inline">\(x=3\)</span> and <span class="math inline">\(x=-3\)</span> will be vertical asymptotes and there will be a slant asymptote with slope <span class="math inline">\(1\)</span>. How to graph this?</p>
<p>We can avoid the vertical asymptotes in our viewing window. For example we could look at the area between the vertical asymptotes, by plotting over <span class="math inline">\((-2.9, 2.9)\)</span>, say:</p>
<pre class="{julia}"><code>𝒇(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )
plot(𝒇, -2.9, 2.9)</code></pre>
<p>This backs off by <span class="math inline">\(\delta = 0.1\)</span>. As we have that <span class="math inline">\(3 - 2.9\)</span> is <span class="math inline">\(\delta\)</span> and <span class="math inline">\(1/\delta\)</span> is 10, the <span class="math inline">\(y\)</span> axis won’t get too large, and indeed it doesn’t.</p>
<p>This graph doesn’t show well the two zeros at <span class="math inline">\(x=1\)</span> and <span class="math inline">\(x=2\)</span>, for that a narrower viewing window is needed. By successively panning throughout the interesting part of the graph, we can get a view of the function.</p>
<p>We can also clip the <code>y</code> axis. The <code>plot</code> function can be passed an argument <code>ylims=(lo, hi)</code> to limit which values are plotted. With this, we can have:</p>
<pre class="{julia}"><code>#| hold: true
plot(𝒇, -5, 5, ylims=(-20, 20))</code></pre>
<p>This isn’t ideal, as the large values are still computed, just the viewing window is clipped. This leaves the vertical asymptotes still effecting the graph.</p>
<p>There is another way, we could ask <code>Julia</code> to not plot <span class="math inline">\(y\)</span> values that get too large. This is not a big request. If instead of the value of <code>f(x)</code> - when it is large - -we use <code>NaN</code> instead, then the connect-the-dots algorithm will skip those values.</p>
<p>This was discussed in an earlier section where the <code>rangeclamp</code> function was introduced to replace large values of <code>f(x)</code> (in absolute values) with <code>NaN</code>.</p>
<pre class="{julia}"><code>plot(rangeclamp(𝒇, 30), -25, 25)  # rangeclamp is in the CalculusWithJulia package</code></pre>
<p>We can see the general shape of <span class="math inline">\(3\)</span> curves broken up by the vertical asymptotes. The two on the side heading off towards the line <span class="math inline">\(x-4\)</span> and the one in the middle. We still can’t see the precise location of the zeros, but that wouldn’t be the case with most graphs that show asymptotic behaviors. However, we can clearly tell where to “zoom in” were those of interest.</p>
</section>
</section>
<section id="sign-charts" class="level3" data-number="14.2.4">
<h3 data-number="14.2.4" class="anchored" data-anchor-id="sign-charts"><span class="header-section-number">14.2.4</span> Sign charts</h3>
<p>When sketching graphs of rational functions by hand, it is useful to use sign charts. A sign chart of a function indicates when the function is positive, negative, <span class="math inline">\(0\)</span>, or undefined. It typically is represented along the lines of this one for <span class="math inline">\(f(x) = x^3 - x\)</span>:</p>
<pre class="{verbatim}"><code>    -    0   +   0   -   0   +
&lt; ----- -1 ----- 0 ----- 1 ----- &gt;</code></pre>
<p>The usual recipe for construction follows these steps:</p>
<ul>
<li>Identify when the function is <span class="math inline">\(0\)</span> or undefined. Place those values on a number line.</li>
<li>Identify “test points” within each implied interval (these are <span class="math inline">\((-\infty, -1)\)</span>, <span class="math inline">\((-1,0)\)</span>, <span class="math inline">\((0,1)\)</span>, and <span class="math inline">\((1, \infty)\)</span> in the example) and check for the sign of <span class="math inline">\(f(x)\)</span> at these test points. Write in <code>-</code>, <code>+</code>, <code>0</code>, or <code>*</code>, as appropriate. The value comes from the fact that “continuous” functions may only change sign when they cross <span class="math inline">\(0\)</span> or are undefined.</li>
</ul>
<p>With the computer, where it is convenient to draw a graph, it might be better to emphasize the sign on the graph of the function. The <code>sign_chart</code> function from <code>CalculusWithJulia</code> does this by numerically identifying points where the function is <span class="math inline">\(0\)</span> or <span class="math inline">\(\infty\)</span> and indicating the sign as <span class="math inline">\(x\)</span> crosses over these points.</p>
<pre class="{julia}"><code>#| echo: false
# in CalculusWithJuia
function sign_chart(f, a, b; atol=1e-6)
    pm(x) = x &lt; 0 ? "-" : x &gt; 0 ? "+" : "0"
    summarize(f,cp,d) = (∞0=cp, sign_change=pm(f(cp-d)) * " → " * pm(f(cp+d)))

    zs = find_zeros(f, a, b)
    pts = vcat(a, zs, b)
    for (u,v) ∈ zip(pts[1:end-1], pts[2:end])
        zs′ = find_zeros(x -&gt; 1/f(x), u, v)
        for z′ ∈ zs′
            flag = false
            for z ∈ zs
                if isapprox(z′, z, atol=atol)
                    flag = true
                    break
                end
            end
            !flag &amp;&amp; push!(zs, z′)
        end
    end
    sort!(zs)

    length(zs) == 0 &amp;&amp; return []
    m,M = extrema(zs)
    d = min((m-a)/2, (b-M)/2)
    if length(zs) &gt; 0
        d′ = minimum(diff(zs))/2
        d = min(d, d′ )
    end
    summarize.(f, zs, d)
end</code></pre>
<pre class="{julia}"><code>#| hold: true
f(x) = x^3 - x
sign_chart(f, -3/2, 3/2)</code></pre>
</section>
</section>
<section id="pade-approximate" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="pade-approximate"><span class="header-section-number">14.3</span> Pade approximate</h2>
<p>One area where rational functions are employed is in approximating functions. Later, the Taylor polynomial will be seen to be a polynomial that approximates well a function (where “well” will be described later). The Pade approximation is similar, though uses a rational function for the form <span class="math inline">\(p(x)/q(x)\)</span>, where <span class="math inline">\(q(0)=1\)</span> is customary.</p>
<p>Some example approximations are</p>
<p><span class="math display">\[
\sin(x) \approx \frac{x - 7/60 \cdot x^3}{1 + 1/20 \cdot x^2}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\tan(x) \approx \frac{x - 1/15 \cdot x^3}{1 - 2/5 \cdot x^2}
\]</span></p>
<p>We can look graphically at these approximations:</p>
<pre class="{julia}"><code>sin_p(x) = (x - (7/60)*x^3) / (1 + (1/20)*x^2)
tan_p(x) = (x - (1/15)*x^3) / (1 - (2/5)*x^2)
plot(sin, -pi, pi)
plot!(sin_p, -pi, pi)</code></pre>
<pre class="{julia}"><code>plot(tan, -pi/2 + 0.2, pi/2 - 0.2)
plot!(tan_p, -pi/2 + 0.2, pi/2 - 0.2)</code></pre>
</section>
<section id="the-polynomials-package-for-rational-functions" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="the-polynomials-package-for-rational-functions"><span class="header-section-number">14.4</span> The <code>Polynomials</code> package for rational functions</h2>
<p>In the following, we import some functions from the <code>Polynomials</code> package. We avoided loading the entire namespace, as there are conflicts with <code>SymPy</code>. Here we import some useful functions and the <code>Polynomial</code> constructor:</p>
<pre class="{julia}"><code>import Polynomials: Polynomial, variable, lowest_terms, fromroots, coeffs</code></pre>
<p>The <code>Polynomials</code> package has support for rational functions. The <code>//</code> operator can be used to create rational expressions:</p>
<pre class="{julia}"><code>𝒙 = variable()
𝒑 = (𝒙-1)*(𝒙-2)^2
𝒒 = (𝒙-2)*(𝒙-3)
𝒑𝒒 = 𝒑 // 𝒒</code></pre>
<p>A rational expression is a formal object; a rational function the viewpoint that this object will be evaluated by substituting values for the indeterminate. Rational expressions made within <code>Polynomials</code> are evaluated just like functions:</p>
<pre class="{julia}"><code>𝒑𝒒(4)  # p(4)/q(4)</code></pre>
<p>The rational expressions are not in lowest terms unless requested through the <code>lowest_terms</code> method:</p>
<pre class="{julia}"><code>lowest_terms(𝒑𝒒)</code></pre>
<p>For polynomials as simple as these, this computation is not a problem, but there is the very real possibility that the lowest term computation may be incorrect. Unlike <code>SymPy</code> which factors symbolically, <code>lowest_terms</code> uses a numeric algorithm and does not, as would be done by hand or with <code>SymPy</code>, factor the polynomial and then cancel common factors.</p>
<p>The distinction between the two expressions is sometimes made; the initial expression is not defined at <span class="math inline">\(x=2\)</span>; the reduced one is, so the two are not identical when viewed as functions of the variable <span class="math inline">\(x\)</span>.</p>
<p>Rational expressions include polynomial expressions, just as the rational numbers include the integers. The identification there is to divide by <span class="math inline">\(1\)</span>, thinking of <span class="math inline">\(3\)</span> as <span class="math inline">\(3/1\)</span>. In <code>Julia</code>, we would just use</p>
<pre class="{julia}"><code>3//1</code></pre>
<p>The integer can be recovered from the rational number using <code>numerator</code>:</p>
<pre class="{julia}"><code>numerator(3//1)</code></pre>
<p>Similarly, we can divide a polynomial by the polynomial <span class="math inline">\(1\)</span>, which in <code>Julia</code> is returned by <code>one(p)</code>, to produce a rational expression:</p>
<pre class="{julia}"><code>pp = 𝒑 // one(𝒑)</code></pre>
<p>And as with rational numbers, <code>p</code> is recovered by <code>numerator</code>:</p>
<pre class="{julia}"><code>numerator(pp)</code></pre>
<p>One difference is the rational number <code>3//1</code> also represents other expressions, say <code>6/2</code> or <code>12/4</code>, as <code>Julia</code>’s rational numbers are presented in lowest terms, unlike the rational expressions in <code>Polynomials</code>.</p>
<p>Rational functions also have a plot recipe defined for them that attempts to ensure the basic features are identifiable. As previously discussed, a plot of a rational function can require some effort to avoid the values associated to vertical asymptotes taking up too many of the available vertical pixels in a graph.</p>
<p>For the polynomial <code>pq</code> above, we have from observation that <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span> will be zeros and <span class="math inline">\(x=3\)</span> a vertical asymptote. We also can identify a slant asymptote with slope <span class="math inline">\(1\)</span>. These are hinted at in this graph:</p>
<pre class="{julia}"><code>plot(𝒑𝒒)</code></pre>
<p>To better see the zeros, a plot over a narrower interval, say <span class="math inline">\([0,2.5]\)</span>, would be encouraged; to better see the slant asymptote, a plot over a wider interval, say <span class="math inline">\([-10,10]\)</span>, would be encouraged.</p>
<p>For one more example of the default plot recipe, we redo the graphing of the rational expression we earlier plotted with <code>rangeclamp</code>:</p>
<pre class="{julia}"><code>#| hold: true
p,q = fromroots([1,1,2]), fromroots([-3,3])
plot(p//q)</code></pre>
<section id="example-transformations-of-polynomials-real-roots" class="level5">
<h5 class="anchored" data-anchor-id="example-transformations-of-polynomials-real-roots">Example: transformations of polynomials; real roots</h5>
<p>We have seen some basic transformations of functions such as shifts and scales. For a polynomial expression we can implement these as follows, taking advantage of polynomial evaluation:</p>
<pre class="{julia}"><code>#| hold: true
x = variable()
p = 3 + 4x + 5x^2
a = 2
p(a*x), p(x+a) # scale, shift</code></pre>
<p>A different polynomial transformation is inversion, or the mapping <span class="math inline">\(x^d \cdot p(1/x)\)</span> where <span class="math inline">\(d\)</span> is the degree of <span class="math inline">\(p\)</span>. This will yield a polynomial, as perhaps this example will convince you:</p>
<pre class="{julia}"><code>#| hold: true
p = Polynomial([1, 2, 3, 4, 5])
d = Polynomials.degree(p)  # degree is in SymPy and Polynomials, indicate which
pp = p // one(p)
x = variable(pp)
q = x^d * pp(1/x)
lowest_terms(q)</code></pre>
<p>We had to use a rational expression so that division by the variable was possible. The above indicates that the new polynomial, <span class="math inline">\(q\)</span>, is constructed from <span class="math inline">\(p\)</span> by <strong>reversing</strong> the coefficients.</p>
<p>Inversion is like a funhouse mirror, flipping around parts of the polynomial. For example, the interval <span class="math inline">\([1/4,1/2]\)</span> is related to the interval <span class="math inline">\([2,4]\)</span>. Of interest here, is that if <span class="math inline">\(p(x)\)</span> had a root, <span class="math inline">\(r\)</span>, in <span class="math inline">\([1/4,1/2]\)</span> then <span class="math inline">\(q(x) = x^d \cdot p(1/x)\)</span> would have a root in <span class="math inline">\([2,4]\)</span> at <span class="math inline">\(1/r\)</span>.</p>
<p>So these three transformations – scale, shift, and inversion – can be defined for polynomials.</p>
<p>Combined, the three can be used to create a <a href="https://en.wikipedia.org/wiki/M%C3%B6bius_transformation">Mobius transformation</a>. For two values <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, consider the polynomial derived from <span class="math inline">\(p\)</span> (again <code>d=degree(p)</code>) by:</p>
<p><span class="math display">\[
q = (x+1)^d \cdot p(\frac{ax + b}{x + 1}).
\]</span></p>
<p>Here is a non-performant implementation as a <code>Julia</code> function:</p>
<pre class="{julia}"><code>function mobius_transformation(p, a, b)
  x = variable(p)
  p = p(x + a)   # shift
  p = p((b-a)*x) # scale
  p = Polynomial(reverse(coeffs(p))) # invert
  p = p(x + 1)   # shift
  p
end</code></pre>
<p>We can verify this does what we want through example with the previously defined <code>p</code>:</p>
<pre class="{julia}"><code>𝐩 = Polynomial([1, 2, 3, 4, 5])
𝐪 = mobius_transformation(𝐩, 4, 6)</code></pre>
<p>As contrasted with</p>
<pre class="{julia}"><code>#| hold: true
a, b = 4, 6

pq = 𝐩 // one(𝐩)
x = variable(pq)
d = Polynomials.degree(𝐩)
numerator(lowest_terms( (x + 1)^2 * pq((a*x + b)/(x + 1))))</code></pre>
<hr>
<p>Now, why is this of any interest?</p>
<p>Mobius transforms are used to map regions into other regions. In this special case, the transform <span class="math inline">\(\phi(x) = (ax + b)/(x + 1)\)</span> takes the interval <span class="math inline">\([0,\infty]\)</span> and sends it to <span class="math inline">\([a,b]\)</span> (<span class="math inline">\(0\)</span> goes to <span class="math inline">\((a\cdot 0 + b)/(0+1) = b\)</span>, whereas <span class="math inline">\(\infty\)</span> goes to <span class="math inline">\(ax/x \rightarrow a\)</span>). Using this, if <span class="math inline">\(p(u) = 0\)</span>, with <span class="math inline">\(q(x) = (x-1)^d p(\phi(x))\)</span>, then setting <span class="math inline">\(u = \phi(x)\)</span> we have <span class="math inline">\(q(x) = (\phi^{-1}(u)+1)^d p(\phi(\phi^{-1}(u))) = (\phi^{-1}(u)+1)^d \cdot p(u) = (\phi^{-1}(u)+1)^d \cdot 0 = 0\)</span>. That is, a zero of <span class="math inline">\(p\)</span> in <span class="math inline">\([a,b]\)</span> will appear as a zero of <span class="math inline">\(q\)</span> in <span class="math inline">\([0,\infty)\)</span> at <span class="math inline">\(\phi^{-1}(u)\)</span>.</p>
<p>The Descartes rule of signs applied to <span class="math inline">\(q\)</span> then will give a bound on the number of possible roots of <span class="math inline">\(p\)</span> in the interval <span class="math inline">\([a,b]\)</span>. In the example we did, the Mobius transform for <span class="math inline">\(a=4, b=6\)</span> is <span class="math inline">\(15 - x - 11x^2 - 3x^3\)</span> with <span class="math inline">\(1\)</span> sign change, so there must be exactly <span class="math inline">\(1\)</span> real root of <span class="math inline">\(p=(x-1)(x-3)(x-5)\)</span> in the interval <span class="math inline">\([4,6]\)</span>, as we can observe from the factored form of <span class="math inline">\(p\)</span>.</p>
<p>Similarly, we can see there are <span class="math inline">\(2\)</span> or <span class="math inline">\(0\)</span> roots for <span class="math inline">\(p\)</span> in the interval <span class="math inline">\([2,6]\)</span> by counting the two sign changes here:</p>
<pre class="{julia}"><code>mobius_transformation(𝐩, 2,6)</code></pre>
<p>This observation, along with a detailed analysis provided by <a href="https://dl.acm.org/doi/10.1145/2930889.2930937">Kobel, Rouillier, and Sagraloff</a> provides a means to find intervals that enclose the real roots of a polynomial.</p>
<p>The basic algorithm, as presented next, is fairly simple to understand, and hints at the bisection algorithm to come. It is due to Akritas and Collins. Suppose you know the only possible positive real roots are between <span class="math inline">\(0\)</span> and <span class="math inline">\(M\)</span> <em>and</em> no roots are repeated. Find the transformed polynomial over <span class="math inline">\([0,M]\)</span>:</p>
<ul>
<li>If there are no sign changes, then there are no roots of <span class="math inline">\(p\)</span> in <span class="math inline">\([0,M]\)</span>.</li>
<li>If there is one sign change, then there is a single root of <span class="math inline">\(p\)</span> in <span class="math inline">\([0,M]\)</span>. The interval <span class="math inline">\([0,M]\)</span> is said to isolate the root (and the actual root can then be found by other means)</li>
<li>If there is more than one sign change, divide the interval in two (<span class="math inline">\([0,M/2]\)</span> and <span class="math inline">\([M/2,M]\)</span>, say) and apply the same consideration to each.</li>
</ul>
<p>Eventually, <strong>mathematically</strong> this will find isolating intervals for each positive real root. (The negative ones can be similarly isolated.)</p>
<p>Applying these steps to <span class="math inline">\(p\)</span> with an initial interval, say <span class="math inline">\([0,9]\)</span>, we would have:</p>
<pre class="{julia}"><code>#| hold: true
p = fromroots([1,3,5])               #  (x-1)⋅(x-3)⋅(x-5) = -15 + 23*x - 9*x^2 + x^3
mobius_transformation(p, 0, 9) # 3
mobius_transformation(p, 0, 9//2)    # 2
mobius_transformation(p, 9//2, 9)    # 1 (and done)
mobius_transformation(p, 0, 9//4)    # 1 (and done)
mobius_transformation(p, 9//4, 9//2) # 1 (and done)</code></pre>
<p>So the three roots (<span class="math inline">\(1\)</span>, <span class="math inline">\(3\)</span>, <span class="math inline">\(5\)</span>) are isolated by <span class="math inline">\([0, 9/4]\)</span>, <span class="math inline">\([9/4, 9/2]\)</span>, and <span class="math inline">\([9/2, 9]\)</span>.</p>
</section>
<section id="the-realpolynomialroots-package." class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="the-realpolynomialroots-package."><span class="header-section-number">14.4.1</span> The <code>RealPolynomialRoots</code> package.</h3>
<p>For square-free polynomials, the <code>RealPolynomialRoots</code> package implements a basic version of the paper of <a href="https://dl.acm.org/doi/10.1145/2930889.2930937">Kobel, Rouillier, and Sagraloff</a> to identify the real roots of a polynomial using the Descartes rule of signs and the Möbius transformations just described.</p>
<p>The <code>ANewDsc</code> function takes a collection of coefficients representing a polynomial and returns isolating intervals for each real root. For example:</p>
<pre class="{julia}"><code>p₀ = fromroots([1,3,5])
st = ANewDsc(coeffs(p₀))</code></pre>
<p>These intervals can be refined to give accurate approximations to the roots:</p>
<pre class="{julia}"><code>refine_roots(st)</code></pre>
<p>More challenging problems can be readily handled by this package. The following polynomial</p>
<pre class="{julia}"><code>𝒔 = Polynomial([0,1]) # also just variable(Polynomial{Int})
𝒖 = -1 + 254*𝒔 - 16129*𝒔^2 + 𝒔^15</code></pre>
<p>has three real roots, two of which are clustered very close to each other:</p>
<pre class="{julia}"><code>𝒔𝒕 = ANewDsc(coeffs(𝒖))</code></pre>
<p>and</p>
<pre class="{julia}"><code>refine_roots(𝒔𝒕)</code></pre>
<p>The SymPy package (<code>sympy.real_roots</code>) can accurately identify the three roots but it can take a <strong>very</strong> long time. The <code>Polynomials.roots</code> function from the <code>Polynomials</code> package identifies the cluster as complex valued. Though the implementation in <code>RealPolynomialRoots</code> doesn’t handle such large polynomials, the authors of the algorithm have implementations that can quickly solve polynomials with degrees as high as <span class="math inline">\(10,000\)</span>.</p>
</section>
</section>
<section id="questions" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="questions"><span class="header-section-number">14.5</span> Questions</h2>
<section id="question" class="level6">
<h6 class="anchored" data-anchor-id="question">Question</h6>
<p>The rational expression <span class="math inline">\((x^3 - 2x + 3) / (x^2 - x + 1)\)</span> would have</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"A horizontal asymptote $y=0$",
L"A horizontal asymptote $y=1$",
L"A slant asymptote with slope $m=1$"]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-1" class="level6">
<h6 class="anchored" data-anchor-id="question-1">Question</h6>
<p>The rational expression <span class="math inline">\((x^2 - x + 1)/ (x^3 - 2x + 3)\)</span> would have</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"A horizontal asymptote $y=0$",
L"A horizontal asymptote $y=1$",
L"A slant asymptote with slope $m=1$"]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-2" class="level6">
<h6 class="anchored" data-anchor-id="question-2">Question</h6>
<p>The rational expression <span class="math inline">\((x^2 - x + 1)/ (x^2 - 3x + 3)\)</span> would have</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"A horizontal asymptote $y=0$",
L"A horizontal asymptote $y=1$",
L"A slant asymptote with slope $m=1$"]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-3" class="level6">
<h6 class="anchored" data-anchor-id="question-3">Question</h6>
<p>The rational expression</p>
<p><span class="math display">\[
\frac{(x-1)\cdot(x-2)\cdot(x-3)}{(x-4)\cdot(x-5)\cdot(x-6)}
\]</span></p>
<p>would have</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"A horizontal asymptote $y=0$",
L"A horizontal asymptote $y=1$",
L"A slant asymptote with slope $m=1$"]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-4" class="level6">
<h6 class="anchored" data-anchor-id="question-4">Question</h6>
<p>The rational expression</p>
<p><span class="math display">\[
\frac{(x-1)\cdot(x-2)\cdot(x-3)}{(x-4)\cdot(x-5)\cdot(x-6)}
\]</span></p>
<p>would have</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"A vertical asymptote $x=1$",
L"A slant asymptote with slope $m=1$",
L"A vertical asymptote $x=5$"
]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-5" class="level6">
<h6 class="anchored" data-anchor-id="question-5">Question</h6>
<p>The rational expression</p>
<p><span class="math display">\[
\frac{x^3 - 3x^2 + 2x}{3x^2 - 6x + 2}
\]</span></p>
<p>has a slant asymptote. What is the equation of that line?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "``y = 3x``",
    "``y = (1/3)x``",
    "``y = (1/3)x - (1/3)``"
]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-6" class="level6">
<h6 class="anchored" data-anchor-id="question-6">Question</h6>
<p>Look at the graph of the function <span class="math inline">\(f(x) = ((x-1)\cdot(x-2)) / ((x-3)\cdot(x-4))\)</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = ((x-1) * (x-2)) / ((x-3) *(x-4))
delta = 1e-1
col = :blue
p = plot(f, -1, 3-delta, color=col, legend=false)
plot!(p, f, 3+delta, 4-3delta, color=col)
plot!(p,f, 4 + 5delta, 9, color=col)
p</code></pre>
<p>Is the following common conception true: “The graph of a function never crosses its asymptotes.”</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["No, the graph clearly crosses the drawn asymptote",
"Yes, this is true"]
answ = 1
radioq(choices, answ)</code></pre>
<p>(The wikipedia page indicates that the term “asymptote” was introduced by Apollonius of Perga in his work on conic sections, but in contrast to its modern meaning, he used it to mean any line that does not intersect the given curve. It can sometimes take a while to change perception.)</p>
</section>
<section id="question-7" class="level6">
<h6 class="anchored" data-anchor-id="question-7">Question</h6>
<p>Consider the two graphs of <span class="math inline">\(f(x) = 1/x\)</span> over <span class="math inline">\([10,20]\)</span> and <span class="math inline">\([100, 200]\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
plot(x -&gt; 1/x, 10, 20)</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
plot(x -&gt; 1/x, 100, 200)</code></pre>
<p>The two shapes are basically identical and do not look like straight lines. How does this reconcile with the fact that <span class="math inline">\(f(x)=1/x\)</span> has a horizontal asymptote <span class="math inline">\(y=0\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["The horizontal asymptote is not a straight line.",
L"The $y$-axis scale shows that indeed the $y$ values are getting close to $0$.",
L"The graph is always decreasing, hence it will eventually reach $-\infty$."
]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-8" class="level6">
<h6 class="anchored" data-anchor-id="question-8">Question</h6>
<p>The amount of drug in a bloodstream after <span class="math inline">\(t\)</span> hours is modeled by the rational function</p>
<p><span class="math display">\[
r(t) = \frac{50t^2}{t^3 + 20}, \quad t \geq  0.
\]</span></p>
<p>What is the amount of the drug after <span class="math inline">\(1\)</span> hour?</p>
<pre class="{julia}"><code>#| echo: false
r1(t) = 50t^2 / (t^3 + 20)</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = r1(1)
numericq(val)</code></pre>
<p>What is the amount of drug in the bloodstream after 24 hours?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = r1(24)
numericq(val)</code></pre>
<p>What is more accurate: the peak amount is</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["between ``0`` and ``8`` hours",
           "between ``8`` and ``16`` hours",
           "between ``16`` and ``24`` hours",
           "after one day"]
answ = 1
radioq(choices, answ)</code></pre>
<p>This graph has</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [L"a slant asymptote with slope $50$",
L"a horizontal asymptote $y=20$",
L"a horizontal asymptote $y=0$",
L"a vertical asymptote with $x = 20^{1/3}$"]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-9" class="level6">
<h6 class="anchored" data-anchor-id="question-9">Question</h6>
<p>The (low-order) Pade approximation for <span class="math inline">\(\sin(x)\)</span> was seen to be <span class="math inline">\((x - 7/60 \cdot x^3)/(1 + 1/20 \cdot x^2)\)</span>. The graph showed that this approximation was fairly close over <span class="math inline">\([-\pi, \pi]\)</span>. Without graphing would you expect the behaviour of the function and its approximation to be similar for <em>large</em> values of <span class="math inline">\(x\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(false)</code></pre>
<p>Why?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"The $\sin(x)$ oscillates, but the rational function eventually follows $7/60 \cdot x^3$",
L"The $\sin(x)$ oscillates, but the rational function has a slant asymptote",
L"The $\sin(x)$ oscillates, but the rational function has a non-zero horizontal asymptote",
L"The $\sin(x)$ oscillates, but the rational function has a horizontal asymptote of $0$"]
answ = 2
radioq(choices, answ)</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../precalc/polynomials_package.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../precalc/exp_log_functions.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>