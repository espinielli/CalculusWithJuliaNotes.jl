<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 35&nbsp; Taylor Polynomials and other Approximating Polynomials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../integrals.html" rel="next">
<link href="../derivatives/related_rates.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-secant-line-and-the-tangent-line" id="toc-the-secant-line-and-the-tangent-line" class="nav-link active" data-scroll-target="#the-secant-line-and-the-tangent-line"><span class="toc-section-number">35.1</span>  The secant line and the tangent line</a></li>
  <li><a href="#quadratic-approximations-interpolating-polynomials" id="toc-quadratic-approximations-interpolating-polynomials" class="nav-link" data-scroll-target="#quadratic-approximations-interpolating-polynomials"><span class="toc-section-number">35.2</span>  Quadratic approximations; interpolating polynomials</a></li>
  <li><a href="#the-taylor-polynomial-of-degree-n" id="toc-the-taylor-polynomial-of-degree-n" class="nav-link" data-scroll-target="#the-taylor-polynomial-of-degree-n"><span class="toc-section-number">35.3</span>  The Taylor polynomial of degree <span class="math inline">\(n\)</span></a>
  <ul class="collapse">
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting"><span class="toc-section-number">35.3.1</span>  Plotting</a></li>
  </ul></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="toc-section-number">35.4</span>  Questions</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="toc-section-number">35.5</span>  Appendix</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/derivatives/taylor_series_polynomials.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses these add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using Plots
using SymPy
using Unitful</code></pre>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"
using CalculusWithJulia.WeaveSupport
using Roots

fig_size = (800, 600)
const frontmatter = (
        title = "Taylor Polynomials and other Approximating Polynomials",
        description = "Calculus with Julia: Taylor Polynomials and other Approximating Polynomials",
        tags = ["CalculusWithJulia", "derivatives", "taylor polynomials and other approximating polynomials"],
);
nothing</code></pre>
<p>The tangent line was seen to be the “best” linear approximation to a function at a point <span class="math inline">\(c\)</span>. Approximating a function by a linear function gives an easier to use approximation at the expense of accuracy. It suggests a tradeoff between ease and accuracy. Is there a way to gain more accuracy at the expense of ease?</p>
<p>Quadratic functions are still fairly easy to work with. Is it possible to find the best “quadratic” approximation to a function at a point <span class="math inline">\(c\)</span>.</p>
<p>More generally, for a given <span class="math inline">\(n\)</span>, what would be the best polynomial of degree <span class="math inline">\(n\)</span> to approximate <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(c\)</span>?</p>
<p>We will see in this section how the Taylor polynomial answers these questions, and is the appropriate generalization of the tangent line approximation.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
#| cache: true
###{{{taylor_animation}}}
taylor(f, x, c, n) = series(f, x, c, n+1).removeO()
function make_taylor_plot(u, a, b, k)
    k = 2k
    plot(u, a, b, title="plot of T_$k", linewidth=5, legend=false, size=fig_size, ylim=(-2,2.5))
    if k == 1
        plot!(zero, range(a, stop=b, length=100))
    else
        plot!(taylor(u, x, 0, k), range(a, stop=b, length=100))
    end
end



@syms x
u = 1 - cos(x)
a, b = -2pi, 2pi
n = 8
anim = @animate for i=1:n
    make_taylor_plot(u, a, b, i)
end

imgfile = tempname() * ".gif"
gif(anim, imgfile, fps = 1)


caption = L"""

Illustration of the Taylor polynomial of degree $k$, $T_k(x)$, at $c=0$ and its graph overlayed on that of the function $1 - \cos(x)$.

"""

ImageFile(imgfile, caption)</code></pre>
<section id="the-secant-line-and-the-tangent-line" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="the-secant-line-and-the-tangent-line"><span class="header-section-number">35.1</span> The secant line and the tangent line</h2>
<p>We approach this general problem <strong>much</strong> more indirectly than is needed. We introducing notations that are attributed to Newton and proceed from there. By leveraging <code>SymPy</code> we avoid tedious computations and <em>hopefully</em> gain some insight.</p>
<p>Suppose <span class="math inline">\(f(x)\)</span> is a function which is defined in a neighborhood of <span class="math inline">\(c\)</span> and has as many continuous derivatives as we care to take at <span class="math inline">\(c\)</span>.</p>
<p>We have two related formulas:</p>
<ul>
<li>The <em>secant line</em> connecting <span class="math inline">\((c, f(c))\)</span> and <span class="math inline">\((c+h, f(c+h))\)</span> for a value of <span class="math inline">\(h&gt;0\)</span> is given in point-slope form by</li>
</ul>
<p><span class="math display">\[
sl(x) = f(c) + \frac{(f(c+h) - f(c))}{h} \cdot (x-c).
\]</span></p>
<p>The slope is the familiar approximation to the derivative: <span class="math inline">\((f(c+h)-f(c))/h\)</span>.</p>
<ul>
<li>The <em>tangent line</em> to the graph of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x=c\)</span> is described by the function</li>
</ul>
<p><span class="math display">\[
tl(x) = f(c) + f'(c) \cdot(x - c).
\]</span></p>
<p>The key is the term multiplying <span class="math inline">\((x-c)\)</span> for the secant line is an approximation to the related term for the tangent line. That is, the secant line approximates the tangent line, which is the linear function that best approximates the function at the point <span class="math inline">\((c, f(c))\)</span>. This is quantified by the <em>mean value theorem</em> which states under our assumptions on <span class="math inline">\(f(x)\)</span> that there exists some <span class="math inline">\(\xi\)</span> between <span class="math inline">\(x\)</span> and <span class="math inline">\(c\)</span> for which:</p>
<p><span class="math display">\[
f(x) - tl(x) = \frac{f''(\xi)}{2} \cdot (x-c)^2.
\]</span></p>
<p>The term “best” is deserved, as any other straight line will differ at least in an <span class="math inline">\((x-c)\)</span> term, which in general is larger than an <span class="math inline">\((x-c)^2\)</span> term for <span class="math inline">\(x\)</span> “near” <span class="math inline">\(c\)</span>.</p>
<p>(This is a consequence of Cauchy’s mean value theorem with <span class="math inline">\(F(c) = f(c) - f'(c)\cdot(c-x)\)</span> and <span class="math inline">\(G(c) = (c-x)^2\)</span></p>
<p><span class="math display">\[
\begin{align*}
\frac{F'(\xi)}{G'(\xi)} &amp;=
\frac{f'(\xi) - f''(\xi)(\xi-x) - f(\xi)\cdot 1}{2(\xi-x)} \\
&amp;= -f''(\xi)/2\\
&amp;= \frac{F(c) - F(x)}{G(c) - G(x)}\\
&amp;= \frac{f(c) - f'(c)(c-x) - (f(x) - f'(x)(x-x))}{(c-x)^2 - (x-x)^2} \\
&amp;= \frac{f(c) + f'(c)(x-c) - f(x)}{(x-c)^2}
\end{align*}
\]</span></p>
<p>That is, <span class="math inline">\(f(x) = f(c) + f'(c)(x-c) + f''(\xi)/2\cdot(x-c)^2\)</span>, or <span class="math inline">\(f(x)-tl(x)\)</span> is as described.)</p>
<p>The secant line also has an interpretation that will generalize - it is the smallest order polynomial that goes through, or <em>interpolates</em>, the points <span class="math inline">\((c,f(c))\)</span> and <span class="math inline">\((c+h, f(c+h))\)</span>. This is obvious from the construction - as this is how the slope is derived - but from the formula itself requires showing <span class="math inline">\(tl(c) = f(c)\)</span> and <span class="math inline">\(tl(c+h) = f(c+h)\)</span>. The former is straightforward, as <span class="math inline">\((c-c) = 0\)</span>, so clearly <span class="math inline">\(tl(c) = f(c)\)</span>. The latter requires a bit of algebra.</p>
<p>We have:</p>
<blockquote class="blockquote">
<p>The best <em>linear</em> approximation at a point <span class="math inline">\(c\)</span> is related to the <em>linear</em> polynomial interpolating the points <span class="math inline">\(c\)</span> and <span class="math inline">\(c+h\)</span> as <span class="math inline">\(h\)</span> goes to <span class="math inline">\(0\)</span>.</p>
</blockquote>
<p>This is the relationship we seek to generalize through our round about approach below:</p>
<blockquote class="blockquote">
<p>The best approximation at a point <span class="math inline">\(c\)</span> by a polynomial of degree <span class="math inline">\(n\)</span> or less is related to the polynomial interpolating through the points <span class="math inline">\(c, c+h, \dots, c+nh\)</span> as <span class="math inline">\(h\)</span> goes to <span class="math inline">\(0\)</span>.</p>
</blockquote>
<p>As in the linear case, there is flexibility in the exact points chosen for the interpolation.</p>
<hr>
<p>Now, we take a small detour to define some notation. Instead of writing our two points as <span class="math inline">\(c\)</span> and <span class="math inline">\(c+h,\)</span> we use <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_1\)</span>. For any set of points <span class="math inline">\(x_0, x_1, \dots, x_n\)</span>, define the <strong>divided differences</strong> of <span class="math inline">\(f\)</span> inductively, as follows:</p>
<p><span class="math display">\[
\begin{align}
f[x_0] &amp;= f(x_0) \\
f[x_0, x_1] &amp;= \frac{f[x_1] - f[x_0]}{x_1 - x_0}\\
\cdots &amp;\\
f[x_0, x_1, x_2, \dots, x_n] &amp;= \frac{f[x_1, \dots, x_n] - f[x_0, x_1, x_2, \dots, x_{n-1}]}{x_n - x_0}.
\end{align}
\]</span></p>
<p>We see the first two values look familiar, and to generate more we just take certain ratios akin to those formed when finding a secant line.</p>
<p>With this notation the secant line can be re-expressed as:</p>
<p><span class="math display">\[
sl(x) = f[c] + f[c, c+h] \cdot (x-c).
\]</span></p>
<p>If we think of <span class="math inline">\(f[c, c+h]\)</span> as an approximate <em>first</em> derivative, we have an even stronger parallel between a secant line <span class="math inline">\(x=c\)</span> and the tangent line at <span class="math inline">\(x=c\)</span>: <span class="math inline">\(tl(x) = f(c) + f'(c)\cdot (x-c)\)</span>.</p>
<p>We use <code>SymPy</code> to investigate. First we create a <em>recursive</em> function to compute the divided differences:</p>
<pre class="{julia}"><code>divided_differences(f, x) = f(x)

function divided_differences(f, x, xs...)
    xs = sort(vcat(x, xs...))
    (divided_differences(f, xs[2:end]...) - divided_differences(f, xs[1:end-1]...)) / (xs[end] - xs[1])
end</code></pre>
<p>In the following, by adding a <code>getindex</code> method, we enable the <code>[]</code> notation of Newton to work with symbolic functions, like <code>u()</code> defined below, which is used in place of <span class="math inline">\(f\)</span>:</p>
<pre class="{julia}"><code>Base.getindex(u::SymFunction, xs...) = divided_differences(u, xs...)

@syms x::real c::real h::positive u()
ex = u[c, c+h]</code></pre>
<p>We can take a limit and see the familiar (yet differently represented) value of <span class="math inline">\(u'(c)\)</span>:</p>
<pre class="{julia}"><code>limit(ex, h =&gt; 0)</code></pre>
<p>The choice of points is flexible. Here we use <span class="math inline">\(c-h\)</span> and <span class="math inline">\(c+h\)</span>:</p>
<pre class="{julia}"><code>limit(u[c-h, c+h], h=&gt;0)</code></pre>
<p>Now, let’s look at:</p>
<pre class="{julia}"><code>ex₂ = u[c, c+h, c+2h]
simplify(ex₂)</code></pre>
<p>Not so bad after simplification. The limit shows this to be an approximation to the second derivative divided by <span class="math inline">\(2\)</span>:</p>
<pre class="{julia}"><code>limit(ex₂, h =&gt; 0)</code></pre>
<p>(The expression is, up to a divisor of <span class="math inline">\(2\)</span>, the second order forward <a href="http://tinyurl.com/n4235xy">difference equation</a>, a well-known approximation to <span class="math inline">\(f''\)</span>.)</p>
<p>This relationship between higher-order divided differences and higher-order derivatives generalizes. This is expressed in this <a href="http://tinyurl.com/zjogv83">theorem</a>:</p>
<blockquote class="blockquote">
<p>Suppose <span class="math inline">\(m=x_0 &lt; x_1 &lt; x_2 &lt; \dots &lt; x_n=M\)</span> are distinct points. If <span class="math inline">\(f\)</span> has <span class="math inline">\(n\)</span> continuous derivatives then there exists a value <span class="math inline">\(\xi\)</span>, where <span class="math inline">\(m &lt; \xi &lt; M\)</span>, satisfying:</p>
</blockquote>
<p><span class="math display">\[
f[x_0, x_1, \dots, x_n] = \frac{1}{n!} \cdot f^{(n)}(\xi).
\]</span></p>
<p>This immediately applies to the above, where we parameterized by <span class="math inline">\(h\)</span>: <span class="math inline">\(x_0=c, x_1=c+h, x_2 = c+2h\)</span>. For then, as <span class="math inline">\(h\)</span> goes to <span class="math inline">\(0\)</span>, it must be that <span class="math inline">\(m, M \rightarrow c\)</span>, and so the limit of the divided differences must converge to <span class="math inline">\((1/2!) \cdot f^{(2)}(c)\)</span>, as <span class="math inline">\(f^{(2)}(\xi)\)</span> converges to <span class="math inline">\(f^{(2)}(c)\)</span>.</p>
<p>A proof based on Rolle’s theorem appears in the appendix.</p>
</section>
<section id="quadratic-approximations-interpolating-polynomials" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="quadratic-approximations-interpolating-polynomials"><span class="header-section-number">35.2</span> Quadratic approximations; interpolating polynomials</h2>
<p>Why the fuss? The answer comes from a result of Newton on <em>interpolating</em> polynomials. Consider a function <span class="math inline">\(f\)</span> and <span class="math inline">\(n+1\)</span> points <span class="math inline">\(x_0\)</span>, <span class="math inline">\(x_1, \dots, x_n\)</span>. Then an interpolating polynomial is a polynomial of least degree that goes through each point <span class="math inline">\((x_i, f(x_i))\)</span>. The <a href="https://en.wikipedia.org/wiki/Newton_polynomial">Newton form</a> of such a polynomial can be written as:</p>
<p><span class="math display">\[
\begin{align*}
f[x_0] &amp;+ f[x_0,x_1] \cdot (x-x_0) + f[x_0, x_1, x_2] \cdot (x-x_0) \cdot (x-x_1) + \\
&amp; \cdots + f[x_0, x_1, \dots, x_n] \cdot (x-x_0)\cdot \cdots \cdot (x-x_{n-1}).
\end{align*}
\]</span></p>
<p>The case <span class="math inline">\(n=0\)</span> gives the value <span class="math inline">\(f[x_0] = f(c)\)</span>, which can be interpreted as the slope-<span class="math inline">\(0\)</span> line that goes through the point <span class="math inline">\((c,f(c))\)</span>.</p>
<p>We are familiar with the case <span class="math inline">\(n=1\)</span>, with <span class="math inline">\(x_0=c\)</span> and <span class="math inline">\(x_1=c+h\)</span>, this becomes our secant-line formula:</p>
<p><span class="math display">\[
f[c] + f[c, c+h](x-c).
\]</span></p>
<p>As mentioned, we can verify directly that it interpolates the points <span class="math inline">\((c,f(c))\)</span> and <span class="math inline">\((c+h, f(c+h))\)</span>. He we let <code>SymPy</code> do the algebra:</p>
<pre class="{julia}"><code>p₁ = u[c] + u[c, c+h] * (x-c)
p₁(x =&gt; c) - u(c), p₁(x =&gt; c+h) - u(c+h)</code></pre>
<p>Now for something new. Take the <span class="math inline">\(n=2\)</span> case with <span class="math inline">\(x_0 = c\)</span>, <span class="math inline">\(x_1 = c + h\)</span>, and <span class="math inline">\(x_2 = c+2h\)</span>. Then the interpolating polynomial is:</p>
<p><span class="math display">\[
f[c] + f[c, c+h](x-c) + f[c, c+h, c+2h](x-c)(x-(c+h)).
\]</span></p>
<p>We add the next term to our previous polynomial and simplify</p>
<pre class="{julia}"><code>p₂ = p₁ + u[c, c+h, c+2h] * (x-c) * (x-(c+h))
simplify(p₂)</code></pre>
<p>We can check that this interpolates the three points. Notice that at <span class="math inline">\(x_0=c\)</span> and <span class="math inline">\(x_1=c+h\)</span>, the last term, <span class="math inline">\(f[x_0, x_1, x_2]\cdot(x-x_0)(x-x_1)\)</span>, vanishes, so we already have the polynomial interpolating there. Only the value <span class="math inline">\(x_2=c+2h\)</span> remains to be checked:</p>
<pre class="{julia}"><code>p₂(x =&gt; c+2h) - u(c+2h)</code></pre>
<p>Hmm, doesn’t seem correct - that was supposed to be <span class="math inline">\(0\)</span>. The issue isn’t the math, it is that SymPy needs to be encouraged to simplify:</p>
<pre class="{julia}"><code>simplify(p₂(x =&gt; c+2h) - u(c+2h))</code></pre>
<p>By contrast, at the point <span class="math inline">\(x=c+3h\)</span> we have no guarantee of interpolation, and indeed don’t, as this expression is non always zero:</p>
<pre class="{julia}"><code>simplify(p₂(x =&gt; c+3h) - u(c+3h))</code></pre>
<p>Interpolating polynomials are of interest in their own right, but for now we want to use them as motivation for the best polynomial approximation of a certain degree for a function. Motivated by how the secant line leads to the tangent line, we note that coefficients of the quadratic interpolating polynomial above have limits as <span class="math inline">\(h\)</span> goes to <span class="math inline">\(0\)</span>, leaving this polynomial:</p>
<p><span class="math display">\[
f(c) + f'(c) \cdot (x-c) + \frac{1}{2!} \cdot f''(c) (x-c)^2.
\]</span></p>
<p>This is clearly related to the tangent line approximation of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x=c\)</span>, but carrying an extra quadratic term.</p>
<p>Here we visualize the approximations with the function <span class="math inline">\(f(x) = \cos(x)\)</span> at <span class="math inline">\(c=0\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
f(x) = cos(x)
a, b = -pi/2, pi/2
c = 0
h = 1/4

fp = -sin(c)  # by hand, or use diff(f), ...
fpp = -cos(c)


p = plot(f, a, b, linewidth=5, legend=false, color=:blue)
plot!(p, x-&gt;f(c) + fp*(x-c), a, b; color=:green, alpha=0.25, linewidth=5)                     # tangent line is flat
plot!(p, x-&gt;f(c) + fp*(x-c) + (1/2)*fpp*(x-c)^2, a, b; color=:green, alpha=0.25, linewidth=5)  # a parabola
p</code></pre>
<p>This graph illustrates that the extra quadratic term can track the curvature of the function, whereas the tangent line itself can’t. So, we have a polynomial which is a “better” approximation, is it the best approximation?</p>
<p>The Cauchy mean value theorem, as in the case of the tangent line, will guarantee the existence of <span class="math inline">\(\xi\)</span> between <span class="math inline">\(c\)</span> and <span class="math inline">\(x\)</span>, for which</p>
<p><span class="math display">\[
f(x) - \left(f(c) + f'(c) \cdot(x-c) + \frac{1}{2}\cdot f''(c) \cdot (x-c)^2 \right) =
\frac{1}{3!}f'''(\xi) \cdot (x-c)^3.
\]</span></p>
<p>In this sense, the above quadratic polynomial, called the Taylor Polynomial of degree 2, is the best <em>quadratic</em> approximation to <span class="math inline">\(f\)</span>, as the difference goes to <span class="math inline">\(0\)</span> at a rate of <span class="math inline">\((x-c)^3\)</span>.</p>
<p>The graphs of the secant line and approximating parabola for <span class="math inline">\(h=1/4\)</span> are similar:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = cos(x)
a, b = -pi/2, pi/2
c = 0
h = 1/4

x0, x1, x2 = c-h, c, c+h

f0 = divided_differences(f, x0)
fd = divided_differences(f, x0, x1)
fdd = divided_differences(f, x0, x1, x2)

p = plot(f, a, b, color=:blue, linewidth=5, legend=false)
plot!(p, x -&gt; f0 + fd*(x-x0), a, b, color=:green, alpha=0.25, linewidth=5);
plot!(p, x -&gt; f0 + fd*(x-x0) + fdd * (x-x0)*(x-x1), a,b, color=:green, alpha=0.25, linewidth=5);
p</code></pre>
<p>Though similar, the graphs are <strong>not</strong> identical, as the interpolating polynomials aren’t the best approximations. For example, in the tangent-line graph the parabola only intersects the cosine graph at <span class="math inline">\(x=0\)</span>, whereas for the secant-line graph - by definition - the parabola intersects the graph at least <span class="math inline">\(2\)</span> times and the interpolating polynomial <span class="math inline">\(3\)</span> times (at <span class="math inline">\(x_0\)</span>, <span class="math inline">\(x_1\)</span>, and <span class="math inline">\(x_2\)</span>).</p>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example</h5>
<p>Consider the function <span class="math inline">\(f(t) = \log(1 + t)\)</span>. We have mentioned that for <span class="math inline">\(t\)</span> small, the value <span class="math inline">\(t\)</span> is a good approximation. A better one becomes:</p>
<p><span class="math display">\[
f(0) + f'(0) \cdot t + \frac{1}{2} \cdot f''(0) \cdot t^2 = 0 + 1t - \frac{t^2}{2}
\]</span></p>
<p>A graph shows the difference:</p>
<pre class="{julia}"><code>#| hold: true
f(t) = log(1 + t)
a, b = -1/2, 1
plot(f, a, b, legend=false, linewidth=5)
plot!(t -&gt; t, a, b)
plot!(t -&gt; t - t^2/2, a, b)</code></pre>
<p>Though we can see that the tangent line is a good approximation, the quadratic polynomial tracks the logarithm better farther from <span class="math inline">\(c=0\)</span>.</p>
</section>
<section id="example-1" class="level5">
<h5 class="anchored" data-anchor-id="example-1">Example</h5>
<p>A wire is bent in the form of a half circle with radius <span class="math inline">\(R\)</span> centered at <span class="math inline">\((0,R)\)</span>, so the bottom of the wire is at the origin. A bead is released on the wire at angle <span class="math inline">\(\theta\)</span>. As time evolves, the bead will slide back and forth. How? (Ignoring friction.)</p>
<p>Let <span class="math inline">\(U\)</span> be the potential energy, <span class="math inline">\(U=mgh = mgR \cdot (1 - \cos(\theta))\)</span>. The velocity of the object will depend on <span class="math inline">\(\theta\)</span> - it will be <span class="math inline">\(0\)</span> at the high point, and largest in magnitude at the bottom - and is given by <span class="math inline">\(v(\theta) = R \cdot d\theta/ dt\)</span>. (The bead moves along the wire so its distance traveled is <span class="math inline">\(R\cdot \Delta \theta\)</span>, this, then, is just the time derivative of distance.)</p>
<p>By ignoring friction, the total energy is conserved giving:</p>
<p><span class="math display">\[
K = \frac{1}{2}m v^2 + mgR \cdot (1 - \cos(\theta) =
\frac{1}{2} m R^2 (\frac{d\theta}{dt})^2 +  mgR \cdot (1 - \cos(\theta)).
\]</span></p>
<p>The value of <span class="math inline">\(1-\cos(\theta)\)</span> inhibits further work which would be possible were there an easier formula there. In fact, we could try the excellent approximation <span class="math inline">\(1 - \theta^2/2\)</span> from the quadratic approximation. Then we have:</p>
<p><span class="math display">\[
K \approx \frac{1}{2} m R^2 (\frac{d\theta}{dt})^2 +  mgR \cdot (1 - \theta^2/2).
\]</span></p>
<p>Assuming equality and differentiating in <span class="math inline">\(t\)</span> gives by the chain rule:</p>
<p><span class="math display">\[
0 = \frac{1}{2} m R^2 2\frac{d\theta}{dt} \cdot \frac{d^2\theta}{dt^2} - mgR \theta\cdot \frac{d\theta}{dt}.
\]</span></p>
<p>This can be solved to give this relationship:</p>
<p><span class="math display">\[
\frac{d^2\theta}{dt^2} = - \frac{g}{R}\theta.
\]</span></p>
<p>The solution to this “equation” can be written (in some parameterization) as <span class="math inline">\(\theta(t)=A\cos \left(\omega t+\phi \right)\)</span>. This motion is the well-studied simple <a href="https://en.wikipedia.org/wiki/Harmonic_oscillator">harmonic oscillator</a>, a model for a simple pendulum.</p>
</section>
<section id="example-optimization" class="level4">
<h4 class="anchored" data-anchor-id="example-optimization">Example: optimization</h4>
<p>Consider the following approach to finding the minimum or maximum of a function:</p>
<ul>
<li>At <span class="math inline">\(x_k\)</span> fit a quadratic polynomial to <span class="math inline">\(f(x)\)</span> matching the derivative and second derivative of <span class="math inline">\(f\)</span>.</li>
<li>Let <span class="math inline">\(x_{k+1}\)</span> be at the vertex of this fitted quadratic polynomial</li>
<li>Iterate to convergence</li>
</ul>
<p>The polynomial in question will be the Taylor polynomial of degree <span class="math inline">\(2\)</span>:</p>
<p><span class="math display">\[
T_2(x_k) = f(x_k) + f'(x_k)(x-x_k) + \frac{f''(x_k)}{2}(x - x_k)^2
\]</span></p>
<p>The vertex of this quadratic polynomial will be when its derivative is <span class="math inline">\(0\)</span> which can be solved for <span class="math inline">\(x_{k+1}\)</span> giving:</p>
<p><span class="math display">\[
x_{k+1} = x_k - \frac{f'(x_k)}{f''(x_k)}.
\]</span></p>
<p>This assumes <span class="math inline">\(f''(x_k)\)</span> is non-zero.</p>
<p>On inspection, it is seen that this is Newton’s method applied to <span class="math inline">\(f'(x)\)</span>. This method, when convergent, finds a zero of <span class="math inline">\(f'(x)\)</span>. We know that should the algorithm converge, it will have found a critical point, not necessarily a value for a local extrema.</p>
</section>
</section>
<section id="the-taylor-polynomial-of-degree-n" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="the-taylor-polynomial-of-degree-n"><span class="header-section-number">35.3</span> The Taylor polynomial of degree <span class="math inline">\(n\)</span></h2>
<p>Starting with the Newton form of the interpolating polynomial of smallest degree:</p>
<p><span class="math display">\[
\begin{align*}
f[x_0] &amp;+ f[x_0,x_1] \cdot (x - x_0) + f[x_0, x_1, x_2] \cdot (x - x_0)\cdot(x-x_1) + \\
&amp; \cdots + f[x_0, x_1, \dots, x_n] \cdot (x-x_0) \cdot \cdots \cdot (x-x_{n-1}).
\end{align*}
\]</span></p>
<p>and taking <span class="math inline">\(x_i = c + i\cdot h\)</span>, for a given <span class="math inline">\(n\)</span>, we have in the limit as <span class="math inline">\(h &gt; 0\)</span> goes to zero that coefficients of this polynomial converge to the coefficients of the <em>Taylor Polynomial of degree n</em>:</p>
<p><span class="math display">\[
f(c) + f'(c)\cdot(x-c) + \frac{f''(c)}{2!}(x-c)^2 + \cdots + \frac{f^{(n)}(c)}{n!} (x-c)^n.
\]</span></p>
<p>This polynomial will be the best approximation of degree <span class="math inline">\(n\)</span> or less to the function <span class="math inline">\(f\)</span>, near <span class="math inline">\(c\)</span>. The error will be given - again by an application of the Cauchy mean value theorem:</p>
<p><span class="math display">\[
\frac{1}{(n+1)!} \cdot f^{(n+1)}(\xi) \cdot (x-c)^n
\]</span></p>
<p>for some <span class="math inline">\(\xi\)</span> between <span class="math inline">\(c\)</span> and <span class="math inline">\(x\)</span>.</p>
<p>The Taylor polynomial for <span class="math inline">\(f\)</span> about <span class="math inline">\(c\)</span> of degree <span class="math inline">\(n\)</span> can be computed by taking <span class="math inline">\(n\)</span> derivatives. For such a task, the computer is very helpful. In <code>SymPy</code> the <code>series</code> function will compute the Taylor polynomial for a given <span class="math inline">\(n\)</span>. For example, here is the series expansion to 10 terms of the function <span class="math inline">\(\log(1+x)\)</span> about <span class="math inline">\(c=0\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
c, n = 0, 10
l = series(log(1 + x), x, c, n+1)</code></pre>
<p>A pattern can be observed.</p>
<p>Using <code>series</code>, we can see Taylor polynomials for several familiar functions:</p>
<pre class="{julia}"><code>series(1/(1-x), x, 0, 10)   # sum x^i for i in 0:n</code></pre>
<pre class="{julia}"><code>series(exp(x), x, 0, 10)    # sum x^i/i! for i in 0:n</code></pre>
<pre class="{julia}"><code>series(sin(x), x, 0, 10)    # sum (-1)^i * x^(2i+1) / (2i+1)! for i in 0:n</code></pre>
<pre class="{julia}"><code>series(cos(x), x, 0, 10)    # sum (-1)^i * x^(2i) / (2i)! for i in 0:n</code></pre>
<p>Each of these last three have a pattern that can be expressed quite succinctly if the denominator is recognized as <span class="math inline">\(n!\)</span>.</p>
<p>The output of <code>series</code> includes a big “Oh” term, which identifies the scale of the error term, but also gets in the way of using the output. <code>SymPy</code> provides the <code>removeO</code> method to strip this. (It is called as <code>object.removeO()</code>, as it is a method of an object in SymPy.)</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A Taylor polynomial of degree <span class="math inline">\(n\)</span> consists of <span class="math inline">\(n+1\)</span> terms and an error term. The “Taylor series” is an <em>infinite</em> collection of terms, the first <span class="math inline">\(n+1\)</span> matching the Taylor polynomial of degree <span class="math inline">\(n\)</span>. The fact that series are <em>infinite</em> means care must be taken when even talking about their existence, unlike a Tyalor polynomial, which is just a polynomial and exists as long as a sufficient number of derivatives are available.</p>
</div>
</div>
<p>We define a function to compute Taylor polynomials from a function. The following returns a function, not a symbolic object, using <code>D</code>, from <code>CalculusWithJulia</code>, which is based on <code>ForwardDiff.derivative</code>, to find higher-order derivatives:</p>
<pre class="{julia}"><code>function taylor_poly(f, c=0, n=2)
     x -&gt; f(c) + sum(D(f, i)(c) * (x-c)^i / factorial(i) for i in 1:n)
end</code></pre>
<p>With a function, we can compare values. For example, here we see the difference between the Taylor polynomial and the answer for a small value of <span class="math inline">\(x\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
a = .1
f(x) = log(1+x)
Tn = taylor_poly(f, 0, 5)
Tn(a) - f(a)</code></pre>
<section id="plotting" class="level3" data-number="35.3.1">
<h3 data-number="35.3.1" class="anchored" data-anchor-id="plotting"><span class="header-section-number">35.3.1</span> Plotting</h3>
<p>Let’s now visualize a function and the two approximations - the Taylor polynomial and the interpolating polynomial. We use this function to generate the interpolating polynomial as a function:</p>
<pre class="{julia}"><code>function newton_form(f, xs)
  x -&gt; begin
     tot = divided_differences(f, xs[1])
     for i in 2:length(xs)
        tot += divided_differences(f, xs[1:i]...) * prod([x-xs[j] for j in 1:(i-1)])
     end
     tot
  end
end</code></pre>
<p>To see a plot, we have</p>
<pre class="{julia}"><code>𝒇(x) = sin(x)
𝒄, 𝒉, 𝒏 = 0, 1/4, 4
int_poly = newton_form(𝒇, [𝒄 + i*𝒉 for i in 0:𝒏])
tp = taylor_poly(𝒇, 𝒄, 𝒏)
𝒂, 𝒃 = -pi, pi
plot(𝒇, 𝒂, 𝒃; linewidth=5, label="f")
plot!(int_poly; color=:green, label="interpolating")
plot!(tp; color=:red, label="Taylor")</code></pre>
<p>To get a better sense, we plot the residual differences here:</p>
<pre class="{julia}"><code>d1(x) = 𝒇(x) - int_poly(x)
d2(x) = 𝒇(x) - tp(x)
plot(d1, 𝒂, 𝒃; color=:blue, label="interpolating")
plot!(d2; color=:green, label="Taylor")</code></pre>
<p>The graph should be <span class="math inline">\(0\)</span> at each of the the points in <code>xs</code>, which we can verify in the graph above. Plotting over a wider region shows a common phenomenon that these polynomials approximate the function near the values, but quickly deviate away:</p>
<p>In this graph we make a plot of the Taylor polynomial for different sizes of <span class="math inline">\(n\)</span> for the function <span class="math inline">\(f(x) = 1 - \cos(x)\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x) = 1 - cos(x)
a, b = -pi, pi
plot(f, a, b, linewidth=5, label="f")
plot!(taylor_poly(f, 0, 2), label="T₂")
plot!(taylor_poly(f, 0, 4), label="T₄")
plot!(taylor_poly(f, 0, 6), label="T₆")</code></pre>
<p>Though all are good approximations near <span class="math inline">\(c=0\)</span>, as more terms are included, the Taylor polynomial becomes a better approximation over a wider range of values.</p>
<section id="example-period-of-an-orbiting-satellite" class="level5">
<h5 class="anchored" data-anchor-id="example-period-of-an-orbiting-satellite">Example: period of an orbiting satellite</h5>
<p>Kepler’s third <a href="http://tinyurl.com/y7oa4x2g">law</a> of planetary motion states:</p>
<blockquote class="blockquote">
<p>The square of the orbital period of a planet is directly proportional to the cube of the semi-major axis of its orbit.</p>
</blockquote>
<p>In formulas, <span class="math inline">\(P^2 = a^3 \cdot (4\pi^2) / (G\cdot(M + m))\)</span>, where <span class="math inline">\(M\)</span> and <span class="math inline">\(m\)</span> are the respective masses. Suppose a satellite is in low earth orbit with a constant height, <span class="math inline">\(a\)</span>. Use a Taylor polynomial to approximate the period using Kepler’s third law to relate the quantities.</p>
<p>Suppose <span class="math inline">\(R\)</span> is the radius of the earth and <span class="math inline">\(h\)</span> the height above the earth assuming <span class="math inline">\(h\)</span> is much smaller than <span class="math inline">\(R\)</span>. The mass <span class="math inline">\(m\)</span> of a satellite is negligible to that of the earth, so <span class="math inline">\(M+m=M\)</span> for this purpose. We have:</p>
<p><span class="math display">\[
P = \frac{2\pi}{\sqrt{G\cdot M}} \cdot (h+R)^{3/2} =  \frac{2\pi}{\sqrt{G\cdot M}} \cdot R^{3/2} \cdot (1 + h/R)^{3/2} = P_0 \cdot  (1 + h/R)^{3/2},
\]</span></p>
<p>where <span class="math inline">\(P_0\)</span> collects terms that involve the constants.</p>
<p>We can expand <span class="math inline">\((1+x)^{3/2}\)</span> to fifth order, to get:</p>
<p><span class="math display">\[
(1+x)^{3/2} \approx 1 + \frac{3x}{2} + \frac{3x^2}{8} - \frac{1x^3}{16} + \frac{3x^4}{128} -\frac{3x^5}{256}
\]</span></p>
<p>Our approximation becomes:</p>
<p><span class="math display">\[
P \approx P_0 \cdot (1 + \frac{3(h/R)}{2} + \frac{3(h/R)^2}{8} - \frac{(h/R)^3}{16} + \frac{3(h/R)^4}{128} - \frac{3(h/R)^5}{256}).
\]</span></p>
<p>Typically, if <span class="math inline">\(h\)</span> is much smaller than <span class="math inline">\(R\)</span> the first term is enough giving a formula like <span class="math inline">\(P \approx P_0 \cdot(1 + \frac{3h}{2R})\)</span>.</p>
<p>A satellite phone utilizes low orbit satellites to relay phone communications. The <a href="http://www.kddi.com/english/business/cloud-network-voice/satellite/iridium/mobile/">Iridium</a> system uses satellites with an elevation <span class="math inline">\(h=780km\)</span>. The radius of the earth is <span class="math inline">\(3,959 miles\)</span>, the mass of the earth is <span class="math inline">\(5.972 × 10^{24} kg\)</span>, and the gravitational <a href="https://en.wikipedia.org/wiki/Gravitational_constant">constant</a>, <span class="math inline">\(G\)</span> is <span class="math inline">\(6.67408 \cdot 10^{-11}\)</span> <span class="math inline">\(m^3/(kg \cdot s^2)\)</span>.</p>
<p>Compare the approximate value with <span class="math inline">\(1\)</span> term to the exact value.</p>
<pre class="{julia}"><code>G = 6.67408e-11
H = 780 * 1000
R = 3959 * 1609.34   # 1609 meters per mile
M = 5.972e24
P0, HR = (2pi)/sqrt(G*M) * R^(3/2), H/R

Preal = P0 * (1 + HR)^(3/2)
P1 = P0 * (1 + 3*HR/2)
Preal, P1</code></pre>
<p>With terms out to the fifth power, we get a better approximation:</p>
<pre class="{julia}"><code>P5 = P0 * (1 + 3*HR/2 + 3*HR^2/8 - HR^3/16 + 3*HR^4/128 - 3*HR^5/256)</code></pre>
<p>The units of the period above are in seconds. That answer here is about <span class="math inline">\(100\)</span> minutes:</p>
<pre class="{julia}"><code>Preal/60</code></pre>
<p>When <span class="math inline">\(H\)</span> is much smaller than <span class="math inline">\(R\)</span> the approximation with <span class="math inline">\(5\)</span>th order is really good, and serviceable with just <span class="math inline">\(1\)</span> term. Next we check if this is the same when <span class="math inline">\(H\)</span> is larger than <span class="math inline">\(R\)</span>.</p>
<hr>
<p>The height of a <a href="http://www.gps.gov/systems/gps/space/">GPS satellite</a> is about <span class="math inline">\(12,550\)</span> miles. Compute the period of a circular orbit and compare with the estimates.</p>
<pre class="{julia}"><code>Hₛ = 12250 * 1609.34   # 1609 meters per mile
HRₛ = Hₛ/R

Prealₛ = P0 * (1 + HRₛ)^(3/2)
P1ₛ = P0 * (1 + 3*HRₛ/2)
P5ₛ = P0 * (1 + 3*HRₛ/2 + 3*HRₛ^2/8 - HRₛ^3/16 + 3*HRₛ^4/128 - 3*HRₛ^5/256)

Prealₛ, P1ₛ, P5ₛ</code></pre>
<p>We see the Taylor polynomial underestimates badly in this case. A reminder that these approximations are locally good, but may not be good on all scales. Here <span class="math inline">\(h \approx 3R\)</span>. We can see from this graph of <span class="math inline">\((1+x)^{3/2}\)</span> and its <span class="math inline">\(5\)</span>th degree Taylor polynomial <span class="math inline">\(T_5\)</span> that it is a bad approximation when <span class="math inline">\(x &gt; 2\)</span>.</p>
<pre class="{julia}"><code>#| echo: false
f1(x) = (1+x)^(3/2)
p2(x) = 1 + 3x/2 + 3x^2/8 - x^3/16 + 3x^4/128 - 3x^5/256
plot(f1, -1, 3, linewidth=4, legend=false)
plot!(p2, -1, 3)</code></pre>
<hr>
<p>Finally, we show how to use the <code>Unitful</code> package. This package allows us to define different units, carry these units through computations, and convert between similar units with <code>uconvert</code>. In this example, we define several units, then show how they can then be used as constants.</p>
<pre class="{julia}"><code>#| hold: true
m, mi, kg, s, hr = u"m", u"mi", u"kg", u"s", u"hr"

G = 6.67408e-11 * m^3 / kg / s^2
H = uconvert(m, 12250 * mi)   # unit convert miles to meter
R = uconvert(m,  3959 * mi)
M = 5.972e24 * kg

P0, HR = (2pi)/sqrt(G*M) * R^(3/2), H/R
Preal = P0 * (1 + HR)^(3/2)    # in seconds
Preal, uconvert(hr, Preal)     # ≈ 11.65 hours</code></pre>
<p>We see <code>Preal</code> has the right units - the units of mass and distance cancel leaving a measure of time - but it is hard to sense how long this is. Converting to hours, helps us see the satellite orbits about twice per day.</p>
</section>
<section id="example-computing-logx" class="level5">
<h5 class="anchored" data-anchor-id="example-computing-logx">Example: computing <span class="math inline">\(\log(x)\)</span></h5>
<p>Where exactly does the value assigned to <span class="math inline">\(\log(5)\)</span> come from? The value needs to be computed. At some level, many questions resolve down to the basic operations of addition, subtraction, multiplication, and division. Preferably not the latter, as division is slow. Polynomials then should be fast to compute, and so computing logarithms using a polynomial becomes desirable.</p>
<p>But how? One can see details of a possible way <a href="https://github.com/musm/Amal.jl/blob/master/src/log.jl">here</a>.</p>
<p>First, there is usually a reduction stage. In this phase, the problem is transformed in a manner to one involving only a fixed interval of values. For this, function values of <span class="math inline">\(k\)</span> and <span class="math inline">\(m\)</span> are found so that <span class="math inline">\(x = 2^k \cdot (1+m)\)</span> <em>and</em> <span class="math inline">\(\sqrt{2}/2 &lt; 1+m &lt; \sqrt{2}\)</span>. If these are found, then <span class="math inline">\(\log(x)\)</span> can be computed with <span class="math inline">\(k \cdot \log(2) + \log(1+m)\)</span>. The first value - a multiplication - can easily be computed using pre-computed value of <span class="math inline">\(\log(2)\)</span>, the second then <em>reduces</em> the problem to an interval.</p>
<p>Now, for this problem a further trick is utilized, writing <span class="math inline">\(s= f/(2+f)\)</span> so that <span class="math inline">\(\log(1+m)=\log(1+s)-\log(1-s)\)</span> for some small range of <span class="math inline">\(s\)</span> values. These combined make it possible to compute <span class="math inline">\(\log(x)\)</span> for any real <span class="math inline">\(x\)</span>.</p>
<p>To compute <span class="math inline">\(\log(1\pm s)\)</span>, we can find a Taylor polynomial. Let’s go out to degree <span class="math inline">\(19\)</span> and use <code>SymPy</code> to do the work:</p>
<pre class="{julia}"><code>@syms s
aₗ = series(log(1 + s), s, 0, 19)
bₗ = series(log(1 - s), s, 0, 19)
a_b = (aₗ - bₗ).removeO()  # remove"Oh" not remove"zero"</code></pre>
<p>This is re-expressed as <span class="math inline">\(2s + s \cdot p\)</span> with <span class="math inline">\(p\)</span> given by:</p>
<pre class="{julia}"><code>cancel(a_b - 2s/s)</code></pre>
<p>Now, <span class="math inline">\(2s = m - s\cdot m\)</span>, so the above can be reworked to be <span class="math inline">\(\log(1+m) = m - s\cdot(m-p)\)</span>.</p>
<p>(For larger values of <span class="math inline">\(m\)</span>, a similar, but different approximation, can be used to minimize floating point errors.)</p>
<p>How big can the error be between this <em>approximations</em> and <span class="math inline">\(\log(1+m)\)</span>? We plot to see how big <span class="math inline">\(s\)</span> can be:</p>
<pre class="{julia}"><code>@syms v
plot(v/(2+v), sqrt(2)/2 - 1, sqrt(2)-1)</code></pre>
<p>This shows, <span class="math inline">\(s\)</span> is as big as</p>
<pre class="{julia}"><code>Max = (v/(2+v))(v =&gt; sqrt(2) - 1)</code></pre>
<p>The error term is like <span class="math inline">\(2/19 \cdot \xi^{19}\)</span> which is largest at this value of <span class="math inline">\(M\)</span>. Large is relative - it is really small:</p>
<pre class="{julia}"><code>(2/19)*Max^19</code></pre>
<p>Basically that is machine precision. Which means, that as far as can be told on the computer, the value produced by <span class="math inline">\(2s + s \cdot p\)</span> is about as accurate as can be done.</p>
<p>To try this out to compute <span class="math inline">\(\log(5)\)</span>. We have <span class="math inline">\(5 = 2^2(1+0.25)\)</span>, so <span class="math inline">\(k=2\)</span> and <span class="math inline">\(m=0.25\)</span>.</p>
<pre class="{julia}"><code>k, m = 2, 0.25
𝒔 = m / (2+m)
pₗ = 2 * sum(𝒔^(2i)/(2i+1) for i in 1:8)  # where the polynomial approximates the logarithm...

log(1 + m), m - 𝒔*(m-pₗ), log(1 + m) - ( m - 𝒔*(m-pₗ))
</code></pre>
<p>The two values differ by less than <span class="math inline">\(10^{-16}\)</span>, as advertised. Re-assembling then, we compare the computed values:</p>
<pre class="{julia}"><code>Δ = k * log(2) + (m - 𝒔*(m-pₗ)) - log(5)</code></pre>
<p>The actual code is different, as the Taylor polynomial isn’t used. The Taylor polynomial is a great approximation near a point, but there might be better polynomial approximations for all values in an interval. In this case there is, and that polynomial is used in the production setting. This makes things a bit more efficient, but the basic idea remains - for a prescribed accuracy, a polynomial approximation can be found over a given interval, which can be cleverly utilized to solve for all applicable values.</p>
</section>
<section id="example-higher-order-derivatives-of-the-inverse-function" class="level5">
<h5 class="anchored" data-anchor-id="example-higher-order-derivatives-of-the-inverse-function">Example: higher order derivatives of the inverse function</h5>
<p>For notational purposes, let <span class="math inline">\(g(x)\)</span> be the inverse function for <span class="math inline">\(f(x)\)</span>. Assume <em>both</em> functions have a Taylor polynomial expansion:</p>
<p><span class="math display">\[
\begin{align*}
f(x_0 + \Delta_x) &amp;= f(x_0) + a_1 \Delta_x + a_2 (\Delta_x)^2 + \cdots a_n + (\Delta_x)^n + \dots\\
g(y_0 + \Delta_y) &amp;= g(y_0) + b_1 \Delta_y + b_2 (\Delta_y)^2 + \cdots b_n + (\Delta_y)^n + \dots
\end{align*}
\]</span></p>
<p>Then using <span class="math inline">\(x = g(f(x))\)</span>, we have expanding the terms and using <span class="math inline">\(\approx\)</span> to drop the <span class="math inline">\(\dots\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
x_0 + \Delta_x &amp;= g(f(x_0 + \Delta_x)) \\
&amp;\approx g(f(x_0) + \sum_{j=1}^n a_j (\Delta_x)^j) \\
&amp;\approx g(f(x_0)) + \sum_{i=1}^n b_i \left(\sum_{j=1}^n a_j (\Delta_x)^j \right)^i \\
&amp;\approx x_0 + \sum_{i=1}^{n-1} b_i \left(\sum_{j=1}^n a_j (\Delta_x)^j\right)^i + b_n \left(\sum_{j=1}^n a_j (\Delta_x)^j\right)^n
\end{align*}
\]</span></p>
<p>That is:</p>
<p><span class="math display">\[
b_n \left(\sum_{j=1}^n a_j (\Delta_x)^j \right)^n =
(x_0 + \Delta_x) - \left( x_0 + \sum_{i=1}^{n-1} b_i \left(\sum_{j=1}^n a_j (\Delta_x)^j \right)^i \right)
\]</span></p>
<p>Solving for <span class="math inline">\(b_n = g^{(n)}(y_0) / n!\)</span> gives the formal expression:</p>
<p><span class="math display">\[
g^{(n)}(y_0) = n! \cdot \lim_{\Delta_x \rightarrow 0}
\frac{\Delta_x -  \sum_{i=1}^{n-1} b_i \left(\sum_{j=1}^n a_j (\Delta_x)^j \right)^i}{
\left(\sum_{j=1}^n a_j \left(\Delta_x^j\right)^i\right)^n}
\]</span></p>
<p>(This is following <a href="https://vixra.org/pdf/1703.0295v1.pdf">Liptaj</a>).</p>
<p>We will use <code>SymPy</code> to take this limit for the first <code>4</code> derivatives. Here is some code that expands <span class="math inline">\(x + \Delta_x = g(f(x_0 + \Delta_x))\)</span> and then uses <code>SymPy</code> to solve:</p>
<pre class="{julia}"><code>@syms x₀ Δₓ f′[1:4] g′[1:4]

as(i) = f′[i]/factorial(i)
bs(i) = g′[i]/factorial(i)

gᵏs = Any[]
eqns = Any[]
for n ∈ 1:4
    Δy = sum(as(j) * Δₓ^j for j ∈ 1:n)
    left = x₀ + Δₓ
    right = x₀ + sum(bs(i)*Δy^i for i ∈ 1:n)

    eqn = left ~ right
    push!(eqns, eqn)

    gⁿ = g′[n]
    ϕ = solve(eqn, gⁿ)[1]

    # replace g′ᵢs in terms of computed f′ᵢs
    for j ∈ 1:n-1
        ϕ = subs(ϕ, g′[j] =&gt; gᵏs[j])
    end

    L = limit(ϕ, Δₓ =&gt; 0)
    push!(gᵏs, L)

end
gᵏs</code></pre>
<p>We can see the expected <code>g' = 1/f'</code> (where the point of evalution is <span class="math inline">\(g(y) = 1/f'(f^{-1}(y))\)</span> is not written). In addition, we get 3 more formulas, hinting that the answers grow rapidly in terms of their complexity.</p>
<p>In the above, for each <code>n</code>, the code above sets up the two sides, <code>left</code> and <code>right</code>, of an equation involving the higher-order derivatives of <span class="math inline">\(g\)</span>. For example, when <code>n=2</code> we have:</p>
<pre class="{julia}"><code>eqns[2]</code></pre>
<p>The <code>solve</code> function is used to identify <span class="math inline">\(g^{(n)}\)</span> represented in terms of lower-order derivatives of <span class="math inline">\(g\)</span>. These values have been computed and stored and are then substituted into <code>ϕ</code>. Afterwards a limit is taken and the answer recorded.</p>
</section>
</section>
</section>
<section id="questions" class="level2" data-number="35.4">
<h2 data-number="35.4" class="anchored" data-anchor-id="questions"><span class="header-section-number">35.4</span> Questions</h2>
<section id="question" class="level6">
<h6 class="anchored" data-anchor-id="question">Question</h6>
<p>Compute the Taylor polynomial of degree <span class="math inline">\(10\)</span> for <span class="math inline">\(\sin(x)\)</span> about <span class="math inline">\(c=0\)</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``\\sum_{k=0}^{10} x^k``",
"``\\sum_{k=1}^{10} (-1)^{n+1} x^n/n``",
"``\\sum_{k=0}^{4} (-1)^k/(2k+1)! \\cdot x^{2k+1}``",
"``\\sum_{k=0}^{10} x^n/n!``"
]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-1" class="level6">
<h6 class="anchored" data-anchor-id="question-1">Question</h6>
<p>Compute the Taylor polynomial of degree <span class="math inline">\(10\)</span> for <span class="math inline">\(e^x\)</span> about <span class="math inline">\(c=0\)</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``\\sum_{k=0}^{10} x^k``",
"``\\sum_{k=1}^{10} (-1)^{n+1} x^n/n``",
"``\\sum_{k=0}^{4} (-1)^k/(2k+1)! \\cdot x^{2k+1}``",
"``\\sum_{k=0}^{10} x^n/n!``"
]
answ = 4
radioq(choices, answ)</code></pre>
</section>
<section id="question-2" class="level6">
<h6 class="anchored" data-anchor-id="question-2">Question</h6>
<p>Compute the Taylor polynomial of degree <span class="math inline">\(10\)</span> for <span class="math inline">\(1/(1-x)\)</span> about <span class="math inline">\(c=0\)</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``\\sum_{k=0}^{10} x^k``",
"``\\sum_{k=1}^{10} (-1)^{n+1} x^n/n``",
"``\\sum_{k=0}^{4} (-1)^k/(2k+1)! \\cdot x^{2k+1}``",
"``\\sum_{k=0}^{10} x^n/n!``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-3" class="level6">
<h6 class="anchored" data-anchor-id="question-3">Question</h6>
<p>Let <span class="math inline">\(T_5(x)\)</span> be the Taylor polynomial of degree <span class="math inline">\(5\)</span> for the function <span class="math inline">\(\sqrt{1+x}\)</span> about <span class="math inline">\(x=0\)</span>. What is the coefficient of the <span class="math inline">\(x^5\)</span> term?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``7/256``",
"``-5/128``",
"``1/5!``",
"``2/15``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-4" class="level6">
<h6 class="anchored" data-anchor-id="question-4">Question</h6>
<p>The <span class="math inline">\(5\)</span>th order Taylor polynomial for <span class="math inline">\(\sin(x)\)</span> about <span class="math inline">\(c=0\)</span> is: <span class="math inline">\(x - x^3/3! + x^5/5!\)</span>. Use this to find the first <span class="math inline">\(3\)</span> terms of the Taylor polynomial of <span class="math inline">\(\sin(x^2)\)</span> about <span class="math inline">\(c=0\)</span>.</p>
<p>They are:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``x^2 - x^6/3! + x^{10}/5!``",
"``x^2``",
"``x^2 \\cdot (x - x^3/3! + x^5/5!)``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-5" class="level6">
<h6 class="anchored" data-anchor-id="question-5">Question</h6>
<p>A more direct derivation of the form of the Taylor polynomial (here taken about <span class="math inline">\(c=0\)</span>) is to <em>assume</em> a polynomial form that matches <span class="math inline">\(f\)</span>:</p>
<p><span class="math display">\[
f(x) = a + bx + cx^2 + dx^3 + ex^4 + \cdots
\]</span></p>
<p>If this is true, then formally evaluating at <span class="math inline">\(x=0\)</span> gives <span class="math inline">\(f(0) = a\)</span>, so <span class="math inline">\(a\)</span> is determined. Similarly, formally differentiating and evaluating at <span class="math inline">\(0\)</span> gives <span class="math inline">\(f'(0) = b\)</span>. What is the result of formally differentiating <span class="math inline">\(4\)</span> times and evaluating at <span class="math inline">\(0\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["``f''''(0) = e``",
"``f''''(0) = 4 \\cdot 3 \\cdot 2 e = 4! e``",
"``f''''(0) = 0``"]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-6" class="level6">
<h6 class="anchored" data-anchor-id="question-6">Question</h6>
<p>How big an error is there in approximating <span class="math inline">\(e^x\)</span> by its <span class="math inline">\(5\)</span>th degree Taylor polynomial about <span class="math inline">\(c=0\)</span>, <span class="math inline">\(1 + x + x^2/2! + x^3/3! + x^4/4! + x^5/5!\)</span>, over <span class="math inline">\([-1,1]\)</span>?</p>
<p>The error is known to be <span class="math inline">\(( f^{(6)}(\xi)/6!) \cdot x^6\)</span> for some <span class="math inline">\(\xi\)</span> in <span class="math inline">\([-1,1]\)</span>.</p>
<ul>
<li>The <span class="math inline">\(6\)</span>th derivative of <span class="math inline">\(e^x\)</span> is still <span class="math inline">\(e^x\)</span>:</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(true)</code></pre>
<ul>
<li>Which is true about the function <span class="math inline">\(e^x\)</span>:</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices =["It is increasing", "It is decreasing", "It both increases and decreases"]
answ = 1
radioq(choices, answ)</code></pre>
<ul>
<li>The maximum value of <span class="math inline">\(e^x\)</span> over <span class="math inline">\([-1,1]\)</span> occurs at</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices=["A critical point", "An end point"]
answ = 2
radioq(choices, answ)</code></pre>
<ul>
<li>Which theorem tells you that for a <em>continuous</em> function over <em>closed</em> interval, a maximum value will exist?</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"The intermediate value theorem",
"The mean value theorem",
"The extreme value theorem"]
answ = 3
radioq(choices, answ)</code></pre>
<ul>
<li>What is the <em>largest</em> possible value of the error:</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"``1/6!\\cdot e^1 \\cdot 1^6``",
"``1^6 \\cdot 1 \\cdot 1^6``"]
answ = 1
radioq(choices,answ)</code></pre>
</section>
<section id="question-7" class="level6">
<h6 class="anchored" data-anchor-id="question-7">Question</h6>
<p>The error in using <span class="math inline">\(T_k(x)\)</span> to approximate <span class="math inline">\(e^x\)</span> over the interval <span class="math inline">\([-1/2, 1/2]\)</span> is <span class="math inline">\((1/(k+1)!) e^\xi x^{k+1}\)</span>, for some <span class="math inline">\(\xi\)</span> in the interval. This is <em>less</em> than <span class="math inline">\(1/((k+1)!) e^{1/2} (1/2)^{k+1}\)</span>.</p>
<ul>
<li>Why?</li>
</ul>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"The function $e^x$ is increasing, so takes on its largest value at the endpoint and the function $|x^n| \leq |x|^n \leq (1/2)^n$",
L"The function has a critical point at $x=1/2$",
L"The function is monotonic in $k$, so achieves its maximum at $k+1$"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Assuming the above is right, find the smallest value <span class="math inline">\(k\)</span> guaranteeing a error no more than <span class="math inline">\(10^{-16}\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(k) = 1/factorial(k+1) * exp(1/2) * (1/2)^(k+1)
(f(13) &gt; 1e-16 &amp;&amp; f(14) &lt; 1e-16) &amp;&amp; numericq(14)</code></pre>
<ul>
<li>The function <span class="math inline">\(f(x) = (1 - x + x^2) \cdot e^x\)</span> has a Taylor polynomial about <span class="math inline">\(0\)</span> such that all coefficients are rational numbers. Is it true that the numerators are all either <span class="math inline">\(1\)</span> or prime? (From the 2014 <a href="http://kskedlaya.org/putnam-archive/2014.pdf">Putnam</a> exam.)</li>
</ul>
<p>Here is one way to get all the values bigger than 1:</p>
<pre class="{julia}"><code>#| hold: true
ex = (1 - x + x^2)*exp(x)
Tn = series(ex, x, 0, 100).removeO()
ps = sympy.Poly(Tn, x).coeffs()
qs = numer.(ps)
qs[qs .&gt; 1]  |&gt; Tuple # format better for output</code></pre>
<p>Verify by hand that each of the remaining values is a prime number to answer the question (Or you can use <code>sympy.isprime.(qs)</code>).</p>
<p>Are they all prime or <span class="math inline">\(1\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(true)</code></pre>
</section>
</section>
<section id="appendix" class="level2" data-number="35.5">
<h2 data-number="35.5" class="anchored" data-anchor-id="appendix"><span class="header-section-number">35.5</span> Appendix</h2>
<p>We mentioned two facts that could use a proof: the Newton form of the interpolating polynomial and the mean value theorem for divided differences. Our explanation tries to emphasize a parallel with the secant line’s relationship with the tangent line. The standard way to discuss Taylor polynomials is different (also more direct) and so these two proofs are not in most calculus texts.</p>
<p>A <a href="https://www.math.uh.edu/~jingqiu/math4364/interpolation.pdf">proof</a> of the Newton form can be done knowing that the interpolating polynomial is unique and can be expressed either as</p>
<p><span class="math display">\[
g(x)=a_0 + a_1 (x-x_0) + \cdots + a_n (x-x_0)\cdot\cdots\cdot(x-x_{n-1})
\]</span></p>
<p><em>or</em> in this reversed form</p>
<p><span class="math display">\[
h(x)=b_0 + b_1 (x-x_n) + b_2(x-x_n)(x-x_{n-1}) + \cdots + b_n (x-x_n)(x-x_{n-1})\cdot\cdots\cdot(x-x_1).
\]</span></p>
<p>These two polynomials are of degree <span class="math inline">\(n\)</span> or less and have <span class="math inline">\(u(x) = h(x)-g(x)=0\)</span>, by uniqueness. So the coefficients of <span class="math inline">\(u(x)\)</span> are <span class="math inline">\(0\)</span>. We have that the coefficient of <span class="math inline">\(x^n\)</span> must be <span class="math inline">\(a_n-b_n\)</span> so <span class="math inline">\(a_n=b_n\)</span>. Our goal is to express <span class="math inline">\(a_n\)</span> in terms of <span class="math inline">\(a_{n-1}\)</span> and <span class="math inline">\(b_{n-1}\)</span>. Focusing on the <span class="math inline">\(x^{n-1}\)</span> term, we have:</p>
<p><span class="math display">\[
\begin{align*}
b_n(x-x_n)(x-x_{n-1})\cdot\cdots\cdot(x-x_1)
&amp;- a_n\cdot(x-x_0)\cdot\cdots\cdot(x-x_{n-1}) \\
&amp;=
a_n [(x-x_1)\cdot\cdots\cdot(x-x_{n-1})] [(x- x_n)-(x-x_0)] \\
&amp;= -a_n \cdot(x_n - x_0) x^{n-1} + p_{n-2},
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(p_{n-2}\)</span> is a polynomial of at most degree <span class="math inline">\(n-2\)</span>. (The expansion of <span class="math inline">\((x-x_1)\cdot\cdots\cdot(x-x_{n-1}))\)</span> leaves <span class="math inline">\(x^{n-1}\)</span> plus some lower degree polynomial.) Similarly, we have <span class="math inline">\(a_{n-1}(x-x_0)\cdot\cdots\cdot(x-x_{n-2}) = a_{n-1}x^{n-1} + q_{n-2}\)</span> and <span class="math inline">\(b_{n-1}(x-x_n)\cdot\cdots\cdot(x-x_2) = b_{n-1}x^{n-1}+r_{n-2}\)</span>. Combining, we get that the <span class="math inline">\(x^{n-1}\)</span> term of <span class="math inline">\(u(x)\)</span> is</p>
<p><span class="math display">\[
(b_{n-1}-a_{n-1}) - a_n(x_n-x_0) = 0.
\]</span></p>
<p>On rearranging, this yields <span class="math inline">\(a_n = (b_{n-1}-a_{n-1}) / (x_n - x_0)\)</span>. By <em>induction</em> - that <span class="math inline">\(a_i=f[x_0, x_1, \dots, x_i]\)</span> and <span class="math inline">\(b_i = f[x_n, x_{n-1}, \dots, x_{n-i}]\)</span> (which has trivial base case) - this is <span class="math inline">\((f[x_1, \dots, x_n] - f[x_0,\dots x_{n-1}])/(x_n-x_0)\)</span>.</p>
<p>Now, assuming the Newton form is correct, a <a href="http://tinyurl.com/zjogv83">proof</a> of the mean value theorem for divided differences comes down to Rolle’s theorem. Starting from the Newton form of the polynomial and expanding in terms of <span class="math inline">\(1, x, \dots, x^n\)</span> we see that <span class="math inline">\(g(x) = p_{n-1}(x) + f[x_0, x_1, \dots,x_n]\cdot x^n\)</span>, where now <span class="math inline">\(p_{n-1}(x)\)</span> is a polynomial of degree at most <span class="math inline">\(n-1\)</span>. That is, the coefficient of <span class="math inline">\(x^n\)</span> is <span class="math inline">\(f[x_0, x_1, \dots, x_n]\)</span>. Consider the function <span class="math inline">\(h(x)=f(x) - g(x)\)</span>. It has zeros <span class="math inline">\(x_0, x_1, \dots, x_n\)</span>.</p>
<p>By Rolle’s theorem, between any two such zeros <span class="math inline">\(x_i, x_{i+1}\)</span>, <span class="math inline">\(0 \leq i &lt; n\)</span> there must be a zero of the derivative of <span class="math inline">\(h(x)\)</span>, say <span class="math inline">\(\xi^1_i\)</span>. So <span class="math inline">\(h'(x)\)</span> has zeros <span class="math inline">\(\xi^1_0 &lt; \xi^1_1 &lt; \dots &lt; \xi^1_{n-1}\)</span>.</p>
<p>We visualize this with <span class="math inline">\(f(x) = \sin(x)\)</span> and <span class="math inline">\(x_i = i\)</span> for <span class="math inline">\(i=0, 1, 2, 3\)</span>, The <span class="math inline">\(x_i\)</span> values are indicated with circles, the <span class="math inline">\(\xi^1_i\)</span> values indicated with squares:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = sin(x)
xs = 0:3
dd = divided_differences
g(x) = dd(f,0) + dd(f, 0,1)*x + dd(f, 0,1,2)*x*(x-1) + dd(f, 0,1,2,3)*x*(x-1)*(x-2)
h1(x) = f(x) - g(x)
cps = find_zeros(D(h1), -1, 4)
plot(h1, -1/4, 3.25, linewidth=3, legend=false)
scatter!(xs, h1.(xs), markersize=5)
scatter!(cps, h1.(cps), markersize=5, marker=:square)</code></pre>
<p>Again by Rolle’s theorem, between any pair of adjacent zeros <span class="math inline">\(\xi^1_i, \xi^1_{i+1}\)</span> there must be a zero <span class="math inline">\(\xi^2_i\)</span> of <span class="math inline">\(h''(x)\)</span>. So there are <span class="math inline">\(n-1\)</span> zeros of <span class="math inline">\(h''(x)\)</span>. Continuing, we see that there will be <span class="math inline">\(n+1-3\)</span> zeros of <span class="math inline">\(h^{(3)}(x)\)</span>, <span class="math inline">\(n+1-4\)</span> zeros of <span class="math inline">\(h^{4}(x)\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(n+1-(n-1)\)</span> zeros of <span class="math inline">\(h^{n-1}(x)\)</span>, and finally <span class="math inline">\(n+1-n\)</span> (<span class="math inline">\(1\)</span>) zeros of <span class="math inline">\(h^{(n)}(x)\)</span>. Call this last zero <span class="math inline">\(\xi\)</span>. It satisfies <span class="math inline">\(x_0 \leq \xi \leq x_n\)</span>. Further, <span class="math inline">\(0 = h^{(n)}(\xi) = f^{(n)}(\xi) - g^{(n)}(\xi)\)</span>. But <span class="math inline">\(g\)</span> is a degree <span class="math inline">\(n\)</span> polynomial, so the <span class="math inline">\(n\)</span>th derivative is the coefficient of <span class="math inline">\(x^n\)</span> times <span class="math inline">\(n!\)</span>. In this case we have <span class="math inline">\(0 = f^{(n)}(\xi) - f[x_0, \dots, x_n] n!\)</span>. Rearranging yields the result.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../derivatives/related_rates.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../integrals.html" class="pagination-link">
        <span class="nav-page-text">Integrals</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>