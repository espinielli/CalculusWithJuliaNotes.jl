<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 31&nbsp; Derivative-free alternatives to Newton’s method</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../derivatives/lhospitals_rule.html" rel="next">
<link href="../derivatives/newtons_method.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-find_zerof-x0-function" id="toc-the-find_zerof-x0-function" class="nav-link active" data-scroll-target="#the-find_zerof-x0-function"><span class="toc-section-number">31.1</span>  The <code>find_zero(f, x0)</code> function</a></li>
  <li><a href="#the-secant-method" id="toc-the-secant-method" class="nav-link" data-scroll-target="#the-secant-method"><span class="toc-section-number">31.2</span>  The secant method</a>
  <ul class="collapse">
  <li><a href="#steffensens-method" id="toc-steffensens-method" class="nav-link" data-scroll-target="#steffensens-method"><span class="toc-section-number">31.2.1</span>  Steffensen’s method</a></li>
  </ul></li>
  <li><a href="#inverse-quadratic-interpolation" id="toc-inverse-quadratic-interpolation" class="nav-link" data-scroll-target="#inverse-quadratic-interpolation"><span class="toc-section-number">31.3</span>  Inverse quadratic interpolation</a></li>
  <li><a href="#tolerances" id="toc-tolerances" class="nav-link" data-scroll-target="#tolerances"><span class="toc-section-number">31.4</span>  Tolerances</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="toc-section-number">31.5</span>  Questions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/derivatives/more_zeros.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses these add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using Plots
using ImplicitEquations
using Roots
using SymPy</code></pre>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"
using CalculusWithJulia.WeaveSupport
const frontmatter = (
        title = "Derivative-free alternatives to Newton's method",
        description = "Calculus with Julia: Derivative-free alternatives to Newton's method",
        tags = ["CalculusWithJulia", "derivatives", "derivative-free alternatives to newton's method"],
);

nothing</code></pre>
<hr>
<p>Newton’s method is not the only algorithm of its kind for identifying zeros of a function. In this section we discuss some alternatives.</p>
<section id="the-find_zerof-x0-function" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="the-find_zerof-x0-function"><span class="header-section-number">31.1</span> The <code>find_zero(f, x0)</code> function</h2>
<p>The function <code>find_zero</code> from the <code>Roots</code> packages provides several different algorithms for finding a zero of a function, including some a derivative-free algorithms for finding zeros when started with an initial guess. The default method is similar to Newton’s method in that only a good initial guess is needed. However, the algorithm, while possibly slower in terms of function evaluations and steps, is engineered to be a bit more robust to the choice of initial estimate than Newton’s method. (If it finds a bracket, it will use a bisection algorithm which is guaranteed to converge, but can be slower to do so.) Here we see how to call the function:</p>
<pre class="{julia}"><code>f(x) = cos(x) - x
x₀ = 1
find_zero(f, x₀)</code></pre>
<p>Compare to this related call which uses the bisection method:</p>
<pre class="{julia}"><code>find_zero(f, (0, 1))           ## [0,1] must be a bracketing interval</code></pre>
<p>For this example both give the same answer, but the bisection method is a bit less convenient as a bracketing interval must be pre-specified.</p>
</section>
<section id="the-secant-method" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="the-secant-method"><span class="header-section-number">31.2</span> The secant method</h2>
<p>The default <code>find_zero</code> method above uses a secant-like method unless a bracketing method is found. The secant method is historic, dating back over <span class="math inline">\(3000\)</span> years. Here we discuss the secant method in a more general framework.</p>
<p>One way to view Newton’s method is through the inverse of <span class="math inline">\(f\)</span> (assuming it exists): if <span class="math inline">\(f(\alpha) = 0\)</span> then <span class="math inline">\(\alpha = f^{-1}(0)\)</span>.</p>
<p>If <span class="math inline">\(f\)</span> has a simple zero at <span class="math inline">\(\alpha\)</span> and is locally invertible (that is some <span class="math inline">\(f^{-1}\)</span> exists) then the update step for Newton’s method can be identified with:</p>
<ul>
<li>fitting a polynomial to the local inverse function of <span class="math inline">\(f\)</span> going through through the point <span class="math inline">\((f(x_0),x_0)\)</span>,</li>
<li>and matching the slope of <span class="math inline">\(f\)</span> at the same point.</li>
</ul>
<p>That is, we can write <span class="math inline">\(g(y) = h_0 + h_1 (y-f(x_0))\)</span>. Then <span class="math inline">\(g(f(x_0)) = x_0 = h_0\)</span>, so <span class="math inline">\(h_0 = x_0\)</span>. From <span class="math inline">\(g'(f(x_0)) = 1/f'(x_0)\)</span>, we get <span class="math inline">\(h_1 = 1/f'(x_0)\)</span>. That is, <span class="math inline">\(g(y) = x_0 + (y-f(x_0))/f'(x_0)\)</span>. At <span class="math inline">\(y=0,\)</span> we get the update step <span class="math inline">\(x_1 = g(0) = x_0 - f(x_0)/f'(x_0)\)</span>.</p>
<p>A similar viewpoint can be used to create derivative-free methods.</p>
<p>For example, the <a href="https://en.wikipedia.org/wiki/Secant_method">secant method</a> can be seen as the result of fitting a degree-<span class="math inline">\(1\)</span> polynomial approximation for <span class="math inline">\(f^{-1}\)</span> through two points <span class="math inline">\((f(x_0),x_0)\)</span> and <span class="math inline">\((f(x_1), x_1)\)</span>.</p>
<p>Again, expressing this approximation as <span class="math inline">\(g(y) = h_0 + h_1(y-f(x_1))\)</span> leads to <span class="math inline">\(g(f(x_1)) = x_1 = h_0\)</span>. Substituting <span class="math inline">\(f(x_0)\)</span> gives <span class="math inline">\(g(f(x_0)) = x_0 = x_1 + h_1(f(x_0)-f(x_1))\)</span>. Solving for <span class="math inline">\(h_1\)</span> leads to <span class="math inline">\(h_1=(x_1-x_0)/(f(x_1)-f(x_0))\)</span>. Then <span class="math inline">\(x_2 = g(0) = x_1 + (x_1-x_0)/(f(x_1)-f(x_0)) \cdot f(x_1)\)</span>. This is the first step of the secant method:</p>
<p><span class="math display">\[
x_{n+1} = x_n - f(x_n) \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}.
\]</span></p>
<p>That is, where the next step of Newton’s method comes from the intersection of the tangent line at <span class="math inline">\(x_n\)</span> with the <span class="math inline">\(x\)</span>-axis, the next step of the secant method comes from the intersection of the secant line defined by <span class="math inline">\(x_n\)</span> and <span class="math inline">\(x_{n-1}\)</span> with the <span class="math inline">\(x\)</span> axis. That is, the secant method simply replaces <span class="math inline">\(f'(x_n)\)</span> with the slope of the secant line between <span class="math inline">\(x_n\)</span> and <span class="math inline">\(x_{n-1}\)</span>.</p>
<p>We code the update step as <code>λ2</code>:</p>
<pre class="{julia}"><code>λ2(f0,f1,x0,x1) = x1 - f1 * (x1-x0) / (f1-f0)</code></pre>
<p>Then we can run a few steps to identify the zero of sine starting at <span class="math inline">\(3\)</span> and <span class="math inline">\(4\)</span></p>
<pre class="{julia}"><code>#| hold: true
#| term: true
x0,x1 = 4,3
f0,f1 = sin.((x0,x1))
@show x1,f1

x0,x1 = x1, λ2(f0,f1,x0,x1)
f0,f1 = f1, sin(x1)
@show x1,f1

x0,x1 = x1, λ2(f0,f1,x0,x1)
f0,f1 = f1, sin(x1)
@show x1,f1

x0,x1 = x1, λ2(f0,f1,x0,x1)
f0,f1 = f1, sin(x1)
@show x1,f1

x0,x1 = x1, λ2(f0,f1,x0,x1)
f0,f1 = f1, sin(x1)
x1,f1</code></pre>
<p>Like Newton’s method, the secant method coverges quickly for this problem (though its rate is less than the quadratic rate of Newton’s method).</p>
<p>This method is included in <code>Roots</code> as <code>Secant()</code> (or <code>Order1()</code>):</p>
<pre class="{julia}"><code>find_zero(sin, (4,3), Secant())</code></pre>
<p>Though the derivative is related to the slope of the secant line, that is in the limit. The convergence of the secant method is not as fast as Newton’s method, though at each step of the secant method, only one new function evaluation is needed, so it can be more efficient for functions that are expensive to compute or differentiate.</p>
<p>Let <span class="math inline">\(\epsilon_{n+1} = x_{n+1}-\alpha\)</span>, where <span class="math inline">\(\alpha\)</span> is assumed to be the <em>simple</em> zero of <span class="math inline">\(f(x)\)</span> that the secant method converges to. A <a href="https://math.okstate.edu/people/binegar/4513-F98/4513-l08.pdf">calculation</a> shows that</p>
<p><span class="math display">\[
\begin{align*}
\epsilon_{n+1} &amp;\approx \frac{x_n-x_{n-1}}{f(x_n)-f(x_{n-1})} \frac{(1/2)f''(\alpha)(e_n-e_{n-1})}{x_n-x_{n-1}} \epsilon_n \epsilon_{n-1}\\
&amp; \approx \frac{f''(\alpha)}{2f'(\alpha)} \epsilon_n \epsilon_{n-1}\\
&amp;= C  \epsilon_n \epsilon_{n-1}.
\end{align*}
\]</span></p>
<p>The constant <code>C</code> is similar to that for Newton’s method, and reveals potential troubles for the secant method similar to those of Newton’s method: a poor initial guess (the initial error is too big), the second derivative is too large, the first derivative too flat near the answer.</p>
<p>Assuming the error term has the form <span class="math inline">\(\epsilon_{n+1} = A|\epsilon_n|^\phi\)</span> and substituting into the above leads to the equation</p>
<p><span class="math display">\[
\frac{A^{1-1/\phi}}{C} = |\epsilon_n|^{1 - \phi +1/\phi}.
\]</span></p>
<p>The left side being a constant suggests <span class="math inline">\(\phi\)</span> solves: <span class="math inline">\(1 - \phi + 1/\phi = 0\)</span> or <span class="math inline">\(\phi^2 -\phi - 1 = 0\)</span>. The solution is the golden ratio, <span class="math inline">\((1 + \sqrt{5})/2 \approx 1.618\dots\)</span>.</p>
<section id="steffensens-method" class="level3" data-number="31.2.1">
<h3 data-number="31.2.1" class="anchored" data-anchor-id="steffensens-method"><span class="header-section-number">31.2.1</span> Steffensen’s method</h3>
<p>Steffensen’s method is a secant-like method that converges with <span class="math inline">\(|\epsilon_{n+1}| \approx C |\epsilon_n|^2\)</span>. The secant is taken between the points <span class="math inline">\((x_n,f(x_n))\)</span> and <span class="math inline">\((x_n + f(x_n), f(x_n + f(x_n))\)</span>. Like Newton’s method this requires <span class="math inline">\(2\)</span> function evaluations per step. Steffensen’s is implemented through <code>Roots.Steffensen()</code>. Steffensen’s method is more sensitive to the initial guess than other methods, so in practice must be used with care, though it is a starting point for many higher-order derivative-free methods.</p>
</section>
</section>
<section id="inverse-quadratic-interpolation" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="inverse-quadratic-interpolation"><span class="header-section-number">31.3</span> Inverse quadratic interpolation</h2>
<p>Inverse quadratic interpolation fits a quadratic polynomial through three points, not just two like the Secant method. The third being <span class="math inline">\((f(x_2), x_2)\)</span>.</p>
<p>For example, here is the inverse quadratic function, <span class="math inline">\(g(y)\)</span>, going through three points marked with red dots. The blue dot is found from <span class="math inline">\((g(0), 0)\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false

a,b,c = 1,2,3
fa,fb,fc = -1,1/4,1
g(y) = (y-fb)*(y-fa)/(fc-fb)/(fc-fa)*c + (y-fc)*(y-fa)/(fb-fc)/(fb-fa)*b + (y-fc)*(y-fb)/(fa-fc)/(fa-fb)*a
ys = range(-2,2, length=100)
xs = g.(ys)
plot(xs, ys, legend=false)
scatter!([a,b,c],[fa,fb,fc], color=:red, markersize=5)
scatter!([g(0)],[0], color=:blue, markersize=5)
plot!(zero, color=:blue)</code></pre>
<p>Here we use <code>SymPy</code> to identify the degree-<span class="math inline">\(2\)</span> polynomial as a function of <span class="math inline">\(y\)</span>, then evaluate it at <span class="math inline">\(y=0\)</span> to find the next step:</p>
<pre class="{julia}"><code>@syms y hs[0:2] xs[0:2] fs[0:2]
H(y) = sum(hᵢ*(y - fs[end])^i for (hᵢ,i) ∈ zip(hs, 0:2))

eqs = [H(fᵢ) ~ xᵢ for (xᵢ, fᵢ) ∈ zip(xs, fs)]
ϕ = solve(eqs, hs)
hy = subs(H(y), ϕ)</code></pre>
<p>The value of <code>hy</code> at <span class="math inline">\(y=0\)</span> yields the next guess based on the past three, and is given by:</p>
<pre class="{julia}"><code>q⁻¹ = hy(y =&gt; 0)</code></pre>
<p>Though the above can be simplified quite a bit when computed by hand, here we simply make this a function with <code>lambdify</code> which we will use below.</p>
<pre class="{julia}"><code>λ3 = lambdify(q⁻¹) # fs, then xs</code></pre>
<p>(<code>SymPy</code>’s <code>lambdify</code> function, by default, picks the order of its argument lexicographically, in this case they will be the <code>f</code> values then the <code>x</code> values.)</p>
<p>An inverse quadratic step is utilized by Brent’s method, as possible, to yield a rapidly convergent bracketing algorithm implemented as a default zero finder in many software languages. <code>Julia</code>’s <code>Roots</code> package implements the method in <code>Roots.Brent()</code>. An inverse cubic interpolation is utilized by <a href="https://dl.acm.org/doi/10.1145/210089.210111">Alefeld, Potra, and Shi</a> which gives an asymptotically even more rapidly convergent algorithm then Brent’s (implemented in <code>Roots.AlefeldPotraShi()</code> and also <code>Roots.A42()</code>). This is used as a finishing step in many cases by the default hybrid <code>Order0()</code> method of <code>find_zero</code>.</p>
<p>In a bracketing algorithm, the next step should reduce the size of the bracket, so the next iterate should be inside the current bracket. However, quadratic convergence does not guarantee this to happen. As such, sometimes a subsitute method must be chosen.</p>
<p><a href="https://www.google.com/books/edition/Computational_Physics/cC-8BAAAQBAJ?hl=en&amp;gbpv=1&amp;pg=PA95&amp;printsec=frontcover">Chandrapatla’s</a> method, is a bracketing method utilizing an inverse quadratic step as the centerpiece. The key insight is the test to choose between this inverse quadratic step and a bisection step. This is done in the following based on values of <span class="math inline">\(\xi\)</span> and <span class="math inline">\(\Phi\)</span> defined within:</p>
<pre class="{julia}"><code>function chandrapatla(f, u, v, λ; verbose=false)
    a,b = promote(float(u), float(v))
    fa,fb = f(a),f(b)
    @assert fa * fb &lt; 0

    if abs(fa) &lt; abs(fb)
        a,b,fa,fb = b,a,fb,fa
    end

    c, fc = a, fa

    maxsteps = 100
    for ns in 1:maxsteps

        Δ = abs(b-a)
        m, fm = (abs(fa) &lt; abs(fb)) ? (a, fa) : (b, fb)
        ϵ = eps(m)
        if Δ ≤ 2ϵ
          return m
        end
        @show m,fm
        iszero(fm) &amp;&amp; return m

        ξ = (a-b)/(c-b)
        Φ = (fa-fb)/(fc-fb)

        if Φ^2 &lt; ξ &lt; 1 - (1-Φ)^2
            xt = λ(fa,fc,fb, a,c,b) # inverse quadratic
        else
            xt = a + (b-a)/2
        end

        ft = f(xt)

        isnan(ft) &amp;&amp; break

        if sign(fa) == sign(ft)
            c,fc = a,fa
            a,fa = xt,ft
        else
            c,b,a = b,a,xt
            fc,fb,fa = fb,fa,ft
        end

        verbose &amp;&amp; @show ns, a, fa

    end
    error("no convergence: [a,b] = $(sort([a,b]))")
end</code></pre>
<p>Like bisection, this method ensures that <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> is a bracket, but it moves <span class="math inline">\(a\)</span> to the newest estimate, so does not maintain that <span class="math inline">\(a &lt; b\)</span> throughout.</p>
<p>We can see it in action on the sine function. Here we pass in <span class="math inline">\(\lambda\)</span>, but in a real implementation (as in <code>Roots.Chandrapatla()</code>) we would have programmed the algorithm to compute the inverse quadratic value.</p>
<pre class="{julia}"><code>#| term: true
chandrapatla(sin, 3, 4,  λ3, verbose=true)</code></pre>
<p>The condition <code>Φ^2 &lt; ξ &lt; 1 - (1-Φ)^2</code> can be visualized. Assume <code>a,b=0,1</code>, <code>fa,fb=-1/2,1</code>, Then <code>c &lt; a &lt; b</code>, and <code>fc</code> has the same sign as <code>fa</code>, but what values of <code>fc</code> will satisfy the inequality?</p>
<pre class="{julia}"><code>ξ(c,fc) = (a-b)/(c-b)
Φ(c,fc) = (fa-fb)/(fc-fb)
Φl(c,fc) = Φ(c,fc)^2
Φr(c,fc) = 1 - (1-Φ(c,fc))^2
a,b = 0, 1
fa,fb = -1/2, 1
region = Lt(Φl, ξ) &amp; Lt(ξ,Φr)
plot(region, xlims=(-2,a), ylims=(-3,0))</code></pre>
<p>When <code>(c,fc)</code> is in the shaded area, the inverse quadratic step is chosen. We can see that <code>fc &lt; fa</code> is needed.</p>
<p>For these values, this area is within the area where a implicit quadratic step will result in a value between <code>a</code> and <code>b</code>:</p>
<pre class="{julia}"><code>l(c,fc) = λ3(fa,fb,fc,a,b,c)
region₃ = ImplicitEquations.Lt(l,b) &amp; ImplicitEquations.Gt(l,a)
plot(region₃, xlims=(-2,0), ylims=(-3,0))</code></pre>
<p>There are values in the parameter space where this does not occur.</p>
</section>
<section id="tolerances" class="level2" data-number="31.4">
<h2 data-number="31.4" class="anchored" data-anchor-id="tolerances"><span class="header-section-number">31.4</span> Tolerances</h2>
<p>The <code>chandrapatla</code> algorithm typically waits until <code>abs(b-a) &lt;= 2eps(m)</code> (where <span class="math inline">\(m\)</span> is either <span class="math inline">\(b\)</span> or <span class="math inline">\(a\)</span> depending on the size of <span class="math inline">\(f(a)\)</span> and <span class="math inline">\(f(b)\)</span>) is satisfied. Informally this means the algorithm stops when the two bracketing values are no more than a small amount apart. What is a “small amount?”</p>
<p>To understand, we start with the fact that floating point numbers are an approximation to real numbers.</p>
<p>Floating point numbers effectively represent a number in scientific notation in terms of</p>
<ul>
<li>a sign (plus or minus) ,</li>
<li>a <em>mantissa</em> (a number in <span class="math inline">\([1,2)\)</span>, in binary ), and</li>
<li>an exponent (to represent a power of <span class="math inline">\(2\)</span>).</li>
</ul>
<p>The mantissa is of the form <code>1.xxxxx...xxx</code> where there are <span class="math inline">\(m\)</span> different <code>x</code>s each possibly a <code>0</code> or <code>1</code>. The <code>i</code>th <code>x</code> indicates if the term <code>1/2^i</code> should be included in the value. The mantissa is the sum of <code>1</code> plus the indicated values of <code>1/2^i</code> for <code>i</code> in <code>1</code> to <code>m</code>. So the last <code>x</code> represents if <code>1/2^m</code> should be included in the sum. As such, the mantissa represents a discrete set of values, separated by <code>1/2^m</code>, as that is the smallest difference possible.</p>
<p>For example if <code>m=2</code> then the possible value for the mantissa are <code>11 =&gt; 1 + 1/2 + 1/4 = 7/4</code>, <code>10 =&gt; 1 + 1/2 = 6/4</code>, <code>01 =&gt; 1 + 1/4 = 5/4</code>. and <code>00 =&gt; 1 = 4/4</code>, values separated by <code>1/4 = 1/2^m</code>.</p>
<p>For <span class="math inline">\(64\)</span>-bit floating point numbers <code>m=52</code>, so the values in the mantissa differ by <code>1/2^52 = 2.220446049250313e-16</code>. This is the value of <code>eps()</code>.</p>
<p>However, this “gap” between numbers is for values when the exponent is <code>0</code>. That is the numbers in <code>[1,2)</code>. For values in <code>[2,4)</code> the gap is twice, between <code>[1/2,1)</code> the gap is half. That is the gap depends on the size of the number. The gap between <code>x</code> and its next largest floating point number is given by <code>eps(x)</code> and that always satisfies <code>eps(x) &lt;= eps() * abs(x)</code>.</p>
<p>One way to think about this is the difference between <code>x</code> and the next largest floating point values is <em>basically</em> <code>x*(1+eps()) - x</code> or <code>x*eps()</code>.</p>
<p>For the specific example, <code>abs(b-a) &lt;= 2eps(m)</code> means that the gap between <code>a</code> and <code>b</code> is essentially 2 floating point values from the <span class="math inline">\(x\)</span> value with the smallest <span class="math inline">\(f(x)\)</span> value.</p>
<p>For bracketing methods that is about as good as you can get. However, once floating values are understood, the absolute best you can get for a bracketing interval would be</p>
<ul>
<li>along the way, a value <code>f(c)</code> is found which is <em>exactly</em> <code>0.0</code></li>
<li>the endpoints of the bracketing interval are <em>adjacent</em> floating point values, meaning the interval can not be bisected and <code>f</code> changes sign between the two values.</li>
</ul>
<p>There can be problems when the stopping criteria is <code>abs(b-a) &lt;= 2eps(m))</code> and the answer is <code>0.0</code> that require engineering around. For example, the algorithm above for the function <code>f(x) =  -40*x*exp(-x)</code> does not converge when started with <code>[-9,1]</code>, even though <code>0.0</code> is an obvious zero.</p>
<pre class="{julia}"><code>#| hold: true
fu(x) = -40*x*exp(-x)
chandrapatla(fu, -9, 1, λ3)</code></pre>
<p>Here the issue is <code>abs(b-a)</code> is tiny (of the order <code>1e-119</code>) but <code>eps(m)</code> is even smaller.</p>
<p>For non-bracketing methods, like Newton’s method or the secant method, different criteria are useful. There may not be a bracketing interval for <code>f</code> (for example <code>f(x) = (x-1)^2</code>) so the second criteria above might need to be restated in terms of the last two iterates, <span class="math inline">\(x_n\)</span> and <span class="math inline">\(x_{n-1}\)</span>. Calling this difference <span class="math inline">\(\Delta = |x_n - x_{n-1}|\)</span>, we might stop if <span class="math inline">\(\Delta\)</span> is small enough. As there are scenarios where this can happen, but the function is not at a zero, a check on the size of <span class="math inline">\(f\)</span> is needed.</p>
<p>However, there may be no floating point value where <span class="math inline">\(f\)</span> is exactly <code>0.0</code> so checking the size of <code>f(x_n)</code> requires some agreement.</p>
<p>First if <code>f(x_n)</code> is <code>0.0</code> then it makes sense to call <code>x_n</code> an <em>exact zero</em> of <span class="math inline">\(f\)</span>, even though this may hold even if <code>x_n</code>, a floating point value, is not mathematically an <em>exact</em> zero of <span class="math inline">\(f\)</span>. (Consider <code>f(x) = x^2 - 2x + 1</code>. Mathematically, this is identical to <code>g(x) = (x-1)^2</code>, but <code>f(1 + eps())</code> is zero, while <code>g(1+eps())</code> is <code>4.930380657631324e-32</code>.</p>
<p>However, there may never be a value with <code>f(x_n)</code> exactly <code>0.0</code>. (The value of <code>sin(pi)</code> is not zero, for example, as <code>pi</code> is an approximation to <span class="math inline">\(\pi\)</span>, as well the <code>sin</code> of values adjacent to <code>float(pi)</code> do not produce <code>0.0</code> exactly.)</p>
<p>Suppose <code>x_n</code> is the closest floating number to <span class="math inline">\(\alpha\)</span>, the zero. Then the relative rounding error, <span class="math inline">\((\)</span> <code>x_n</code> <span class="math inline">\(- \alpha)/\alpha\)</span>, will be a value <span class="math inline">\((1 + \delta)\)</span> with <span class="math inline">\(\delta\)</span> less than <code>eps()</code>.</p>
<p>How far then can <code>f(x_n)</code> be from <span class="math inline">\(0 = f(\alpha)\)</span>?</p>
<p><span class="math display">\[
f(x_n) = f(x_n - \alpha + \alpha) =  f(\alpha + \alpha \cdot \delta) = f(\alpha \cdot (1 + \delta)),
\]</span></p>
<p>Assuming <span class="math inline">\(f\)</span> has a derivative, the linear approximation gives:</p>
<p><span class="math display">\[
f(x_n) \approx f(\alpha) + f'(\alpha) \cdot (\alpha\delta) = f'(\alpha) \cdot \alpha \delta
\]</span></p>
<p>So we should consider <code>f(x_n)</code> an <em>approximate zero</em> when it is on the scale of <span class="math inline">\(f'(\alpha) \cdot \alpha \delta\)</span>.</p>
<p>That <span class="math inline">\(\alpha\)</span> factor means we consider a <em>relative</em> tolerance for <code>f</code>. Also important – when <code>x_n</code> is close to <code>0</code>, is the need for an <em>absolute</em> tolerance, one not dependent on the size of <code>x</code>. So a good condition to check if <code>f(x_n)</code> is small is</p>
<p><code>abs(f(x_n)) &lt;= abs(x_n) * rtol + atol</code>, or <code>abs(f(x_n)) &lt;= max(abs(x_n) * rtol, atol)</code></p>
<p>where the relative tolerance, <code>rtol</code>, would absorb an estimate for <span class="math inline">\(f'(\alpha)\)</span>.</p>
<p>Now, in Newton’s method the update step is <span class="math inline">\(f(x_n)/f'(x_n)\)</span>. Naturally when <span class="math inline">\(f(x_n)\)</span> is close to <span class="math inline">\(0\)</span>, the update step is small and <span class="math inline">\(\Delta\)</span> will be close to <span class="math inline">\(0\)</span>. <em>However</em>, should <span class="math inline">\(f'(x_n)\)</span> be large, then <span class="math inline">\(\Delta\)</span> can also be small and the algorithm will possibly stop, as <span class="math inline">\(x_{n+1} \approx x_n\)</span> – but not necessarily <span class="math inline">\(x_{n+1} \approx \alpha\)</span>. So termination on <span class="math inline">\(\Delta\)</span> alone can be off. Checking if <span class="math inline">\(f(x_{n+1})\)</span> is an approximate zero is also useful to include in a stopping criteria.</p>
<p>One thing to keep in mind is that the right-hand side of the rule <code>abs(f(x_n)) &lt;= abs(x_n) * rtol + atol</code>, as a function of <code>x_n</code>, goes to <code>Inf</code> as <code>x_n</code> increases. So if <code>f</code> has <code>0</code> as an asymptote (like <code>e^(-x)</code>) for large enough <code>x_n</code>, the rule will be <code>true</code> and <code>x_n</code> could be counted as an approximate zero, despite it not being one.</p>
<p>So a modified criteria for convergence might look like:</p>
<ul>
<li>stop if <span class="math inline">\(\Delta\)</span> is small and <code>f</code> is an approximate zero with some tolerances</li>
<li>stop if <code>f</code> is an approximate zero with some tolerances, but be mindful that this rule can identify mathematically erroneous answers.</li>
</ul>
<p>It is not uncommon to assign <code>rtol</code> to have a value like <code>sqrt(eps())</code> to account for accumulated floating point errors and the factor of <span class="math inline">\(f'(\alpha)\)</span>, though in the <code>Roots</code> package it is set smaller by default.</p>
</section>
<section id="questions" class="level2" data-number="31.5">
<h2 data-number="31.5" class="anchored" data-anchor-id="questions"><span class="header-section-number">31.5</span> Questions</h2>
<section id="question" class="level6">
<h6 class="anchored" data-anchor-id="question">Question</h6>
<p>Let <code>f(x) = tanh(x)</code> (the hyperbolic tangent) and <code>fp(x) = sech(x)^2</code>, its derivative.</p>
<p>Does <em>Newton’s</em> method (using <code>Roots.Newton()</code>) converge starting at <code>1.0</code>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq("yes")</code></pre>
<p>Does <em>Newton’s</em> method (using <code>Roots.Newton()</code>) converge starting at <code>1.3</code>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq("no")</code></pre>
<p>Does the secant method (using <code>Roots.Secant()</code>) converge starting at <code>1.3</code>? (a second starting value will automatically be chosen, if not directly passed in.)</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq("yes")</code></pre>
</section>
<section id="question-1" class="level6">
<h6 class="anchored" data-anchor-id="question-1">Question</h6>
<p>For the function <code>f(x) = x^5 - x - 1</code> both Newton’s method and the secant method will converge to the one root when started from <code>1.0</code>. Using <code>verbose=true</code> as an argument to <code>find_zero</code>, (e.g., <code>find_zero(f, x0, Roots.Secant(), verbose=true)</code>) how many <em>more</em> steps does the secant method need to converge?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(2)</code></pre>
<p>Do the two methods converge to the exact same value?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq("yes")</code></pre>
</section>
<section id="question-2" class="level6">
<h6 class="anchored" data-anchor-id="question-2">Question</h6>
<p>Let <code>f(x) = exp(x) - x^4</code> and <code>x0=8.0</code>. How many steps (iterations) does it take for the secant method to converge using the default tolerances?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(10, 1)</code></pre>
</section>
<section id="question-3" class="level6">
<h6 class="anchored" data-anchor-id="question-3">Question</h6>
<p>Let <code>f(x) = exp(x) - x^4</code> and a starting bracket be <code>x0 = [8.9]</code>. Then calling <code>find_zero(f,x0, verbose=true)</code> will show that 49 steps are needed for exact bisection to converge. What about with the <code>Roots.Brent()</code> algorithm, which uses inverse quadratic steps when it can?</p>
<p>It takes how many steps?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(36, 1)</code></pre>
<p>The <code>Roots.A42()</code> method uses inverse cubic interpolation, as possible, how many steps does this method take to converge?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(3, 1)</code></pre>
<p>The large difference is due to how the tolerances are set within <code>Roots</code>. The `Brent method gets pretty close in a few steps, but takes a much longer time to get close enough for the default tolerances</p>
</section>
<section id="question-4" class="level6">
<h6 class="anchored" data-anchor-id="question-4">Question</h6>
<p>Consider this crazy function defined by:</p>
<pre class="{julia}"><code>#| eval: false
f(x) = cos(100*x)-4*erf(30*x-10)</code></pre>
<p>(The <code>erf</code> function is the (error function](https://en.wikipedia.org/wiki/Error_function) and is in the <code>SpecialFunctions</code> package loaded with <code>CalculusWithJulia</code>.)</p>
<p>Make a plot over the interval <span class="math inline">\([-3,3]\)</span> to see why it is called “crazy”.</p>
<p>Does <code>find_zero</code> find a zero to this function starting from <span class="math inline">\(0\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq("yes")</code></pre>
<p>If so, what is the value?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x) = cos(100*x)-4*erf(30*x-10)
val = find_zero(f, 0)
numericq(val)</code></pre>
<p>If not, what is the reason?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"The zero is a simple zero",
"The zero is not a simple zero",
"The function oscillates too much to rely on the tangent line approximation far from the zero",
"We can find an answer"
]
answ = 4
radioq(choices, answ, keep_order=true)</code></pre>
<p>Does <code>find_zero</code> find a zero to this function starting from <span class="math inline">\(1\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(false)</code></pre>
<p>If so, what is the value?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(-999.999)</code></pre>
<p>If not, what is the reason?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"The zero is a simple zero",
"The zero is not a simple zero",
"The function oscillates too much to rely on the tangent line approximations far from the zero",
"We can find an answer"
]
answ = 3
radioq(choices, answ, keep_order=true)</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../derivatives/newtons_method.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../derivatives/lhospitals_rule.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>