<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 55&nbsp; Scalar functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../differentiable_vector_calculus/scalar_functions_applications.html" rel="next">
<link href="../differentiable_vector_calculus/vector_valued_functions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#visualizing-scalar-functions" id="toc-visualizing-scalar-functions" class="nav-link active" data-scroll-target="#visualizing-scalar-functions"><span class="toc-section-number">55.1</span>  Visualizing scalar functions</a>
  <ul class="collapse">
  <li><a href="#contour-plots-and-heatmaps" id="toc-contour-plots-and-heatmaps" class="nav-link" data-scroll-target="#contour-plots-and-heatmaps"><span class="toc-section-number">55.1.1</span>  Contour plots and heatmaps</a></li>
  </ul></li>
  <li><a href="#limits" id="toc-limits" class="nav-link" data-scroll-target="#limits"><span class="toc-section-number">55.2</span>  Limits</a>
  <ul class="collapse">
  <li><a href="#continuity-of-scalar-functions" id="toc-continuity-of-scalar-functions" class="nav-link" data-scroll-target="#continuity-of-scalar-functions"><span class="toc-section-number">55.2.1</span>  Continuity of scalar functions</a></li>
  </ul></li>
  <li><a href="#partial-derivatives-and-the-gradient" id="toc-partial-derivatives-and-the-gradient" class="nav-link" data-scroll-target="#partial-derivatives-and-the-gradient"><span class="toc-section-number">55.3</span>  Partial derivatives and the gradient</a>
  <ul class="collapse">
  <li><a href="#finding-partial-derivatives-in-julia" id="toc-finding-partial-derivatives-in-julia" class="nav-link" data-scroll-target="#finding-partial-derivatives-in-julia"><span class="toc-section-number">55.3.1</span>  Finding partial derivatives in Julia</a></li>
  <li><a href="#visualizing-the-gradient" id="toc-visualizing-the-gradient" class="nav-link" data-scroll-target="#visualizing-the-gradient"><span class="toc-section-number">55.3.2</span>  Visualizing the gradient</a></li>
  </ul></li>
  <li><a href="#differentiable" id="toc-differentiable" class="nav-link" data-scroll-target="#differentiable"><span class="toc-section-number">55.4</span>  Differentiable</a></li>
  <li><a href="#the-chain-rule-to-evaluate-fcircvecgamma" id="toc-the-chain-rule-to-evaluate-fcircvecgamma" class="nav-link" data-scroll-target="#the-chain-rule-to-evaluate-fcircvecgamma"><span class="toc-section-number">55.5</span>  The chain rule to evaluate <span class="math inline">\(f\circ\vec\gamma\)</span></a></li>
  <li><a href="#directional-derivatives" id="toc-directional-derivatives" class="nav-link" data-scroll-target="#directional-derivatives"><span class="toc-section-number">55.6</span>  Directional Derivatives</a></li>
  <li><a href="#other-types-of-compositions-and-the-chain-rule" id="toc-other-types-of-compositions-and-the-chain-rule" class="nav-link" data-scroll-target="#other-types-of-compositions-and-the-chain-rule"><span class="toc-section-number">55.7</span>  Other types of compositions and the chain rule</a>
  <ul class="collapse">
  <li><a href="#chain-rule-for-a-univariate-function-composed-with-a-scalar-function" id="toc-chain-rule-for-a-univariate-function-composed-with-a-scalar-function" class="nav-link" data-scroll-target="#chain-rule-for-a-univariate-function-composed-with-a-scalar-function"><span class="toc-section-number">55.7.1</span>  Chain rule for a univariate function composed with a scalar function</a></li>
  <li><a href="#chain-rule-for-a-scalar-function-f-composed-with-a-function-g-rm-rightarrow-rn." id="toc-chain-rule-for-a-scalar-function-f-composed-with-a-function-g-rm-rightarrow-rn." class="nav-link" data-scroll-target="#chain-rule-for-a-scalar-function-f-composed-with-a-function-g-rm-rightarrow-rn."><span class="toc-section-number">55.7.2</span>  Chain rule for a scalar function, <span class="math inline">\(f\)</span>, composed with a function <span class="math inline">\(G: R^m \rightarrow R^n\)</span>.</a></li>
  </ul></li>
  <li><a href="#higher-order-partial-derivatives" id="toc-higher-order-partial-derivatives" class="nav-link" data-scroll-target="#higher-order-partial-derivatives"><span class="toc-section-number">55.8</span>  Higher order partial derivatives</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="toc-section-number">55.9</span>  Questions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/differentiable_vector_calculus/scalar_functions.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses these add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using Plots
using ForwardDiff
using SymPy
using Roots
using QuadGK
using JSON</code></pre>
<p>Also, these methods from the <code>Contour</code> package:</p>
<pre class="{julia}"><code>import Contour: contours, levels, level, lines, coordinates</code></pre>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"
using CalculusWithJulia.WeaveSupport
using CSV, DataFrames

const frontmatter = (
        title = "Scalar functions",
        description = "Calculus with Julia: Scalar functions",
        tags = ["CalculusWithJulia", "differentiable_vector_calculus", "scalar functions"],
);

nothing</code></pre>
<hr>
<p>Consider a function <span class="math inline">\(f: R^n \rightarrow R\)</span>. It has multiple arguments for its input (an <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>) and only one, <em>scalar</em>, value for an output. Some simple examples might be:</p>
<p><span class="math display">\[
\begin{align}
f(x,y) &amp;= x^2 + y^2\\
g(x,y) &amp;= x \cdot y\\
h(x,y) &amp;= \sin(x) \cdot \sin(y)
\end{align}
\]</span></p>
<p>For two examples from real life consider the elevation Point Query Service (of the <a href="https://nationalmap.gov/epqs/">USGS</a>) returns the elevation in international feet or meters for a specific latitude/longitude within the United States. The longitude can be associated to an <span class="math inline">\(x\)</span> coordinate, the latitude to a <span class="math inline">\(y\)</span> coordinate, and the elevation a <span class="math inline">\(z\)</span> coordinate, and as long as the region is small enough, the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> coordinates can be thought to lie on a plane. (A flat earth assumption.)</p>
<p>Similarly, a weather map, say of the United States, may show the maximum predicted temperature for a given day. This describes a function that take a position (<span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>) and returns a predicted temperature (<span class="math inline">\(z\)</span>).</p>
<p>Mathematically, we may describe the values <span class="math inline">\((x,y)\)</span> in terms of a point, <span class="math inline">\(P=(x,y)\)</span> or a vector <span class="math inline">\(\vec{v} = \langle x, y \rangle\)</span> using the identification of a point with a vector. As convenient, we may write any of <span class="math inline">\(f(x,y)\)</span>, <span class="math inline">\(f(P)\)</span>, or <span class="math inline">\(f(\vec{v})\)</span> to describe the evaluation of <span class="math inline">\(f\)</span> at the value <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span></p>
<hr>
<p>Returning to the task at hand, in <code>Julia</code>, defining a scalar function is straightforward, the syntax following mathematical notation:</p>
<pre class="{julia}"><code>f(x,y) = x^2 + y^2
g(x,y) = x * y
h(x,y) = sin(x) * sin(y)</code></pre>
<p>To call a scalar function for specific values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is also similar to the mathematical case:</p>
<pre class="{julia}"><code>f(1,2), g(2, 3), h(3,4)</code></pre>
<p>It may be advantageous to have the values as a vector or a point, as in <code>v=[x,y]</code>. Splatting can be used to turn a vector or tuple into two arguments:</p>
<pre class="{julia}"><code>v = [1,2]
f(v...)</code></pre>
<p>Alternatively, the function may be defined using a vector argument:</p>
<pre class="{julia}"><code>f(v) = v[1]^2 + v[2]^2</code></pre>
<p>A style required for other packages within the <code>Julia</code> ecosystem, as there are many advantages to passing containers of values: they can have arbitrary length, they can be modified inside a function, the functions can be more generic, etc.</p>
<p>More verbosely, but avoiding index notation, we can use multiline functions:</p>
<pre class="{julia}"><code>function g(v)
    x, y = v
    x * y
end</code></pre>
<p>Then we have</p>
<pre class="{julia}"><code>f(v), g([2,3])</code></pre>
<hr>
<p>More elegantly, perhaps – and the approach we will use in this section – is to mirror the mathematical notation through multiple dispatch. If we define <code>j</code> for multiple variables, say with:</p>
<pre class="{julia}"><code>j(x,y) = x^2 - 2x*y^2</code></pre>
<p>The we can define an alternative method with just a single variable and use splatting to turn it into multiple variables:</p>
<pre class="{julia}"><code>j(v) = j(v...)</code></pre>
<p>The we can call <code>j</code> with a vector or point:</p>
<pre class="{julia}"><code>j([1,2])</code></pre>
<p>or by passing in the individual components:</p>
<pre class="{julia}"><code>j(1,2)</code></pre>
<hr>
<p>Following a calculus perspective, we take up the question of how to visualize scalar functions within <code>Julia</code>? Further, how to describe the change in the function between nearby values?</p>
<section id="visualizing-scalar-functions" class="level2" data-number="55.1">
<h2 data-number="55.1" class="anchored" data-anchor-id="visualizing-scalar-functions"><span class="header-section-number">55.1</span> Visualizing scalar functions</h2>
<p>Suppose for the moment that <span class="math inline">\(f:R^2 \rightarrow R\)</span>. The equation <span class="math inline">\(z = f(x,y)\)</span> may be visualized by the set of points in <span class="math inline">\(3\)</span>-dimensions <span class="math inline">\(\{(x,y,z): z = f(x,y)\}\)</span>. This will render as a surface, and that surface will pass a “vertical line test”, in that each <span class="math inline">\((x,y)\)</span> value corresponds to at most one <span class="math inline">\(z\)</span> value. We will see alternatives for describing surfaces beyond through a function of the form <span class="math inline">\(z=f(x,y)\)</span>. These are similar to how a curve in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane can be described by a function of the form <span class="math inline">\(y=f(x)\)</span> but also through an equation of the form <span class="math inline">\(F(x,y) = c\)</span> or through a parametric description, such as is used for planar curves. For now though we focus on the case where <span class="math inline">\(z=f(x,y)\)</span>.</p>
<p>In <code>Julia</code>, plotting such a surface requires a generalization to plotting a univariate function where, typically, a grid of evenly spaced values is given between some <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, the corresponding <span class="math inline">\(y\)</span> or <span class="math inline">\(f(x)\)</span> values are found, and then the points are connected in a dot-to-dot manner.</p>
<p>Here, a two-dimensional grid of <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> values needs specifying, and the corresponding <span class="math inline">\(z\)</span> values found. As the grid will be assumed to be regular only the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values need specifying, the set of pairs can be computed. The <span class="math inline">\(z\)</span> values, it will be seen, are easily computed. This cloud of points is plotted and each cell in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane is plotted with a surface giving the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span>-<span class="math inline">\(z\)</span>, <span class="math inline">\(3\)</span>-dimensional, view. One way to plot such a surface is to tessalate the cell and then for each triangle, represent a plane made up of the <span class="math inline">\(3\)</span> boundary points.</p>
<p>Here is an example:</p>
<pre class="{julia}"><code>𝒇(x, y) = x^2 + y^2</code></pre>
<pre class="{julia}"><code>xs = range(-2, 2, length=100)
ys = range(-2, 2, length=100)

surface(xs, ys, 𝒇)</code></pre>
<p>The <code>surface</code> function will generate the surface.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using <code>surface</code> as a function name is equivalent to <code>plot(xs, ys, f, seriestype=:surface)</code>.</p>
</div>
</div>
<p>We can also use <code>surface(xs, ys, zs)</code> where <code>zs</code> is not a vector, but rather a <em>matrix</em> of values corresponding to a grid described by the <code>xs</code> and <code>ys</code>. A matrix is a rectangular collection of values indexed by row and column through indices <code>i</code> and <code>j</code>. Here the values in <code>zs</code> should satisfy: the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column entry should be <span class="math inline">\(z_{ij} = f(x_i, y_j)\)</span> where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i\)</span>th entry from the <code>xs</code> and <span class="math inline">\(y_j\)</span> the <span class="math inline">\(j\)</span>th entry from the <code>ys</code>.</p>
<p>We can generate this using a comprehension:</p>
<pre class="{julia}"><code>#| hold: true
zs = [𝒇(x,y) for y in ys, x in xs]
surface(xs, ys, zs)</code></pre>
<p>If remembering that the <span class="math inline">\(y\)</span> values go first, and then the <span class="math inline">\(x\)</span> values in the above is too hard, then an alternative can be used. Broadcasting <code>f.(xs,ys)</code> may not make sense, were the <code>xs</code> and <code>ys</code> not of commensurate lengths, and when it does, this call pairs off <code>xs</code> and <code>ys</code> values and passes them to <code>f</code>. What is desired here is different, where for each <code>xs</code> value there are pairs for each of the <code>ys</code> values. The syntax <code>xs'</code> can ve viewed as creating a <em>row</em> vector, where <code>xs</code> is a <em>column</em> vector. Broadcasting will create a <em>matrix</em> of values in this case. So the following is identical to the above:</p>
<pre class="{julia}"><code>surface(xs, ys, 𝒇.(xs', ys))</code></pre>
<p>(This is still subtle. The use of the adjoint operation on <code>ys</code> will error if the dimensions are not square, but will produce an incorrect surface if not. It would be best to simply pass the function and let <code>Plots</code> handle this detail which for the alternative <code>Makie</code> is reversed.)</p>
<hr>
<p>An alternate to <code>surface</code> is <code>wireframe</code> – which may not use shading in all backenends. This displays a grid in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane mapped to the surface:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-2,2, length=10) # downsample to see the frame
wireframe(xs, ys, 𝒇)   # gr() or pyplot() wireplots render better than plotly()</code></pre>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example</h5>
<p>The surface <span class="math inline">\(f(x,y) = x^2 - y^2\)</span> has a “saddle,” as this shows:</p>
<pre class="{julia}"><code>#| hold : true
f(x,y) = x^2 - y^2
xs = ys = range(-2, 2, length=100)
surface(xs, ys, f)</code></pre>
</section>
<section id="example-1" class="level5">
<h5 class="anchored" data-anchor-id="example-1">Example</h5>
<p>As mentioned. In plots of univariate functions, a dot-to-dot algorithm is followed. For surfaces, the two dots are replaced by four points, which over determines a plane. Some choice is made to partition that rectangle into two triangles, and for each triangle, the <span class="math inline">\(3\)</span> resulting points determines a plane, which can be suitably rendered.</p>
<p>We can see this in the default <code>gr</code> toolkit by forcing the surface to show just one cell, as the <code>xs</code> and <code>ys</code> below only contain <span class="math inline">\(2\)</span> values:</p>
<pre class="{julia}"><code>#| hold: true
xs = [-1,1]; ys = [-1,1]
f(x,y) = x*y
surface(xs, ys, f)</code></pre>
<p>Compare this, to the same region, but with many cells to represent the surface:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-1, 1, length=100)
f(x,y) = x*y
surface(xs, ys, f)</code></pre>
</section>
<section id="contour-plots-and-heatmaps" class="level3" data-number="55.1.1">
<h3 data-number="55.1.1" class="anchored" data-anchor-id="contour-plots-and-heatmaps"><span class="header-section-number">55.1.1</span> Contour plots and heatmaps</h3>
<pre class="{julia}"><code>#| echo: false
#n,m = 25,50
#xs = range(-74.3129825592041, -74.2722129821777, length=n)
#ys = range(40.7261855236006, 40.7869834960339, length=m)
#d = DataFrame(xs =reshape([m[1] for m in [(xi,yi) for xi in xs, yi in ys]], (n*m),),
#       ys = reshape([m[2] for m in [(xi,yi) for xi in xs, yi in ys]], (n*m,)))
# In RCall
#using RCall
#z = R"""
#library(elevatr)
#z = get_elev_point($d, prj="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")
#z = data.frame(z)
#"""
#elev = rcopy(DataFrame, z).elevation
#zs = reshape(elev, m, n)
#D = Dict(:xs =&gt; xs, :ys=&gt;ys, :zs =&gt; elev)
#io = open("data/somocon.json", "w")
#JSON.print(io, D)
#close(io)
nothing</code></pre>
<p>Consider the example of latitude, longitude, and elevation data describing a surface. The following graph is generated from such data, which was retrieved from the USGS website for a given area. The grid points are chosen about every <span class="math inline">\(150\)</span>m, so this is not too fine grained.</p>
<pre class="{julia}"><code>#| echo: false
somocon = """
{"ys":[40.7261855236006,40.72742629854822,40.728667073495835,40.72990784844345,40.73114862339107,40.73238939833869,40.73363017328631,40.734870948233926,40.736111723181544,40.73735249812916,40.73859327307678,40.7398340480244,40.74107482297202,40.742315597919635,40.74355637286725,40.74479714781487,40.74603792276249,40.74727869771011,40.748519472657726,40.749760247605344,40.75100102255296,40.75224179750058,40.7534825724482,40.75472334739582,40.755964122343435,40.75720489729106,40.75844567223868,40.7596864471863,40.760927222133915,40.762167997081534,40.76340877202915,40.76464954697677,40.76589032192439,40.767131096872006,40.768371871819625,40.76961264676724,40.77085342171486,40.77209419666248,40.7733349716101,40.774575746557716,40.775816521505334,40.77705729645295,40.77829807140057,40.77953884634819,40.78077962129581,40.782020396243425,40.78326117119104,40.78450194613866,40.78574272108628,40.7869834960339],"zs":[56.01,51.48,51.74,44.9,45.6,48.76,51.94,61.55,73.28,66.29,63.29,61.46,58.49,50.06,44.18,41.35,39.9,39.84,36.59,39.0,32.85,30.03,33.51,41.28,48.27,62.42,60.31,47.04,45.5,48.2,53.46,64.52,90.94,99.45,88.22,77.94,74.07,67.39,57.02,48.88,45.05,48.09,43.18,39.9,39.08,40.62,33.1,31.9,36.77,43.92,71.71,69.82,57.64,46.98,60.73,60.83,96.1,142.76,137.34,115.32,94.89,84.02,76.91,67.68,56.16,48.75,51.23,49.58,44.37,39.98,41.33,39.08,33.27,34.35,38.63,74.36,76.11,64.27,50.65,61.01,87.64,127.37,144.27,154.88,154.21,121.78,101.25,89.54,78.44,65.93,57.72,53.51,54.97,50.69,45.22,40.48,37.04,35.56,33.26,36.96,77.43,64.79,71.06,63.36,57.43,106.1,134.93,142.34,148.85,155.99,159.95,124.49,103.86,87.97,76.57,68.22,60.35,57.23,55.58,51.15,42.79,40.6,41.94,34.53,34.96,78.13,73.79,75.67,56.64,60.87,96.08,128.31,138.22,143.42,153.35,161.87,155.41,122.68,104.06,87.5,77.81,68.75,64.85,60.88,59.44,47.98,44.57,45.44,42.71,35.23,77.37,77.0,77.61,59.73,63.84,99.1,113.48,135.22,152.77,151.16,158.9,162.84,153.3,120.58,103.98,87.91,79.23,73.92,67.96,64.94,53.54,44.0,50.07,46.93,43.32,88.65,84.02,80.83,65.49,59.07,77.84,103.68,125.53,147.66,160.47,159.49,164.66,165.91,146.24,118.18,102.01,88.47,80.25,74.83,70.48,62.1,49.47,48.1,53.33,48.34,99.44,88.01,84.27,82.97,60.09,69.83,92.51,113.41,135.15,149.8,164.15,160.75,163.8,167.33,147.47,118.41,101.95,88.65,82.18,78.29,69.59,55.74,49.71,51.8,57.88,102.64,104.12,97.82,74.39,68.53,60.14,77.6,99.22,117.22,130.03,153.71,162.09,161.09,164.47,167.19,139.18,114.62,97.97,87.68,83.73,76.03,60.99,51.93,49.41,59.15,114.76,115.62,99.65,95.47,95.31,70.6,60.14,75.41,100.54,122.61,141.39,157.32,160.93,163.17,167.0,158.25,129.02,112.59,96.6,89.03,80.11,65.83,56.0,49.52,54.51,121.11,111.04,114.21,111.8,105.23,102.43,66.8,74.98,99.48,111.59,126.23,144.81,163.02,164.44,165.56,165.01,157.87,129.18,108.67,96.9,87.28,74.81,60.53,53.12,52.44,123.96,126.43,127.51,124.19,107.58,92.65,67.27,74.09,95.48,102.63,123.05,143.73,153.72,166.16,164.96,166.27,166.6,156.49,122.54,104.98,94.24,81.41,70.53,60.0,55.06,132.49,128.75,142.22,132.8,116.22,95.17,78.05,65.54,73.44,94.77,122.63,150.45,159.95,162.54,164.74,165.55,167.95,167.5,141.39,116.28,102.84,88.36,78.59,68.04,59.33,135.9,129.63,135.65,149.65,131.83,109.12,92.13,67.31,71.28,95.2,105.78,133.74,155.48,169.13,167.16,163.63,164.41,168.11,159.05,128.09,109.31,95.72,85.54,79.65,67.48,139.88,133.57,135.32,141.51,145.89,119.2,96.72,77.69,69.21,80.55,95.18,129.15,144.98,165.06,158.96,167.14,159.53,164.18,156.31,133.83,121.74,108.38,93.46,86.54,79.24,142.73,152.05,156.37,143.59,147.61,126.53,103.08,90.34,92.32,71.97,83.82,113.32,135.91,156.39,150.75,161.93,157.2,155.83,154.93,150.37,140.2,119.8,102.33,94.4,90.57,136.21,140.78,156.4,162.33,152.52,138.31,127.93,95.01,89.0,83.32,74.11,102.61,125.18,134.58,135.15,151.46,152.13,149.58,153.91,156.0,162.27,132.0,115.84,105.2,99.94,133.21,139.49,147.1,157.23,167.48,154.91,135.91,111.99,94.57,90.76,78.29,83.11,102.76,112.19,120.68,136.88,137.72,144.85,153.46,161.94,169.27,165.91,133.39,118.98,107.7,136.68,139.87,152.59,158.63,167.04,165.88,161.25,126.56,102.07,93.71,79.93,81.49,96.21,93.82,101.26,124.57,146.39,150.26,147.96,158.73,168.95,173.35,156.12,130.89,116.13,131.8,135.34,149.18,158.94,158.41,153.19,153.96,152.89,109.61,101.17,103.41,91.12,79.35,83.68,90.6,118.7,139.47,152.39,155.23,154.36,163.94,171.28,171.87,141.11,123.49,128.26,127.93,136.81,138.07,139.58,140.93,137.3,139.21,119.46,103.23,100.02,95.77,81.51,93.65,103.9,120.91,126.51,147.94,160.93,159.58,158.97,170.02,173.4,171.77,133.46,129.34,123.57,125.8,127.17,134.63,140.14,141.37,132.18,121.88,112.02,104.23,98.86,81.28,97.91,96.43,113.3,139.2,143.14,155.76,166.2,158.24,165.4,171.77,172.06,140.75,112.75,119.41,120.86,124.88,134.42,145.88,159.11,160.31,147.24,125.13,112.38,100.79,87.49,88.87,99.02,114.24,130.88,155.17,156.39,166.16,161.29,161.34,161.94,158.02,158.28,106.87,113.99,118.24,122.56,133.41,145.66,155.71,165.71,165.42,155.14,127.78,111.46,91.2,91.16,97.31,106.22,134.23,149.23,164.3,163.19,170.52,162.95,168.76,152.24,161.13,121.83,121.15,119.0,121.56,129.72,140.09,153.12,162.86,168.34,168.92,161.0,128.69,108.79,89.1,87.66,99.02,125.32,149.07,162.35,168.22,170.28,171.39,167.62,172.27,174.12,124.29,121.09,122.74,121.68,128.9,135.39,145.94,155.36,157.98,166.38,171.83,161.26,117.38,101.24,92.25,90.26,111.61,132.57,145.7,165.92,169.35,170.59,169.76,175.52,175.58,127.46,123.56,122.96,122.32,125.0,129.83,139.32,144.75,145.12,151.16,159.37,163.38,125.29,108.04,102.34,100.38,100.38,118.72,144.25,162.56,168.8,175.06,173.27,175.9,176.65,129.23,123.85,124.3,124.41,126.73,127.33,130.66,135.53,143.09,163.18,161.45,160.31,146.71,123.03,104.09,100.38,100.38,104.73,136.26,158.26,162.47,172.58,172.73,171.67,176.73,120.55,127.56,125.67,126.14,127.67,129.82,129.3,132.26,143.3,161.39,171.13,173.89,171.66,131.8,107.61,100.38,100.38,102.62,126.85,144.66,154.41,172.86,175.48,172.4,173.72,116.01,126.43,125.59,126.5,131.19,129.04,134.07,136.27,135.63,142.09,159.11,175.01,179.52,138.05,101.75,102.8,100.38,100.38,112.51,127.4,152.04,170.15,172.66,169.62,171.11,110.18,130.36,129.34,129.04,134.03,141.08,139.77,145.16,147.8,149.31,165.49,172.97,175.88,134.81,108.36,103.24,100.38,100.38,106.34,121.12,144.63,160.44,166.56,164.1,169.59,104.51,119.17,134.58,130.33,134.6,141.51,155.8,151.57,159.5,155.76,158.77,163.45,159.48,143.39,111.96,107.48,100.38,100.38,104.99,113.14,132.14,150.97,163.91,158.67,167.88,96.5,107.46,121.18,145.9,141.42,141.48,145.83,143.74,150.62,145.75,144.48,148.36,146.6,149.51,122.77,111.64,104.44,100.38,102.92,111.09,126.52,143.73,159.52,155.23,163.23,90.59,97.17,112.25,134.94,140.29,135.93,137.72,134.54,137.69,132.11,135.01,141.86,149.14,153.19,150.77,116.52,106.07,101.64,102.67,106.72,122.36,136.38,153.14,160.57,154.01,84.27,91.0,99.89,120.09,123.15,120.86,128.41,127.42,126.42,129.29,143.8,149.59,165.05,163.71,156.91,126.17,110.32,103.98,102.7,105.38,113.28,126.0,141.28,156.94,142.7,79.52,85.85,89.72,96.0,103.94,109.11,113.31,125.44,129.86,134.67,139.17,154.89,169.61,178.97,171.75,153.95,122.39,110.25,101.31,104.01,111.03,119.34,127.07,138.48,150.35,78.71,83.85,92.84,103.12,118.74,123.26,124.38,132.82,135.71,139.43,142.35,153.33,166.66,178.73,179.83,177.3,146.91,115.31,103.65,102.19,108.29,120.87,140.26,153.15,161.64,76.53,81.19,85.54,97.94,114.77,120.33,127.56,136.91,150.14,148.19,151.04,158.93,159.35,167.55,176.78,177.43,168.22,122.85,106.91,103.39,105.17,112.83,127.37,149.56,158.63,76.9,80.11,83.05,89.9,103.9,107.88,113.18,128.27,146.95,157.8,156.48,162.97,152.02,155.46,175.3,175.85,165.8,124.73,118.12,105.54,104.85,113.42,120.65,135.84,155.64,76.36,79.74,86.01,86.54,92.08,95.01,105.42,123.23,141.01,149.2,147.39,149.84,141.68,150.58,164.87,169.4,157.16,159.46,134.27,110.78,103.99,110.46,118.75,135.33,152.69,78.1,78.68,86.48,90.58,93.27,92.16,97.28,110.67,126.28,130.56,128.0,128.45,127.66,137.06,149.28,153.26,160.61,169.86,156.81,123.71,103.82,106.59,113.73,127.34,148.38,82.35,80.09,82.09,88.63,95.05,96.56,97.26,100.99,110.38,113.98,120.77,132.22,134.76,147.55,166.07,170.47,169.35,168.89,155.55,134.24,110.96,104.36,108.32,118.05,136.24,84.15,84.23,82.32,87.76,91.64,93.12,96.96,106.33,111.31,106.79,119.35,132.95,147.96,153.55,165.8,178.43,178.35,170.88,165.74,140.36,119.17,107.65,106.75,113.56,127.58,82.99,85.54,84.77,84.53,90.08,95.19,95.25,105.43,118.46,119.85,116.2,129.13,142.15,149.56,155.14,171.6,179.44,174.73,161.75,142.72,129.9,115.26,107.99,111.72,121.99,83.01,84.0,87.7,86.06,85.61,94.36,100.3,105.68,117.92,125.39,115.72,129.22,138.43,141.11,151.63,160.55,168.46,164.25,159.16,150.23,136.74,122.5,113.66,108.45,114.78,84.11,84.63,86.98,90.22,88.1,91.68,100.12,113.41,115.57,121.86,128.81,118.67,129.66,133.23,141.51,145.97,148.93,150.71,162.12,166.27,141.86,130.13,115.63,109.05,112.53,85.03,84.97,87.49,89.39,93.67,94.55,102.32,113.85,127.45,126.0,130.58,124.19,132.07,132.58,131.1,139.71,148.52,162.21,157.78,164.7,149.31,142.46,128.04,109.0,110.09,85.93,87.73,89.92,90.55,93.51,98.52,103.9,118.72,129.55,133.86,136.06,137.44,136.47,146.6,143.25,136.06,157.12,172.07,169.4,168.79,158.26,144.45,138.0,111.86,109.03,87.34,90.39,91.4,93.1,91.44,93.54,97.58,115.07,124.02,123.47,137.17,141.91,149.48,150.24,151.28,139.57,144.66,162.92,170.62,177.08,172.96,151.89,129.57,120.07,112.54],"xs":[-74.3129825592041,-74.311283826828,-74.3095850944519,-74.3078863620758,-74.3061876296997,-74.30448889732361,-74.30279016494751,-74.3010914325714,-74.2993927001953,-74.2976939678192,-74.2959952354431,-74.294296503067,-74.2925977706909,-74.2908990383148,-74.2892003059387,-74.28750157356261,-74.28580284118651,-74.28410410881041,-74.2824053764343,-74.2807066440582,-74.2790079116821,-74.277309179306,-74.2756104469299,-74.2739117145538,-74.2722129821777]}
"""
lenape_csv = """
"","elevation","elev_units","longitude","latitude"
"1",126.85,"meters",-74.2986363,40.7541939
"2",125.19,"meters",-74.298561,40.754122
"3",123.52,"meters",-74.298505,40.754049
"4",121.92,"meters",-74.298435,40.753972
"5",119.86,"meters",-74.298402,40.753872
"6",119.86,"meters",-74.298416,40.753818
"7",119.86,"meters",-74.298393,40.753805
"8",118.32,"meters",-74.298233,40.753717
"9",118.48,"meters",-74.298113,40.753706
"10",118.48,"meters",-74.298079,40.753714
"11",110.65,"meters",-74.297548,40.753434
"12",108.68,"meters",-74.297364,40.753392
"13",108.68,"meters",-74.2973338,40.7533463
"14",107.67,"meters",-74.2972265,40.7533169
"15",107.54,"meters",-74.297087,40.753356
"16",107.54,"meters",-74.2970438,40.7533584
"17",106.74,"meters",-74.296979,40.753397
"18",107.69,"meters",-74.29689,40.753533
"19",108.01,"meters",-74.296812,40.753661
"20",108.34,"meters",-74.296718,40.753785
"21",108.93,"meters",-74.296627,40.753874
"22",109.26,"meters",-74.296514,40.753973
"23",109.44,"meters",-74.296377,40.754026
"24",107.8,"meters",-74.296184,40.754049
"25",108.14,"meters",-74.29596,40.754119
"26",108.31,"meters",-74.295761,40.754191
"27",107.08,"meters",-74.295542,40.754277
"28",106.54,"meters",-74.295345,40.754276
"29",105.18,"meters",-74.295177,40.754295
"30",104.93,"meters",-74.2951,40.754358
"31",103.79,"meters",-74.294976,40.754381
"32",103.79,"meters",-74.294943,40.754379
"33",103.62,"meters",-74.294873,40.754362
"34",103.46,"meters",-74.294805,40.754359
"35",102.68,"meters",-74.294687,40.754349
"36",102.78,"meters",-74.294537,40.754269
"37",100.91,"meters",-74.294341,40.754248
"38",101.24,"meters",-74.294228,40.754249
"39",101.15,"meters",-74.294146,40.75427
"40",100.73,"meters",-74.294043,40.754277
"41",100.77,"meters",-74.293997,40.75418
"42",97.54,"meters",-74.293672,40.75418
"43",97.58,"meters",-74.293539,40.754324
"44",97.41,"meters",-74.293442,40.754447
"45",97.02,"meters",-74.29342,40.754555
"46",96.78,"meters",-74.293397,40.754677
"47",96.72,"meters",-74.293319,40.754787
"48",96.98,"meters",-74.2933093,40.7549621
"49",97.04,"meters",-74.2931914,40.7550903
"50",95.89,"meters",-74.2931359,40.7552002
"51",95.48,"meters",-74.293124,40.75528
"52",95.43,"meters",-74.293142,40.755375
"53",95.58,"meters",-74.293163,40.7554692
"54",95.58,"meters",-74.2931806,40.7555174
"55",95.31,"meters",-74.2930826,40.7555402
"56",95.45,"meters",-74.2930283,40.7555572
"57",94.19,"meters",-74.2929292,40.7555853
"58",93.57,"meters",-74.2928114,40.7556067
"59",92.9,"meters",-74.2927408,40.7556127
"60",92.9,"meters",-74.2926921,40.7556257
"61",91.46,"meters",-74.2926528,40.7556602
"62",91.46,"meters",-74.2926104,40.7556888
"63",88.42,"meters",-74.2925696,40.7557042
"64",88.42,"meters",-74.2925272,40.7556876
"65",85.62,"meters",-74.2924927,40.7556674
"66",85.32,"meters",-74.2924503,40.755646
"67",85.32,"meters",-74.2924377,40.7556222
"68",85.32,"meters",-74.2924377,40.7555877
"69",84.49,"meters",-74.2924346,40.7555365
"70",84.49,"meters",-74.2924236,40.755502
"71",84.36,"meters",-74.2923562,40.7554961
"""
nothing</code></pre>
<pre class="{julia}"><code>SC = JSON.parse(somocon)  # defined in a hidden cell
xsₛ, ysₛ, zsₛ =  [float.(SC[i]) for i in ("xs", "ys","zs")]
zzsₛ = reshape(zsₛ, (length(xsₛ), length(ysₛ)))' # reshape to matrix
surface(xsₛ, ysₛ, zzsₛ)</code></pre>
<p>This shows a bit of the topography. If we look at the region from directly above, the graph looks different:</p>
<pre class="{julia}"><code>surface(xsₛ, ysₛ, zzsₛ, camera=(0, 90))</code></pre>
<p>The rendering uses different colors to indicate height. A more typical graph, that is somewhat similar to the top down view, is a <em>contour</em> map.</p>
<p>For a scalar function, Define a <em>level curve</em> as the solutions to the equations <span class="math inline">\(f(x,y) = c\)</span> for a given <span class="math inline">\(c\)</span>. (Or more generally <span class="math inline">\(f(\vec{x}) = c\)</span> for a vector if dimension <span class="math inline">\(2\)</span> or more.) Plotting a selection of level curves yields a <em>contour</em> graph. These are produced with <code>contour</code> and called as above. For example, we have:</p>
<pre class="{julia}"><code>contour(xsₛ, ysₛ, zzsₛ)</code></pre>
<p>Were one to walk along one of the contour lines, then there would be no change in elevation. The areas of greatest change in elevation - basically the hills - occur where the different contour lines are closest. In this particular area, there is a river that runs from the upper right through to the lower left and this is flanked by hills.</p>
<p>The <span class="math inline">\(c\)</span> values for the levels drawn may be specified through the <code>levels</code> argument:</p>
<pre class="{julia}"><code>contour(xsₛ, ysₛ, zzsₛ, levels=[50,75,100, 125, 150, 175])</code></pre>
<p>That shows the <span class="math inline">\(50\)</span>m, <span class="math inline">\(75\)</span>m, … contours.</p>
<p>If a fixed number of evenly spaced levels is desirable, then the <code>nlevels</code> argument is available.</p>
<pre class="{julia}"><code>contour(xsₛ, ysₛ, zzsₛ, nlevels = 5)</code></pre>
<p>If a function describes the surface, then the function may be passed as the third value:</p>
<pre class="{julia}"><code>#| hold: true
f(x, y) = sin(x) - cos(y)
xs = range(0, 2pi, length=100)
ys = range(-pi, pi, length = 100)
contour(xs, ys, f)</code></pre>
<section id="example-2" class="level5">
<h5 class="anchored" data-anchor-id="example-2">Example</h5>
<p>An informative graphic mixes both a surface plot with a contour plot. The <code>PyPlot</code> package can be used to generate one, but such graphs are not readily made within the <code>Plots</code> framework. Here is a workaround, where the contours are generated through the <code>Contours</code> package. At the beginning of this section several of its methods are imported.</p>
<p>This example shows how to add a contour at a fixed level (<span class="math inline">\(0\)</span> below). As no hidden line algorithm is used to hide the contour line if the surface were to cover it, a transparency is specified through <code>alpha=0.5</code>:</p>
<pre class="{julia}"><code>#| hold: true

function surface_contour(xs, ys, f; offset=0)
  p = surface(xs, ys, f, legend=false, fillalpha=0.5)

  ## we add to the graphic p, then plot
  zs = [f(x,y) for x in xs, y in ys]  # reverse order for use with Contour package
  for cl in levels(contours(xs, ys, zs))
    lvl = level(cl) # the z-value of this contour level
    for line in lines(cl)
        _xs, _ys = coordinates(line) # coordinates of this line segment
        _zs = offset .+ (0 .* _xs)
        plot!(p, _xs, _ys, _zs, alpha=0.5)        # add curve on x-y plane
    end
  end
  p
end

xs = ys = range(-pi, stop=pi, length=100)
f(x,y) = 2 + sin(x) - cos(y)

surface_contour(xs, ys, f)</code></pre>
<p>We can see that at the minimum of the surface, the contour lines are nested closed loops with decreasing area.</p>
</section>
<section id="example-3" class="level5">
<h5 class="anchored" data-anchor-id="example-3">Example</h5>
<p>The figure shows a weather map from <span class="math inline">\(1943\)</span> with contour lines based on atmospheric pressure. These are also know as <em>isolines</em>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
imgfile = "figures/daily-map.jpg"
caption = """
Image from [weather.gov](https://www.weather.gov/unr/1943-01-22) of a contour map showing atmospheric pressures from January 22, 1943 in Rapid City, South Dakota.
"""
ImageFile(:differentiable_vector_calculus, imgfile, caption)</code></pre>
<p>This day is highlighted as “The most notable temperature fluctuations occurred on January 22, 1943 when temperatures rose and fell almost 50 degrees in a few minutes. This phenomenon was caused when a frontal boundary separating extremely cold Arctic air from warmer Pacific air rolled like an ocean tide along the northern and eastern slopes of the Black Hills.”</p>
<p>This frontal boundary is marked with triangles and half circles along the thicker black line. The tight spacing of the contour lines above that marked line show a big change in pressure in a short distance.</p>
</section>
<section id="example-4" class="level5">
<h5 class="anchored" data-anchor-id="example-4">Example</h5>
<p>Sea surface temperature varies with latitude and other factors, such as water depth. The following figure shows average temperatures for January 1982 around Australia. The filled contours allow for an easier identification of the ranges represented.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
imgfile = "figures/australia.png"
caption = """
Image from [IRI](https://iridl.ldeo.columbia.edu/maproom/Global/Ocean_Temp/Monthly_Temp.html) shows mean sea surface temperature near Australia in January 1982. IRI has zoomable graphs for this measurement from 1981 to the present. The contour lines are in 2 degree Celsius increments.
"""
ImageFile(:differentiable_vector_calculus, imgfile, caption)</code></pre>
</section>
<section id="example-5" class="level5">
<h5 class="anchored" data-anchor-id="example-5">Example</h5>
<p>The filled contour and the heatmap are related figures to a simple contour graph. The heatmap uses a color gradient to indicate the value at <span class="math inline">\((x,y)\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = exp(-(x^2 + y^2)/5) * sin(x) * cos(y)
xs= ys = range(-pi, pi, length=100)
heatmap(xs, ys, f)</code></pre>
<p>The filled contour layers on the contour lines to a heatmap:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = exp(-(x^2 + y^2)/5) * sin(x) * cos(y)
xs= ys = range(-pi, pi, length=100)
contourf(xs, ys, f)</code></pre>
<p>This function has a prominent peak and a prominent valley, around the middle of the viewing window. The nested contour lines indicate this, and the color key can be used to identify which is the peak and which the valley.</p>
</section>
</section>
</section>
<section id="limits" class="level2" data-number="55.2">
<h2 data-number="55.2" class="anchored" data-anchor-id="limits"><span class="header-section-number">55.2</span> Limits</h2>
<p>The notion of a limit for a univariate function: as <span class="math inline">\(x\)</span> gets close to <span class="math inline">\(c\)</span> then <span class="math inline">\(f(x)\)</span> gets close to <span class="math inline">\(L\)</span>, needs some modification:</p>
<blockquote class="blockquote">
<p>Let <span class="math inline">\(f: R^n \rightarrow R\)</span> and <span class="math inline">\(C\)</span> be a point in <span class="math inline">\(R^n\)</span>. Then <span class="math inline">\(\lim_{P \rightarrow C}f(P) = L\)</span> if for every <span class="math inline">\(\epsilon &gt; 0\)</span> there exists a <span class="math inline">\(\delta &gt; 0\)</span> such that <span class="math inline">\(|f(P) - L| &lt; \epsilon\)</span> whenever <span class="math inline">\(0 &lt; \| P - C \| &lt; \delta\)</span>.</p>
</blockquote>
<p>(If <span class="math inline">\(P=(x_1, x_2, \dots, x_n)\)</span> we use <span class="math inline">\(f(P) = f(x_1, x_2, \dots, x_n)\)</span>.)</p>
<p>This says, informally, for any scale about <span class="math inline">\(L\)</span> there is a “ball” about <span class="math inline">\(C\)</span> (not including <span class="math inline">\(C\)</span>) for which the images of <span class="math inline">\(f\)</span> always sit in the ball. Formally we define a ball of radius <span class="math inline">\(r\)</span> about a point <span class="math inline">\(C\)</span> to be all points <span class="math inline">\(P\)</span> with distance between <span class="math inline">\(P\)</span> and <span class="math inline">\(C\)</span> less than <span class="math inline">\(r\)</span>. A ball is an <em>open</em> set. An <a href="https://en.wikipedia.org/wiki/Open_set#Euclidean_space">open</a> is a set <span class="math inline">\(U\)</span> such that for any <span class="math inline">\(x\)</span> in <span class="math inline">\(U\)</span>, there is a radius <span class="math inline">\(r\)</span> such that the ball of radius <span class="math inline">\(r\)</span> about <span class="math inline">\(x\)</span> is <em>still</em> within <span class="math inline">\(U\)</span>. An open set generalizes an open interval. A <em>closed</em> set generalizes a <em>closed</em> interval. These are <a href="https://en.wikipedia.org/wiki/Closed_set">defined</a> by a set that contains its boundary. Boundary points are any points that can be approached in the limit by points within the set.</p>
<p>In the univariate case, it can be useful to characterize a limit at <span class="math inline">\(x=c\)</span> existing if <em>both</em> the left and right limits exist and the two are equal. Generalizing to getting close in <span class="math inline">\(R^m\)</span> leads to the intuitive idea of a limit existing in terms of any continuous “path” that approaches <span class="math inline">\(C\)</span> in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane has a limit and all are equal. Let <span class="math inline">\(\gamma\)</span> describe the path, and <span class="math inline">\(\lim_{s \rightarrow t}\gamma(s) = C\)</span>. Then <span class="math inline">\(f \circ \gamma\)</span> will be a univariate function. If there is a limit, <span class="math inline">\(L\)</span>, then this composition will also have the same limit as <span class="math inline">\(s \rightarrow t\)</span>. Conversely, if for <em>every</em> path this composition has the <em>same</em> limit, then <span class="math inline">\(f\)</span> will have a limit.</p>
<p>The “two path corollary” is a trick to show a limit does not exist - just find two paths where there is a limit, but they differ, then a limit does not exist in general.</p>
<section id="continuity-of-scalar-functions" class="level3" data-number="55.2.1">
<h3 data-number="55.2.1" class="anchored" data-anchor-id="continuity-of-scalar-functions"><span class="header-section-number">55.2.1</span> Continuity of scalar functions</h3>
<p>Continuity is defined in a familiar manner: <span class="math inline">\(f(P)\)</span> is continuous at <span class="math inline">\(C\)</span> if <span class="math inline">\(\lim_{P \rightarrow C} f(P) = f(C)\)</span>, where we interpret <span class="math inline">\(P \rightarrow C\)</span> in the sense of a ball about <span class="math inline">\(C\)</span>.</p>
<p>As with univariate functions continuity will be preserved under function addition, subtraction, multiplication, and division (provided there is no dividing by <span class="math inline">\(0\)</span>). With this, all these functions are continuous everywhere and so have limits everywhere:</p>
<p><span class="math display">\[
f(x,y) = \sin(x + y), \quad
g(x,y,z) = x^2 + y^2 + z^2, \quad
h(w, x,y,z) = \sqrt{w^2 + x^2 + y^2 + z^2}.
\]</span></p>
<p>Not all functions will have a limit though. Consider <span class="math inline">\(f(x,y) = 2x^2/(x^2+y^2)\)</span> and <span class="math inline">\(C=(0,0)\)</span>. It is not defined at <span class="math inline">\(C\)</span> (dividing by <span class="math inline">\(0\)</span>), but may have a limit at <span class="math inline">\(C\)</span>. Consider the path <span class="math inline">\(x=0\)</span> (the <span class="math inline">\(y\)</span>-axis) parameterized by <span class="math inline">\(\vec\gamma(t) = \langle 0, t\rangle\)</span>. Along this path <span class="math inline">\((f\circ \vec\gamma)(t) = 0/t^2 = 0\)</span> so will have a limit of <span class="math inline">\(0\)</span>. If the limit of <span class="math inline">\(f\)</span> exists it must be <span class="math inline">\(0\)</span>. But, along the line <span class="math inline">\(y=0\)</span> (the <span class="math inline">\(x\)</span> axis) parameterized by <span class="math inline">\(\vec{\gamma}(t) = \langle t, 0 \rangle\)</span>, the function simplifies to <span class="math inline">\((f\circ\vec\gamma)(t)=2\)</span>, so would have a limit of <span class="math inline">\(2\)</span>. As the limit along different paths is different, this function has no limit in general.</p>
<section id="example-6" class="level5">
<h5 class="anchored" data-anchor-id="example-6">Example</h5>
<p>If is not enough that a limit exist along many paths to say a limit exists in general. It must be all paths and be equal. An example might be this function:</p>
<p><span class="math display">\[
f(x,y) =
\begin{cases}
(x + y)/(x-y) &amp; x \neq y,\\
0 &amp; x = y
\end{cases}
\]</span></p>
<p>At <span class="math inline">\(\vec{0}\)</span> this will not have a limit. However, along any line <span class="math inline">\(y=mx\)</span> we have a limit. If <span class="math inline">\(m=1\)</span> the function is constantly <span class="math inline">\(0\)</span>, and so has the limit. If <span class="math inline">\(m \neq 1\)</span>, then we get <span class="math inline">\(f(x, y) = f(x, mx) = (1 + m)/(1-m)\)</span>, a constant So for each <span class="math inline">\(m\)</span> there is a different limit. Consequently, the scalar function does not have a limit.</p>
</section>
</section>
</section>
<section id="partial-derivatives-and-the-gradient" class="level2" data-number="55.3">
<h2 data-number="55.3" class="anchored" data-anchor-id="partial-derivatives-and-the-gradient"><span class="header-section-number">55.3</span> Partial derivatives and the gradient</h2>
<p>Discussing the behaviour of a scalar function along a path is described mathematically through composition. If <span class="math inline">\(\vec\gamma(t)\)</span> is a path in <span class="math inline">\(R^n\)</span>, then the composition <span class="math inline">\(f \circ \vec\gamma\)</span> will be a univariate function. When <span class="math inline">\(n=2\)</span>, we can visualize this composition directly, or as a <span class="math inline">\(3\)</span>-D path on the surface given by <span class="math inline">\(\vec{r}(t) = \langle \gamma_1(t), \gamma_2(t), \dots, \gamma_n(t), (f \circ \vec\gamma)(t) \rangle\)</span>.</p>
<pre class="{julia}"><code>f₁(x,y) = 2 - x^2 - 3y^2
f₁(x) = f₁(x...)
γ₁(t) = 2 * [t, -t^2]   # use \gamma[tab]
x₁s = y₁s = range(-1, 1, length=100)
surface(x₁s, y₁s, f₁)
r3₁(t) = [γ₁(t)..., f₁(γ₁(t))]  # to plot the path on the surface
plot_parametric!(0..1/2, r3₁, linewidth=5, color=:black)

r2₁(t) = [γ₁(t)..., 0]
plot_parametric!(0..1/2, r2₁, linewidth=5, color=:black) # in the $x$-$y$ plane</code></pre>
<p>The vector valued function <code>r3(t) = [γ(t)..., f(γ(t))]</code> takes the <span class="math inline">\(2\)</span>-dimensional path specified by <span class="math inline">\(\vec\gamma(t)\)</span> and adds a third, <span class="math inline">\(x\)</span>, direction by composing the position with <code>f</code>. In this way, a <span class="math inline">\(2\)</span>-D path is visualized with a <span class="math inline">\(3\)</span>-D path. This viewpoint can be reversed, as desired.</p>
<p>However, the composition, <span class="math inline">\(f\circ\vec\gamma\)</span>, is a univariate function, so this can also be visualized by</p>
<pre class="{julia}"><code>plot(f₁ ∘ γ₁, 0, 1/2)</code></pre>
<p>With this graph, we might be led to ask about derivatives or rates of change. For this example, we can algebraically compute the composition:</p>
<p><span class="math display">\[
(f \circ \vec\gamma)(t) = 2 - (2t) - 3(-2t^2)^2 = 2 - 2t +12t^4
\]</span></p>
<p>From here we clearly have <span class="math inline">\(f'(t) = -2 + 48t^3\)</span>. But could this be computed in terms of a “derivative” of <span class="math inline">\(f\)</span> and the derivative of <span class="math inline">\(\vec\gamma\)</span>?</p>
<p>Before answering this, we discuss <em>directional</em> derivatives along the simplified paths <span class="math inline">\(\vec\gamma_x(t) = \langle t, c\rangle\)</span> or <span class="math inline">\(\vec\gamma_y(t) = \langle c, t\rangle\)</span>.</p>
<p>If we compose <span class="math inline">\(f \circ \vec\gamma_x\)</span>, we can visualize this as a curve on the surface from <span class="math inline">\(f\)</span> that moves in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane along the line <span class="math inline">\(y=c\)</span>. The derivative of this curve will satisfy:</p>
<p><span class="math display">\[
\begin{align}
(f \circ \vec\gamma_x)'(x) &amp;=
\lim_{t \rightarrow x} \frac{(f\circ\vec\gamma_x)(t) - (f\circ\vec\gamma_x)(x)}{t-x}\\
&amp;= \lim_{t\rightarrow x} \frac{f(t, c) - f(x,c)}{t-x}\\
&amp;= \lim_{h \rightarrow 0} \frac{f(x+h, c) - f(x, c)}{h}.
\end{align}
\]</span></p>
<p>The latter expresses this to be the derivative of the function that holds the <span class="math inline">\(y\)</span> value fixed, but lets the <span class="math inline">\(x\)</span> value vary. It is the rate of change in the <span class="math inline">\(x\)</span> direction. There is special notation for this:</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial f(x,y)}{\partial x} &amp;=
\lim_{h \rightarrow 0} \frac{f(x+h, y) - f(x, y)}{h},\quad\text{and analogously}\\
\frac{\partial f(x,y)}{\partial y} &amp;=
\lim_{h \rightarrow 0} \frac{f(x, y+h) - f(x, y)}{h}.
\end{align}
\]</span></p>
<p>These are called the <em>partial</em> derivatives of <span class="math inline">\(f\)</span>. The symbol <span class="math inline">\(\partial\)</span>, read as “partial”, is reminiscent of “<span class="math inline">\(d\)</span>”, but indicates the derivative is only in a given direction. Other notations exist for this:</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x}, \quad f_x, \quad \partial_x f,
\]</span></p>
<p>and more generally, when <span class="math inline">\(n\)</span> may be <span class="math inline">\(2\)</span> or more,</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x_i}, \quad f_{x_i}, \quad f_i, \quad \partial_{x_i} f, \quad \partial_i f.
\]</span></p>
<p>The <em>gradient</em> of a scalar function <span class="math inline">\(f\)</span> is the vector comprised of the partial derivatives:</p>
<p><span class="math display">\[
\nabla f(x_1, x_2, \dots, x_n) = \langle
\frac{\partial f}{\partial x_1},
\frac{\partial f}{\partial x_2}, \dots,
\frac{\partial f}{\partial x_n} \rangle.
\]</span></p>
<p>As seen, the gradient is a vector-valued function, but has, also, multivariable inputs. It is a function from <span class="math inline">\(R^n \rightarrow R^n\)</span>.</p>
<section id="example-7" class="level5">
<h5 class="anchored" data-anchor-id="example-7">Example</h5>
<p>Let <span class="math inline">\(f(x,y) = x^2 - 2xy\)</span>, then to compute the partials, we just treat the other variables like a constant. (This is consistent with the view that the partial derivative is just a regular derivative along a line where all other variables are constant.)</p>
<p>Then</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial (x^2 - 2xy)}{\partial x} &amp;= 2x - 2y\\
\frac{\partial (x^2 - 2xy)}{\partial y} &amp;= 0 - 2x = -2x.
\end{align}
\]</span></p>
<p>Combining, gives <span class="math inline">\(\nabla{f} = \langle 2x -2y, -2x \rangle\)</span>.</p>
<p>If <span class="math inline">\(g(x,y,z) = \sin(x) + z\cos(y)\)</span>, then</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial g }{\partial x} &amp;= \cos(x) + 0 = \cos(x),\\
\frac{\partial g }{\partial y} &amp;= 0 + z(-\sin(y)) = -z\sin(y),\\
\frac{\partial g }{\partial z} &amp;= 0 + \cos(y) = \cos(y).
\end{align}
\]</span></p>
<p>Combining, gives <span class="math inline">\(\nabla{g} = \langle \cos(x), -z\sin(y), \cos(y) \rangle\)</span>.</p>
</section>
<section id="finding-partial-derivatives-in-julia" class="level3" data-number="55.3.1">
<h3 data-number="55.3.1" class="anchored" data-anchor-id="finding-partial-derivatives-in-julia"><span class="header-section-number">55.3.1</span> Finding partial derivatives in Julia</h3>
<p>Two different methods are described, one for working with functions, the other symbolic expressions. This mirrors our treatment for vector-valued functions, where <code>ForwardDiff.derivative</code> was used for functions, and <code>SymPy</code>’s <code>diff</code> function for symbolic expressions.</p>
<p>Suppose, we consider <span class="math inline">\(f(x,y) = x^2 - 2xy\)</span>. We may define it with <code>Julia</code> through:</p>
<pre class="{julia}"><code>f₂(x,y) = x^2 - 2x*y
f₂(v) = f₂(v...)       # to handle vectors. Need not be defined each time</code></pre>
<p>The numeric gradient at a point, can be found from the function <code>ForwardDiff.gradient</code> through:</p>
<pre class="{julia}"><code>pt₂ = [1, 2]
ForwardDiff.gradient(f₂, pt₂)      # uses the f(v) call above</code></pre>
<p>This, of course matches the computation above, where <span class="math inline">\(\nabla f = \langle (2x -2y, -2x)\)</span>, so at <span class="math inline">\((1,2)\)</span> is <span class="math inline">\((-2, 2)\)</span>, as a point in <span class="math inline">\(R^2\)</span>.</p>
<p>The <code>ForwardDiff.gradient</code> function expects a function that accepts a vector of values, so the method for <code>f(v)</code> is needed for the computation.</p>
<p>To go from a function that takes a point to a function of that point, we have the following definition. This takes advantage of <code>Julia</code>’s multiple dispatch to add a new method for the <code>gradient</code> generic. This is done in the <code>CalculusWithJulia</code> package along the lines of:</p>
<pre class="{julia}"><code>#| eval: false
FowardDiff.gradient(f::Function) = x -&gt; ForwardDiff.gradient(f, x)</code></pre>
<p>It works as follows, where a vector of values is passed in for the point in question:</p>
<pre class="{julia}"><code>gradient(f₂)([1,2]), gradient(f₂)([3,4])</code></pre>
<p>This expects a point or vector for its argument, and not the expanded values. Were that desired, something like this would work:</p>
<pre class="{julia}"><code>#| eval: false
ForwardDiff.gradient(f::Function) = (x, xs...) -&gt; ForwardDiff.gradient(f, vcat(x, xs...))</code></pre>
<pre class="{julia}"><code>gradient(f₂)([1,2]), gradient(f₂)(3,4)</code></pre>
<p>From the gradient, finding the partial derivatives involves extraction of the corresponding component.</p>
<p>For example, were it desirable, this function could be used to find the partial in <span class="math inline">\(x\)</span> for some constant <span class="math inline">\(y\)</span>:</p>
<pre class="{julia}"><code>partial_x(f, y) = x -&gt; ForwardDiff.gradient(f,[x,y])[1]   # first component of gradient</code></pre>
<p>Another alternative would be to hold one variable constant, and use the <code>derivative</code> function, as in:</p>
<pre class="{julia}"><code>#| hold: true
partial_x(f, y) = x -&gt; ForwardDiff.derivative(u -&gt; f(u,y), x)</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For vector-valued functions, we can overide the syntax <code>'</code> using <code>Base.adjoint</code>, as <code>'</code> is treated as a postfix operator in <code>Julia</code> for the <code>adjoint</code> operation. The symbol <code>\\nabla</code> is also available in <code>Julia</code>, but it is not an operator, so can’t be used as mathematically written <code>∇f</code> (this could be used as a name though). In <code>CalculusWithJulia</code> a definition is made so essentially <code>∇(f) = x -&gt; ForwardDiff.gradient(f, x)</code>. It does require parentheses to be called, as in <code>∇(f)</code>.</p>
</div>
</div>
<section id="symbolic-expressions" class="level4">
<h4 class="anchored" data-anchor-id="symbolic-expressions">Symbolic expressions</h4>
<p>The partial derivatives are more directly found with <code>SymPy</code>. As with univariate functions, the <code>diff</code> function is used by simply passing in the variable in which to find the partial derivative:</p>
<pre class="{julia}"><code>@syms x y
ex = x^2 - 2x*y
diff(ex, x)</code></pre>
<p>And evaluation:</p>
<pre class="{julia}"><code>diff(ex,x)(x=&gt;1, y=&gt;2)</code></pre>
<p>Or</p>
<pre class="{julia}"><code>diff(ex, y)(x=&gt;1, y=&gt;2)</code></pre>
<p>The gradient would be found by combining the two:</p>
<pre class="{julia}"><code>[diff(ex, x), diff(ex, y)]</code></pre>
<p>This can be simplified through broadcasting:</p>
<pre class="{julia}"><code>grad_ex = diff.(ex, [x,y])</code></pre>
<p>To evaluate at a point we have:</p>
<pre class="{julia}"><code>subs.(grad_ex, x=&gt;1, y=&gt;2)</code></pre>
<p>The above relies on broadcasting treating the pair as a single value so the substitution is repeated for each entry of <code>grad_ex</code>.</p>
<p>The <code>gradient</code> function from <code>CalculusWithJulia</code> is defined to find the symbolic gradient. It uses <code>free_symbols</code> to specify the number and order of the variables, but that may be wrong; they are specified below:</p>
<pre class="{julia}"><code>gradient(ex, [x, y])   # [∂f/∂x, ∂f/∂y]</code></pre>
<p>To use <code>∇</code> and specify the variables, a tuple (grouping parentheses) is used:</p>
<pre class="{julia}"><code>∇((ex, [x,y]))</code></pre>
<hr>
<p>In computer science there are two related concepts <a href="https://en.wikipedia.org/wiki/Currying">Currying</a> and <a href="https://en.wikipedia.org/wiki/Partial_application">Partial application</a>. For a function <span class="math inline">\(f(x,y)\)</span>, say, partial application is the process of fixing one of the variables, producing a new function of fewer variables. For example, fixing <span class="math inline">\(y=c\)</span>, the we get a new function (of just <span class="math inline">\(x\)</span> and not <span class="math inline">\((x,y)\)</span>) <span class="math inline">\(g(x) = f(x,c)\)</span>. In partial derivatives the partial derivative of <span class="math inline">\(f(x,y)\)</span> with respect to <span class="math inline">\(x\)</span> is the derivative of the function <span class="math inline">\(g\)</span>, as defined above.</p>
<p>Currying, is related, but technically returns a function, so we think of the curried version of <span class="math inline">\(f\)</span> as a function, <span class="math inline">\(h\)</span>, which takes <span class="math inline">\(x\)</span> and returns the function <span class="math inline">\(y \rightarrow f(x,y)\)</span> so that <span class="math inline">\(h(x)(y) = f(x, y)\)</span>.</p>
</section>
</section>
<section id="visualizing-the-gradient" class="level3" data-number="55.3.2">
<h3 data-number="55.3.2" class="anchored" data-anchor-id="visualizing-the-gradient"><span class="header-section-number">55.3.2</span> Visualizing the gradient</h3>
<p>The gradient is not a univariate function, a simple vector-valued function, or a scalar function, but rather a <em>vector field</em> (which will be discussed later). For the case, <span class="math inline">\(f: R^2 \rightarrow R\)</span>, the gradient will be a function which takes a point <span class="math inline">\((x,y)\)</span> and returns a vector , <span class="math inline">\(\langle \partial{f}/\partial{x}(x,y), \partial{f}/\partial{y}(x,y) \rangle\)</span>. We can visualize this by plotting a vector at several points on a grid. This task is made easier with a function like the following, which handles the task of vectorizing the values. It is provided within the <code>CalculusWithJulia</code> package:</p>
<pre class="{julia}"><code>#| eval: false
function vectorfieldplot!(V; xlim=(-5,5), ylim=(-5,5), nx=10, ny=10, kwargs...)

    dx, dy = (xlim[2]-xlim[1])/nx, (ylim[2]-ylim[1])/ny
    xs, ys = xlim[1]:dx:xlim[2], ylim[1]:dy:ylim[2]

    ps = [[x,y] for x in xs for y in ys]
    vs = V.(ps)
    λ = 0.9 * minimum([u/maximum(getindex.(vs,i)) for (i,u) in enumerate((dx,dy))])

    quiver!(unzip(ps)..., quiver=unzip(λ * vs))

end</code></pre>
<p>Here we show the gradient for the scalar function <span class="math inline">\(f(x,y) = 2 - x^2 - 3y^2\)</span> over the region <span class="math inline">\([-2, 2]\times[-2,2]\)</span> along with a contour plot:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - x^2 - 3y^2
f(v) = f(v...)

xs = ys = range(-2,2, length=50)

p = contour(xs, ys, f, nlevels=12)
vectorfieldplot!(p, gradient(f), xlim=(-2,2), ylim=(-2,2), nx=10, ny=10)

p</code></pre>
<p>The figure suggests a potential geometric relationship between the gradient and the contour line to be explored later.</p>
</section>
</section>
<section id="differentiable" class="level2" data-number="55.4">
<h2 data-number="55.4" class="anchored" data-anchor-id="differentiable"><span class="header-section-number">55.4</span> Differentiable</h2>
<p>We see here how the gradient of <span class="math inline">\(f\)</span>, <span class="math inline">\(\nabla{f} = \langle f_{x_1}, f_{x_2}, \dots, f_{x_n} \rangle\)</span>, plays a similar role as the derivative does for univariate functions.</p>
<p>First, we consider the role of the derivative for univariate functions. The main characterization - the derivative is the slope of the line that best approximates the function at a point - is quantified by Taylor’s theorem. For a function <span class="math inline">\(f\)</span> with a continuous second derivative:</p>
<p><span class="math display">\[
f(c+h) = f(c) = f'(c)h + \frac{1}{2} f''(\xi) h^2,
\]</span></p>
<p>for some <span class="math inline">\(\xi\)</span> within <span class="math inline">\(c\)</span> and <span class="math inline">\(c+h\)</span>.</p>
<p>We re-express this through:</p>
<p><span class="math display">\[
(f(c+h) - f(c)) - f'(c)h  =\frac{1}{2} f''(\xi) h^2.
\]</span></p>
<p>The right hand side is the <em>error</em> term between the function value at <span class="math inline">\(c+h\)</span> and, in this case, the linear approximation at the same value.</p>
<p>If the assumptions are relaxed, and <span class="math inline">\(f\)</span> is just assumed to be <em>differentiable</em> at <span class="math inline">\(x=c\)</span>, then only this is known:</p>
<p><span class="math display">\[
(f(c+h) - f(c)) - f'(c)h  = \epsilon(h) h,
\]</span></p>
<p>where <span class="math inline">\(\epsilon(h) \rightarrow 0\)</span> as <span class="math inline">\(h \rightarrow 0\)</span>.</p>
<p>It is this characterization of differentiable that is generalized to define when a scalar function is <em>differentiable</em>.</p>
<blockquote class="blockquote">
<p><em>Differentiable</em>: Let <span class="math inline">\(f\)</span> be a scalar function. Then <span class="math inline">\(f\)</span> is <a href="https://tinyurl.com/qj8qcbb">differentiable</a> at a point <span class="math inline">\(C\)</span> <strong>if</strong> the first order partial derivatives exist at <span class="math inline">\(C\)</span> <strong>and</strong> for <span class="math inline">\(\vec{h}\)</span> going to <span class="math inline">\(\vec{0}\)</span>:</p>
<p><span class="math inline">\(\|f(C + \vec{h}) - f(C) - \nabla{f}(C) \cdot \vec{h}\| = \mathcal{o}(\|\vec{h}\|),\)</span></p>
<p>where <span class="math inline">\(\mathcal{o}(\|\vec{h}\|)\)</span> means that dividing the left hand side by <span class="math inline">\(\|\vec{h}\|\)</span> and taking a limit as <span class="math inline">\(\vec{h}\rightarrow 0\)</span> the limit will be <span class="math inline">\(0\)</span>..</p>
</blockquote>
<p>The limits here are for limits of scalar functions, which means along any path going to <span class="math inline">\(\vec{0}\)</span>, not just straight line paths, as are used to define the partial derivatives. Hidden above, is an assumption that there is some open set around <span class="math inline">\(C\)</span> for which <span class="math inline">\(f\)</span> is defined for <span class="math inline">\(f(C + \vec{h})\)</span> when <span class="math inline">\(C+\vec{h}\)</span> is in this open set.</p>
<p>The role of the derivative in the univariate case is played by the gradient in the scalar case, where <span class="math inline">\(f'(c)h\)</span> is replaced by <span class="math inline">\(\nabla{f}(C) \cdot \vec{h}\)</span>. For the univariate case, differentiable is simply the derivative existing, but saying a scalar function is differentiable at <span class="math inline">\(C\)</span> is a stronger statement than saying it has a gradient or, equivalently, it has partial derivatives at <span class="math inline">\(C\)</span>, as this is assumed in the statement along with the other condition.</p>
<p>Later we will see how Taylor’s theorem generalizes for scalar functions and interpret the gradient geometrically, as was done for the derivative (it being the slope of the tangent line).</p>
</section>
<section id="the-chain-rule-to-evaluate-fcircvecgamma" class="level2" data-number="55.5">
<h2 data-number="55.5" class="anchored" data-anchor-id="the-chain-rule-to-evaluate-fcircvecgamma"><span class="header-section-number">55.5</span> The chain rule to evaluate <span class="math inline">\(f\circ\vec\gamma\)</span></h2>
<p>In finding a partial derivative, we restricted the surface along a curve in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane, in this case the curve <span class="math inline">\(\vec{\gamma}(t)=\langle t, c\rangle\)</span>. In general if we have a curve in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane, <span class="math inline">\(\vec{\gamma}(t)\)</span>, we can compose the scalar function <span class="math inline">\(f\)</span> with <span class="math inline">\(\vec{\gamma}\)</span> to create a univariate function. If the functions are “smooth” then this composed function should have a derivative, and some version of a “chain rule” should provide a means to compute the derivative in terms of the “derivative” of <span class="math inline">\(f\)</span> (the gradient) and the derivative of <span class="math inline">\(\vec{\gamma}\)</span> (<span class="math inline">\(\vec{\gamma}'\)</span>).</p>
<blockquote class="blockquote">
<p><em>Chain rule</em>: Suppose <span class="math inline">\(f\)</span> is <em>differentiable</em> at <span class="math inline">\(C\)</span>, and <span class="math inline">\(\vec{\gamma}(t)\)</span> is differentiable at <span class="math inline">\(c\)</span> with <span class="math inline">\(\vec{\gamma}(c) = C\)</span>. Then <span class="math inline">\(f\circ\vec{\gamma}\)</span> is differentiable at <span class="math inline">\(c\)</span> with derivative <span class="math inline">\(\nabla f(\vec{\gamma}(c)) \cdot \vec{\gamma}'(c)\)</span>.</p>
</blockquote>
<p>This is similar to the chain rule for univariate functions <span class="math inline">\((f\circ g)'(u) = f'(g(u)) g'(u)\)</span> or <span class="math inline">\(df/dx = df/du \cdot du/dx\)</span>. However, when we write out in components there are more terms. For example, for <span class="math inline">\(n=2\)</span> we have with <span class="math inline">\(\vec{\gamma} = \langle x(t), y(t) \rangle\)</span>:</p>
<p><span class="math display">\[
\frac{d(f\circ\vec{\gamma})}{dt} =
\frac{\partial f}{\partial x} \frac{dx}{dt} +
\frac{\partial f}{\partial y} \frac{dy}{dt}.
\]</span></p>
<p>The proof is a consequence of the definition of differentiability and will be shown in more generality later.</p>
<section id="example-8" class="level5">
<h5 class="anchored" data-anchor-id="example-8">Example</h5>
<p>Consider the function <span class="math inline">\(f(x,y) = 2 - x^2 - y^2\)</span> and the curve <span class="math inline">\(\vec\gamma(t) = t\langle \cos(t), -\sin(t) \rangle\)</span> at <span class="math inline">\(t=\pi/6\)</span>. We visualize this below:</p>
<pre class="{julia}"><code>f₃(x,y) = 2 - x^2 - y^2
f₃(x) = f₃(x...)
γ₃(t) = t*[cos(t), -sin(t)]
t0₃ = pi/6</code></pre>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-3/2, 3/2, length=100)
surface(xs, ys, f₃, legend=false)

r(t) = [γ₃(t)..., (f₃∘γ₃)(t)]
plot_parametric!(0..1/2, r, linewidth=5, color=:black)

arrow!(r(t0₃), r'(t0₃), linewidth=5, color=:black)</code></pre>
<p>In three dimensions, the tangent line is seen, but the univariate function <span class="math inline">\(f \circ \vec\gamma\)</span> looks like:</p>
<pre class="{julia}"><code>#| hold: true
plot(f₃ ∘ γ₃, 0, pi/2)
plot!(t -&gt; (f₃ ∘ γ₃)(t0₃) + (f₃ ∘ γ₃)'(t0₃)*(t - t0₃), 0, pi/2)</code></pre>
<p>From the graph, the slope of the tangent line looks to be about <span class="math inline">\(-1\)</span>, using the chain rule gives the exact value:</p>
<pre class="{julia}"><code>ForwardDiff.gradient(f₃, γ₃(t0₃)) ⋅ γ₃'(t0₃)</code></pre>
<p>We can compare this to taking the derivative after composition:</p>
<pre class="{julia}"><code>(f₃ ∘ γ₃)'(t0₃)</code></pre>
</section>
<section id="example-9" class="level5">
<h5 class="anchored" data-anchor-id="example-9">Example</h5>
<p>Consider the following plot showing a hiking trail on a surface:</p>
<pre class="{julia}"><code>#| echo: false
lenape = CSV.File(IOBuffer(lenape_csv)) |&gt; DataFrame
nothing</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
xs, ys, zs =  [float.(SC[i]) for i in ("xs", "ys","zs")]
zzs = reshape(zs, (length(xs), length(ys)))' # reshape to matrix
surface(xs, ys, zzs, legend=false)
plot!(lenape.longitude, lenape.latitude, lenape.elevation, linewidth=5, color=:black)</code></pre>
<p>Though here it is hard to see the trail rendered on the surface, for the hiker, such questions are far from the mind. Rather, questions such as what is the steepest part of the trail may come to mind.</p>
<p>For this question, we can answer it in turns of the sampled data in the <code>lenape</code> variable. The steepness being the change in elevation with respect to distance in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> direction. Treating latitude and longitude coordinates describing motion in a plane (as opposed to a very big sphere), we can compute the maximum steepness:</p>
<pre class="{julia}"><code>#| hold: true
xs, ys, zs = lenape.longitude, lenape.latitude, lenape.elevation
dzs = zs[2:end] - zs[1:end-1]
dxs, dys = xs[2:end] - xs[1:end-1], ys[2:end] - ys[1:end-1]
deltas = sqrt.(dxs.^2 + dys.^2) * 69 / 1.6 * 1000 # in meters now
global slopes = abs.(dzs ./ deltas)  # to re-use
m = maximum(slopes)
atand(maximum(slopes))   # in degrees due to the `d`</code></pre>
<p>This is certainly too steep for a trail, which should be at most <span class="math inline">\(10\)</span> to <span class="math inline">\(15\)</span> degrees or so, not <span class="math inline">\(58\)</span>. This is due to the inaccuracy in the measurements. An average might be better:</p>
<pre class="{julia}"><code>import Statistics: mean
atand(mean(slopes))</code></pre>
<p>Which seems about right for a generally uphill trail section, as this is.</p>
<p>In the above example, the data is given in terms of a sample, not a functional representation. Suppose instead, the surface was generated by <code>f</code> and the path - in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane - by <span class="math inline">\(\gamma\)</span>. Then we could estimate the maximum and average steepness by a process like this:</p>
<pre class="{julia}"><code>f₄(x,y) = 2 - x^2 - y^2
f₄(x) = f₄(x...)
γ₄(t) = t*[cos(t), -sin(t)]</code></pre>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-3/2, 3/2, length=100)

surface(xs, ys, f₄, legend=false)
r(t) = [γ₄(t)..., (f₄ ∘ γ₄)(t)]
plot_parametric!(0..1/2, r, linewidth=5, color=:black)</code></pre>
<pre class="{julia}"><code>plot(f₄ ∘ γ₄, 0, pi/2)
slope(t) = abs((f₄ ∘ γ₄)'(t))

1/(pi/2 - 0) * quadgk(t -&gt; atand(slope(t)), 0, pi/2)[1]  # the average</code></pre>
<p>the average is <span class="math inline">\(50\)</span> degrees. As for the maximum slope:</p>
<pre class="{julia}"><code>#| hold: true
cps = find_zeros(slope, 0, pi/2) # critical points

append!(cps, (0, pi/2))  # add end points
unique!(cps)

M, i = findmax(slope.(cps))  # max, index

cps[i], slope(cps[i])</code></pre>
<p>The maximum slope occurs at an endpoint.</p>
</section>
</section>
<section id="directional-derivatives" class="level2" data-number="55.6">
<h2 data-number="55.6" class="anchored" data-anchor-id="directional-derivatives"><span class="header-section-number">55.6</span> Directional Derivatives</h2>
<p>The last example, how steep is the direction we are walking, is a question that can be asked when walking in a straight line in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane. The answer has a simplified answer:</p>
<p>Let <span class="math inline">\(\vec\gamma(t) = C + t \langle a, b \rangle\)</span> be a line that goes through the point <span class="math inline">\(C\)</span> parallel, or in the direction of, to <span class="math inline">\(\vec{v} = \langle a , b \rangle\)</span>.</p>
<p>Then the function <span class="math inline">\(f \circ \vec\gamma(t)\)</span> will have a derivative when <span class="math inline">\(f\)</span> is differentiable and by the chain rule will be:</p>
<p><span class="math display">\[
(f\circ\vec\gamma)'(\vec\gamma(t)) = \nabla{f}(\vec\gamma(t)) \cdot \vec\gamma'(t) =
\nabla{f}(\vec\gamma(t)) \cdot \langle a, b\rangle =
\vec{v} \cdot \nabla{f}(\vec\gamma(t)).
\]</span></p>
<p>At <span class="math inline">\(t=0\)</span>, we see that <span class="math inline">\((f\circ\vec\gamma)'(C) = \nabla{f}(C)\cdot \vec{v}\)</span>.</p>
<p>This defines the <em>directional derivative</em> at <span class="math inline">\(C\)</span> in the direction <span class="math inline">\(\vec{v}\)</span>:</p>
<p><span class="math display">\[
\text{Directional derivative} = \nabla_{\vec{v}}(f) =  \nabla{f} \cdot \vec{v}.
\]</span></p>
<p>If <span class="math inline">\(\vec{v}\)</span> is a <em>unit</em> vector, then the value of the directional derivative is the rate of increase in <span class="math inline">\(f\)</span> in the direction of <span class="math inline">\(\vec{v}\)</span>.</p>
<p>This is a <em>natural</em> generalization of the partial derivatives, which, in two dimensions, are the directional derivative in the <span class="math inline">\(x\)</span> direction and the directional derivative in the <span class="math inline">\(y\)</span> direction.</p>
<p>The following figure shows <span class="math inline">\(C = (1/2, -1/2)\)</span> and the two curves. Planes are added, as it can be easiest to visualize these curves as the intersection of the surface generated by <span class="math inline">\(f\)</span> and the vertical planes <span class="math inline">\(x=C_x\)</span> and <span class="math inline">\(y=C_y\)</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = 2 - x^2 - y^2

xs = ys = range(-3/2, 3/2, length=100)
surface(xs, ys, f, legend=false)
M=f(3/2,3/2)

x0,y0 = 1/2, -1/2
plot!([-3/2, 3/2, 3/2, -3/2, -3/2], y0 .+ [0,0,0,0, 0], [M,M,2,2,M], linestyle=:dash)
r(x) = [x, y0, f(x,y0)]
plot_parametric!(-3/2..3/2, r, linewidth=5, color=:black)


plot!(x0 .+ [0,0,0,0, 0], [-3/2, 3/2, 3/2, -3/2, -3/2], [M,M,2,2,M], linestyle=:dash)
r(y) = [x0, y, f(x0, y)]
plot_parametric!(-3/2..3/2, r, linewidth=5, color=:black)


scatter!([x0],[y0],[M])
arrow!([x0,y0,M], [1,0,0], linewidth=3)
arrow!([x0,y0,M], [0, 1,0], linewidth=3)</code></pre>
<p>We can then visualize the directional derivative by a plane through <span class="math inline">\(C\)</span> in the direction <span class="math inline">\(\vec{v}\)</span>. Here we take <span class="math inline">\(C=(1/2, -1/2)\)</span>, as before, and <span class="math inline">\(\vec{v} = \langle 1, 1\rangle\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = 2 - x^2 - y^2
f(x) = f(x...)
xs = ys = range(-3/2, 3/2, length=100)
p = surface(xs, ys, f, legend=false)
M=f(3/2,3/2)

x0,y0 = 1/2, -1/2
vx, vy = 1, 1
l1(t) = [x0, y0] .+ t*[vx, vy]
llx, lly = l1(-1)
rrx, rry = l1(1)
plot!([llx, rrx, rrx, llx, llx], [lly, rry, rry, lly, lly], [M,M, 2, 2, M], linestyle=:dash)

r(t) = [l1(t)..., f(l1(t))]
plot_parametric!(-1..1, r, linewidth=5, color=:black)
arrow!(r(0), r'(0), linewidth=5, color=:black)


scatter!([x0],[y0],[M])
arrow!([x0,y0,M], [vx, vy,0], linewidth=3)</code></pre>
<p>In this figure, we see that the directional derivative appears to be <span class="math inline">\(0\)</span>, unlike the partial derivatives in <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, which are negative and positive, respectively.</p>
<section id="example-10" class="level5">
<h5 class="anchored" data-anchor-id="example-10">Example</h5>
<p>Let <span class="math inline">\(f(x,y) = \sin(x+2y)\)</span> and <span class="math inline">\(\vec{v} = \langle 2, 1\rangle\)</span>. The directional derivative of <span class="math inline">\(f\)</span> in the direction of <span class="math inline">\(\vec{v}\)</span> at <span class="math inline">\((x,y)\)</span> is:</p>
<p><span class="math display">\[
\nabla{f}\cdot \frac{\vec{v}}{\|\vec{v}\|} = \langle \cos(x + 2y), 2\cos(x + 2y)\rangle \cdot \frac{\langle 2, 1 \rangle}{\sqrt{5}} = \frac{4}{\sqrt{5}} \cos(x + 2y).
\]</span></p>
</section>
<section id="example-11" class="level5">
<h5 class="anchored" data-anchor-id="example-11">Example</h5>
<p>Suppose <span class="math inline">\(f(x,y)\)</span> describes a surface, and <span class="math inline">\(\vec\gamma(t)\)</span> parameterizes a path in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane. Then the vector valued function <span class="math inline">\(\vec{r}(t) = \langle \vec\gamma_1(t), \vec\gamma_2(t), (f\circ\vec\gamma)(t)\rangle\)</span> describes a path on the surface. The maximum steepness of the this path is found by maximizing the slope of the directional derivative in the direction of the tangent line. This would be the function of <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
\nabla{f}(\vec\gamma(t)) \cdot \vec{T}(t),
\]</span></p>
<p>Where <span class="math inline">\(T(t) = \vec\gamma'(t)/\|\vec\gamma'(t)\|\)</span> is the unit tangent vector to <span class="math inline">\(\gamma\)</span>.</p>
<p>Let <span class="math inline">\(f(x,y) = 2 - x^2 - y^2\)</span> and <span class="math inline">\(\vec\gamma(t) = (\pi-t) \langle \cos(t), \sin(t) \rangle\)</span>. What is the maximum steepness?</p>
<p>We have <span class="math inline">\(\nabla{f} = \langle -2x, -2y \rangle\)</span> and <span class="math inline">\(\vec\gamma'(t) = -\langle(\cos(t), \sin(t)) + (\pi-t) \langle(-\sin(t), \cos(t)\rangle\)</span>. We maximize this over <span class="math inline">\([0, \pi]\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - x^2 - y^2
f(v) = f(v...)
gamma(t) = (pi-t) * [cos(t), sin(t)]
dd(t) = gradient(f)(gamma(t)) ⋅ gamma'(t)

cps = find_zeros(dd, 0, pi)
unique!(append!(cps, (0, pi)))  # add endpoints
M,i = findmax(dd.(cps))
M</code></pre>
</section>
<section id="example-the-gradient-indicates-the-direction-of-steepest-ascent" class="level5">
<h5 class="anchored" data-anchor-id="example-the-gradient-indicates-the-direction-of-steepest-ascent">Example: The gradient indicates the direction of steepest ascent</h5>
<p>Consider this figure showing a surface and a level curve along with a contour line:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = sqrt(x^2 + y^2)
f(v) = f(v...)

xs = ys = range(-2, 2, length=100)
p = surface(xs, ys, f, legend=false)

γ(t) = [cos(t), sin(t), f(cos(t), sin(t))]
plot_parametric!(0..2pi, γ, linewidth=5)

t =7pi/4;
scatter!(p, unzip([γ(t)])...)


rad(t) = 1 * [cos(t), sin(t)]
γ(t) = [rad(t)..., 0]
plot_parametric!(0..2pi, γ, linestyle=:dash)



arrow!(γ(t), γ'(t))
arrow!(γ(t), [ForwardDiff.gradient(f, rad(t))..., 0])</code></pre>
<p>We have the level curve for <span class="math inline">\(f(x,y) = c\)</span> represented, and a point <span class="math inline">\((x,y, f(x,y))\)</span> drawn. At the point <span class="math inline">\((x,y)\)</span> which sits on the level curve, we have indicated the gradient and the tangent curve to the level curve, or contour line. Worth reiterating, the gradient is not on the surface, but rather is a <span class="math inline">\(2\)</span>-dimensional vector, but it does indicate a direction that can be taken on the surface. We will see that this direction indicates the path of steepest ascent.</p>
<p>The figure suggests a relationship between the gradient and the tangents to the contour lines. Let’s parameterize the contour line by <span class="math inline">\(\vec\gamma(t)\)</span>, assuming such a parameterization exists, let <span class="math inline">\(C = (x,y) = \vec\gamma(t)\)</span>, for some <span class="math inline">\(t\)</span>, be a point on the level curve, and <span class="math inline">\(\vec{T} = \vec\gamma'(t)/\|\vec\gamma'(t)\|\)</span> be the tangent to to the level curve at <span class="math inline">\(C\)</span>. Then the directional derivative at <span class="math inline">\(C\)</span> in the direction of <span class="math inline">\(T\)</span> must be <span class="math inline">\(0\)</span>, as along the level curve, the function <span class="math inline">\(f\circ \vec\gamma = c\)</span>, a constant. But by the chain rule, this says:</p>
<p><span class="math display">\[
0 = (c)' = (f\circ\vec\gamma)'(t) = \nabla{f}(\vec\gamma(t)) \cdot \vec\gamma'(t)
\]</span></p>
<p>That is the gradient is <em>orthogonal</em> to <span class="math inline">\(\vec{\gamma}'(t)\)</span>. As well, is orthogonal to the tangent vector <span class="math inline">\(\vec{T}\)</span> and hence to the level curve at any point. (As the dot product is <span class="math inline">\(0\)</span>.)</p>
<p>Now, consider a unit vector <span class="math inline">\(\vec{v}\)</span> in the direction of steepest ascent at <span class="math inline">\(C\)</span>. Since <span class="math inline">\(\nabla{f}(C)\)</span> and <span class="math inline">\(\vec{T}\)</span> are orthogonal, we can express the unit vector uniquely as <span class="math inline">\(a\nabla{f}(C) + b \vec{T}\)</span> with <span class="math inline">\(a^2 + b^2 = 1\)</span>. The directional derivative is then</p>
<p><span class="math display">\[
\nabla{f} \cdot \vec{v} = \nabla{f}  \cdot (a\nabla{f}(C) + b \vec{T}) = a \| \nabla{f} \|^2  + b \nabla{f} \cdot \vec{T} = a \| \nabla{f} \|^2.
\]</span></p>
<p>The will be largest when <span class="math inline">\(a=1\)</span> and <span class="math inline">\(b=0\)</span>. That is, the direction of greatest ascent in indicated by the gradient. (It is smallest when <span class="math inline">\(a=-1\)</span> and <span class="math inline">\(b=0\)</span>, the direction opposite the gradient.</p>
<p>In practical terms, if standing on a hill, walking in the direction of the gradient will go uphill the fastest possible way, walking along a contour will not gain any elevation. The two directions are orthogonal.</p>
</section>
</section>
<section id="other-types-of-compositions-and-the-chain-rule" class="level2" data-number="55.7">
<h2 data-number="55.7" class="anchored" data-anchor-id="other-types-of-compositions-and-the-chain-rule"><span class="header-section-number">55.7</span> Other types of compositions and the chain rule</h2>
<p>The chain rule we discussed was for a composition of <span class="math inline">\(f:R^n \rightarrow R\)</span> with <span class="math inline">\(\vec\gamma:R \rightarrow R^n\)</span> resulting in a function <span class="math inline">\(f\circ\vec\gamma:R \rightarrow R\)</span>. There are other possible compositions.</p>
<p>For example, suppose we have an economic model for beverage consumption based on temperature given by <span class="math inline">\(c(T)\)</span>. But temperature depends on geographic location, so may be modeled through a function <span class="math inline">\(T(x,y)\)</span>. The composition <span class="math inline">\(c \circ T\)</span> would be a function from <span class="math inline">\(R^2 \rightarrow R\)</span>, so should have partial derivatives with respect to <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> which should be expressible in terms of the derivative of <span class="math inline">\(c\)</span> and the partial derivatives of <span class="math inline">\(T\)</span>.</p>
<p>Consider a different situation, say we have <span class="math inline">\(f(x,y)\)</span> a scalar function, but want to consider the position in polar coordinates involving <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span>. We can think directly of <span class="math inline">\(F(r,\theta) = f(r\cdot\cos(\theta), r\cdot\sin(\theta))\)</span>, but more generally, we have a function <span class="math inline">\(G(r, \theta)\)</span> that is vector valued: <span class="math inline">\(G(r,\theta) = \langle r\cdot\cos(\theta), r\cdot\sin(\theta) \rangle\)</span> (<span class="math inline">\(G:R^2 \rightarrow R^2\)</span>). The composition <span class="math inline">\(F=f\circ G\)</span> is a scalar function of <span class="math inline">\(r\)</span> and <span class="math inline">\(\theta\)</span> and the partial derivatives with respect to these should be expressible in terms of the partial derivatives of <span class="math inline">\(f\)</span> and the partial derivatives of <span class="math inline">\(G\)</span>.</p>
<p>Finding the derivative of a composition in terms of the individual pieces involves some form of the chain rule, which will differ depending on the exact circumstances.</p>
<section id="chain-rule-for-a-univariate-function-composed-with-a-scalar-function" class="level3" data-number="55.7.1">
<h3 data-number="55.7.1" class="anchored" data-anchor-id="chain-rule-for-a-univariate-function-composed-with-a-scalar-function"><span class="header-section-number">55.7.1</span> Chain rule for a univariate function composed with a scalar function</h3>
<p>If <span class="math inline">\(f(t)\)</span> is a univariate function and <span class="math inline">\(G(x,y)\)</span> a scalar function, the <span class="math inline">\(F(x,y) = f(G(x,y))\)</span> will be a scalar function and may have partial derivatives. If <span class="math inline">\(f\)</span> and <span class="math inline">\(G\)</span> are differentiable at a point <span class="math inline">\(P\)</span>, then</p>
<p><span class="math display">\[
\frac{\partial F}{\partial x} = f'(G(x,y)) \frac{\partial G}{\partial x}, \quad
\frac{\partial F}{\partial y} = f'(G(x,y)) \frac{\partial G}{\partial y},
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\nabla{F} = \nabla{f \circ G} = f'(G(x,y)) \nabla{G}(x,y).
\]</span></p>
<p>The result is an immediate application of the univariate chain rule, when the partial functions are considered.</p>
<section id="example-12" class="level5">
<h5 class="anchored" data-anchor-id="example-12">Example</h5>
<p>Imagine a scenario where sales of some commodity (say ice) depend on the temperature which in turn depends on location. Formally, we might have functions <span class="math inline">\(S(T)\)</span> and <span class="math inline">\(T(x,y)\)</span> and then sales would be the composition <span class="math inline">\(S(T(x,y))\)</span>. How might sales go up or down if one moved west, or one moved in the northwest direction? These would be a <em>directional</em> derivative, answered by <span class="math inline">\(\nabla{S}\cdot \hat{v}\)</span>, where <span class="math inline">\(\vec{v}\)</span> is the direction. Of importance would be to compute <span class="math inline">\(\nabla{S}\)</span> which might best be done through the chain rule.</p>
<p>For example, if <span class="math inline">\(S(T) = \exp((T - 70)/10)\)</span> and <span class="math inline">\(T(x,y) = (1-x^2)\cdot y\)</span>, the gradient of <span class="math inline">\(S(T(x,y))\)</span> would be given by:</p>
<p><span class="math display">\[
S'(T(x,y)) \nabla{T}(x,y) = (S(T(x,y))/10) \langle(-2xy, 1-x^2 \rangle.
\]</span></p>
</section>
</section>
<section id="chain-rule-for-a-scalar-function-f-composed-with-a-function-g-rm-rightarrow-rn." class="level3" data-number="55.7.2">
<h3 data-number="55.7.2" class="anchored" data-anchor-id="chain-rule-for-a-scalar-function-f-composed-with-a-function-g-rm-rightarrow-rn."><span class="header-section-number">55.7.2</span> Chain rule for a scalar function, <span class="math inline">\(f\)</span>, composed with a function <span class="math inline">\(G: R^m \rightarrow R^n\)</span>.</h3>
<p>If <span class="math inline">\(G(u_1, \dots, u_m) = \langle G_1, G_2,\dots, G_n\rangle\)</span> is a function of <span class="math inline">\(m\)</span> inputs that returns <span class="math inline">\(n\)</span> outputs we may view it as <span class="math inline">\(G: R^m \rightarrow R^n\)</span>. The composition with a scalar function <span class="math inline">\(f(v_1, v_2, \dots, v_n)=z\)</span> from <span class="math inline">\(R^n \rightarrow R\)</span> creates a scalar function from <span class="math inline">\(R^m \rightarrow R\)</span>, so the question of partial derivatives is of interest. We have:</p>
<p><span class="math display">\[
\frac{\partial (f \circ G)}{\partial u_i} =
\frac{\partial f}{\partial v_1} \frac{\partial G}{\partial u_i} +
\frac{\partial f}{\partial v_2} \frac{\partial G}{\partial u_i} + \dots +
\frac{\partial f}{\partial v_n} \frac{\partial G}{\partial u_i}.
\]</span></p>
<p>The gradient is then:</p>
<p><span class="math display">\[
\nabla(f\circ G) =
\frac{\partial f}{\partial v_1} \nabla{G_1} +
\frac{\partial f}{\partial v_2} \nabla{G_2} + \dots +
\frac{\partial f}{\partial v_n} \nabla{G_n} = \nabla(f) \cdot \langle \nabla{G_1}, \nabla{G_2}, \dots, \nabla{G_n} \rangle,
\]</span></p>
<p>The last expression is a suggestion, as it is an abuse of previously used notation: the dot product isn’t between vectors of the same type, as the rightmost vector is representing a vector of vectors. The <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Jacobian</a> matrix combines these vectors into a rectangular array, though with the vectors written as <em>row</em> vectors. If <span class="math inline">\(G: R^m \rightarrow R^n\)</span>, then the Jacobian is the <span class="math inline">\(n \times m\)</span> matrix with <span class="math inline">\((i,j)\)</span> entry given by <span class="math inline">\(\partial G_i, \partial u_j\)</span>:</p>
<p><span class="math display">\[
J = \left[
\begin{align}
\frac{\partial G_1}{\partial u_1} &amp; \frac{\partial G_1}{\partial u_2} &amp; \dots \frac{\partial G_1}{\partial u_m}\\
\frac{\partial G_2}{\partial u_1} &amp; \frac{\partial G_2}{\partial u_2} &amp; \dots \frac{\partial G_2}{\partial u_m}\\
&amp; \vdots &amp; \\
\frac{\partial G_n}{\partial u_1} &amp; \frac{\partial G_n}{\partial u_2} &amp; \dots \frac{\partial G_n}{\partial u_m}
\end{align}
\right].
\]</span></p>
<p>With this notation, and matrix multiplication we have <span class="math inline">\((\nabla(f\circ G))^t = \nabla(f)^t J\)</span>.</p>
<p>(Later, we will see that the chain rule in general has a familiar form using matrices, not vectors, which will avoid the need for a transpose.)</p>
<section id="example-13" class="level5">
<h5 class="anchored" data-anchor-id="example-13">Example</h5>
<p>Let <span class="math inline">\(f(x,y) = x^2 + y^2\)</span> be a scalar function. We have if <span class="math inline">\(G(r, \theta) = \langle r\cos(\theta)(, r\sin(\theta) \rangle\)</span> then after simplification, we have <span class="math inline">\((f \circ G)(r, \theta) = r^2\)</span>. Clearly then <span class="math inline">\(\partial(f\circ G)/\partial r = 2r\)</span> and <span class="math inline">\(\partial(f\circ G)/\partial \theta = 0\)</span>.</p>
<p>Were this computed through the chain rule, we have:</p>
<p><span class="math display">\[
\begin{align}
\nabla G_1 &amp;= \langle \frac{\partial r\cos(\theta)}{\partial r}, \frac{\partial r\cos(\theta)}{\partial \theta} \rangle=
\langle \cos(\theta), -r \sin(\theta) \rangle,\\
\nabla G_2 &amp;= \langle \frac{\partial r\sin(\theta)}{\partial r}, \frac{\partial r\sin(\theta)}{\partial \theta}  \rangle=
\langle \sin(\theta), r \cos(\theta) \rangle.
\end{align}
\]</span></p>
<p>We have <span class="math inline">\(\partial f/\partial x = 2x\)</span> and <span class="math inline">\(\partial f/\partial y = 2y\)</span>, which at <span class="math inline">\(G\)</span> are <span class="math inline">\(2r\cos(\theta)\)</span> and <span class="math inline">\(2r\sin(\theta)\)</span>, so by the chain rule, we should have</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial (f\circ G)}{\partial r} &amp;=
\frac{\partial{f}}{\partial{x}}\frac{\partial G_1}{\partial r} +
\frac{\partial{f}}{\partial{y}}\frac{\partial G_2}{\partial r} =
2r\cos(\theta) \cos(\theta) + 2r\sin(\theta) \sin(\theta) =
2r (\cos^2(\theta) + \sin^2(\theta)) = 2r, \\
\frac{\partial (f\circ G)}{\partial \theta} &amp;=
\frac{\partial f}{\partial x}\frac{\partial G_1}{\partial \theta} +
\frac{\partial f}{\partial y}\frac{\partial G_2}{\partial \theta} =
2r\cos(\theta)(-r\sin(\theta)) + 2r\sin(\theta)(r\cos(\theta)) = 0.
\end{align}
\]</span></p>
</section>
</section>
</section>
<section id="higher-order-partial-derivatives" class="level2" data-number="55.8">
<h2 data-number="55.8" class="anchored" data-anchor-id="higher-order-partial-derivatives"><span class="header-section-number">55.8</span> Higher order partial derivatives</h2>
<p>If <span class="math inline">\(f:R^n \rightarrow R\)</span>, the <span class="math inline">\(\partial f/\partial x_i\)</span> takes <span class="math inline">\(R^n \rightarrow R\)</span> too, so may also have a partial derivative.</p>
<p>Consider the case <span class="math inline">\(f: R^2 \rightarrow R\)</span>, then there are <span class="math inline">\(4\)</span> possible partial derivatives of order 2: partial in <span class="math inline">\(x\)</span> then <span class="math inline">\(x\)</span>, partial in <span class="math inline">\(x\)</span> then <span class="math inline">\(y\)</span>, partial in <span class="math inline">\(y\)</span> and then <span class="math inline">\(x\)</span>, and, finally, partial in <span class="math inline">\(y\)</span> and then <span class="math inline">\(y\)</span>.</p>
<p>The notation for the partial in <span class="math inline">\(y\)</span> <em>of</em> the partial in <span class="math inline">\(x\)</span> is:</p>
<p><span class="math display">\[
\frac{\partial^2 f}{\partial{y}\partial{x}} = \frac{\partial{\frac{\partial{f}}{\partial{x}}}}{\partial{y}} = \frac{\partial f_x}{\partial{y}} = f_{xy}.
\]</span></p>
<p>The placement of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> indicating the order is different in the two notations.</p>
<p>We can compute these for an example easily enough:</p>
<pre class="{julia}"><code>#| hold: true
@syms x y
f(x, y) = exp(x) * cos(y)
ex = f(x,y)
diff(ex, x, x), diff(ex, x, y), diff(ex, y, x), diff(ex, y, y)</code></pre>
<p>In <code>SymPy</code> the variable to differentiate by is taken from left to right, so <code>diff(ex, x, y, x)</code> would first take the partial in <span class="math inline">\(x\)</span>, then <span class="math inline">\(y\)</span>, and finally <span class="math inline">\(x\)</span>.</p>
<p>We see that <code>diff(ex, x, y)</code> and <code>diff(ex, y, x)</code> are identical. This is not a coincidence, as by <a href="https://tinyurl.com/y7sfw9sx">Schwarz’s Theorem</a> (also known as Clairaut’s theorem) this will always be the case under typical assumptions:</p>
<blockquote class="blockquote">
<p>Theorem on mixed partials. If the mixed partials <span class="math inline">\(\partial^2 f/\partial x \partial y\)</span> and <span class="math inline">\(\partial^2 f/\partial y \partial x\)</span> exist and are continuous, then they are equal.</p>
</blockquote>
<p>For higher order mixed partials, something similar to Schwarz’s theorem still holds. Say <span class="math inline">\(f:R^n \rightarrow R\)</span> is <span class="math inline">\(C^k\)</span> if <span class="math inline">\(f\)</span> is continuous and all partial derivatives of order <span class="math inline">\(j \leq k\)</span> are continous. If <span class="math inline">\(f\)</span> is <span class="math inline">\(C^k\)</span>, and <span class="math inline">\(k=k_1+k_2+\cdots+k_n\)</span> (<span class="math inline">\(k_i \geq 0\)</span>) then</p>
<p><span class="math display">\[
\frac{\partial^k f}{\partial x_1^{k_1} \partial x_2^{k_2}  \cdots \partial x_n^{k_n}},
\]</span></p>
<p>is uniquely defined. That is, which order the partial derivatives are taken is unimportant if the function is sufficiently smooth.</p>
<hr>
<p>The <a href="https://en.wikipedia.org/wiki/Hessian_matrix">Hessian</a> matrix is the matrix of mixed partials defined (for <span class="math inline">\(n=2\)</span>) by:</p>
<p><span class="math display">\[
H = \left[
\begin{align}
\frac{\partial^2 f}{\partial x \partial x} &amp; \frac{\partial^2 f}{\partial x \partial y}\\
\frac{\partial^2 f}{\partial y \partial x} &amp; \frac{\partial^2 f}{\partial y \partial y}
\end{align}
\right].
\]</span></p>
<p>For symbolic expressions, the Hessian may be computed directly in <code>SymPy</code> with its <code>hessian</code> function:</p>
<pre class="{julia}"><code>ex</code></pre>
<pre class="{julia}"><code>hessian(ex, (x, y))</code></pre>
<p>When the mixed partials are continuous, this will be a symmetric matrix. The Hessian matrix plays the role of the second derivative in the multivariate Taylor theorem.</p>
<p>For numeric use, <code>FowardDiff</code> has a <code>hessian</code> function. It expects a scalar function and a point and returns the Hessian matrix. We have for <span class="math inline">\(f(x,y) = e^x\cos(y)\)</span> at the point <span class="math inline">\((1,2)\)</span>, the Hessian matrix is:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = exp(x) * cos(y)
f(v) = f(v...)
pt = [1, 2]

ForwardDiff.hessian(f, pt)  # symmetric</code></pre>
</section>
<section id="questions" class="level2" data-number="55.9">
<h2 data-number="55.9" class="anchored" data-anchor-id="questions"><span class="header-section-number">55.9</span> Questions</h2>
<section id="question" class="level6">
<h6 class="anchored" data-anchor-id="question">Question</h6>
<p>Consider the graph of a function <span class="math inline">\(z= f(x,y)\)</span> presented below:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = x * exp(-(x^2 + y^2))
xs = ys = range(-2, stop=2, length=50)
surface(xs, ys, f)</code></pre>
<p>From the graph, is the value of <span class="math inline">\(f(1/2, 1)\)</span> positive or negative?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["positive", "negative"]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
<p>On which line is the function <span class="math inline">\(0\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"The line $x=0$",
L"The line $y=0$"
]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
<p>Consider the contour plot</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = x * exp(-(x^2 + y^2))
xs = ys = range(-2, stop=2, length=50)
contour(xs, ys, f)</code></pre>
<p>What is the value of <span class="math inline">\(f(1, 0)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
val = 0.367879
numericq(val, 1/2)</code></pre>
<p>From this graph, the minimum value over this region is</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"is around $(-0.7, 0)$ and with a value less than $-0.4$",
L"is around $(0.7, 0)$ and with a value less than $-0.4$",
L"is around $(-2.0, 0)$ and with a value less than $-0.4$",
L"is around $(2.0, 0)$ and with a value less than $-0.4$"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>From this graph, where is the surface steeper?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"near $(1/4, 0)$",
L"near $(1/2, 0)$",
L"near $(3/4, 0)$",
L"near $(1, 0)$"
]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
</section>
<section id="question-1" class="level6">
<h6 class="anchored" data-anchor-id="question-1">Question</h6>
<p>Consider the contour graph of a function below:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y)= sin(x)*cos(x*y)
xs = ys = range(-3, stop=3, length=50)
contour(xs, ys, f)</code></pre>
<p>Are there any peaks or valleys (local extrema) indicated?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"Yes, the closed loops near $(-1.5, 0)$ and $(1.5, 0)$ will contain these",
L"No, the vertical lines parallel to $x=0$ show this function to be flat"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Imagine hiking on this surface within this region. Could you traverse from left to right without having to go up or down?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(false)</code></pre>
<p>Imagine hiking on this surface within this region. Could you traverse from top to bottom without having to go up or down?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(true)</code></pre>
</section>
<section id="question-2" class="level6">
<h6 class="anchored" data-anchor-id="question-2">Question</h6>
<p>The figure (taken from <a href="https://www.openstreetmap.org/way/537938655#map=15/46.5308/10.4556&amp;layers=C">openstreetmap.org</a> shows the <a href="https://en.wikipedia.org/wiki/Stelvio_Pass">Stelvio</a> Pass in Northern Italy near the Swiss border.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
ImageFile(:differentiable_vector_calculus, "figures/stelvio-pass.png", "Stelvio Pass")</code></pre>
<p>The road through the pass (on the right) makes a series of switch backs.</p>
<p>Are these</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"running essentially parallel to the contour lines",
"running essentially perpendicular to the contour lines"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Why?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"By being essentially parallel, the steepness of the roadway can be kept to a passable level",
"By being essentially perpendicular, the road can more quickly climb up the mountain"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>The pass is at about 2700 meters. As shown towards the top and bottom of the figure the contour lines show increasing heights, and to the left and right decreasing heights. The shape of the <a href="https://en.wikipedia.org/wiki/Mountain_pass">pass</a> would look like:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
"A saddle-like shape, called a *col* or *gap*",
"A upside down bowl-like shape like the top of a mountain"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-3" class="level6">
<h6 class="anchored" data-anchor-id="question-3">Question</h6>
<p>Limits of scalar functions have the same set of rules as limits of univariate functions. These include limits of constants; limits of sums, differences, and scalar multiples; limits of products; and limits of ratios. The latter with the provision that division by <span class="math inline">\(0\)</span> does not occur at the point in question.</p>
<p>Using these, identify any points where the following limit <em>may</em> not exist, knowing the limits of the individual functions exist at <span class="math inline">\(\vec{c}\)</span>:</p>
<p><span class="math display">\[
\lim_{\vec{x} \rightarrow \vec{x}} \frac{af(\vec{x})g(\vec{x}) + bh(\vec{x})}{ci(\vec{x})}.
\]</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
L"When $i(\vec{x}) = 0$",
L"When any of $f(\vec{x})$, $g(\vec{x})$, or $i(\vec{x})$ are zero",
L"The limit exists everywhere, as the function $f$, $g$, $h$, and $i$ have limits at $\vec{c}$ by assumption"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-4" class="level6">
<h6 class="anchored" data-anchor-id="question-4">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = (x^2 - y^2) /(x^2 + y^2)\)</span>.</p>
<p>Fix <span class="math inline">\(y=0\)</span>. What is <span class="math inline">\(\lim_{x \rightarrow 0} f(x,0)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(1)</code></pre>
<p>Fix <span class="math inline">\(x=0\)</span>. What is <span class="math inline">\(\lim_{y \rightarrow 0} f(0, y)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(-1)</code></pre>
<p>The two paths technique shows a limit does not exist by finding two paths with <em>different</em> limits as <span class="math inline">\(\vec{x}\)</span> approaches <span class="math inline">\(\vec{c}\)</span>. Does this apply to <span class="math inline">\(\lim_{\langle x,y\rangle \rightarrow\langle 0, 0 \rangle}f(x,y)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(true)</code></pre>
</section>
<section id="question-5" class="level6">
<h6 class="anchored" data-anchor-id="question-5">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = \langle \sin(x)\cos(2y), \sin(2x)\cos(y) \rangle\)</span></p>
<p>Compute <span class="math inline">\(f_x\)</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
raw"`` \langle \cos(x)\cos(2y), 2\cos(2x)\cos(y)\rangle``",
raw"`` \langle \cos(2y), \cos(y) \rangle``",
raw"`` \langle \sin(x), \sin(2x) \rangle``",
raw"`` \sin(x)\cos(2y)``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Compute <span class="math inline">\(f_y\)</span></p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
raw"`` \langle -2\sin(x)\sin(2y), -\sin(2x)\sin(y)  \rangle``",
raw"`` \langle 2\sin(x), \sin(2x)  \rangle``",
raw"`` \langle  -2\sin(2y), -\sin(y) \rangle``",
raw"`` - \sin(2x)\sin(y)``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-6" class="level6">
<h6 class="anchored" data-anchor-id="question-6">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = x^{y\sin(xy)}\)</span>. Using <code>ForwardDiff</code>, at the point <span class="math inline">\((1/2, 1/2)\)</span>, compute the following.</p>
<p>The value of <span class="math inline">\(f_x\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = x^(y*sin(x*y))
f(v) = f(v...)
pt  = [1/2, 1/2]
fx, fy = ForwardDiff.gradient(f, pt)
numericq(fx)</code></pre>
<p>The value of <span class="math inline">\(\partial{f}/\partial{y}\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = x^(y*sin(x*y))
f(v) = f(v...)
pt  = [1/2, 1/2]
fx, fy = ForwardDiff.gradient(f, pt)
numericq(fy)</code></pre>
</section>
<section id="question-7" class="level6">
<h6 class="anchored" data-anchor-id="question-7">Question</h6>
<p>Let <span class="math inline">\(z = f(x,y)\)</span> have gradient <span class="math inline">\(\langle f_x, f_y \rangle\)</span>.</p>
<p>The gradient is:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["two dimensional", "three dimensional"]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
<p>The surface is:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = ["two dimensional", "three dimensional"]
answ = 2
radioq(choices, answ, keep_order=true)</code></pre>
<p>The gradient points in the direction of greatest increase of <span class="math inline">\(f\)</span>. If a person were on a hill described by <span class="math inline">\(z=f(x,y)\)</span>, what three dimensional vector would they follow to go the steepest way up the hill?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` \langle f_x, f_y, -1 \rangle``",
    raw"`` \langle -f_x, -f_y, 1 \rangle``",
    raw"`` \langle f_x, f_y \rangle``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-8" class="level5">
<h5 class="anchored" data-anchor-id="question-8">Question</h5>
<p>The figure shows climbers on their way to summit Mt. Everest:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
imgfile = "figures/everest.png"
caption = "Climbers en route to the summit of Mt. Everest"
ImageFile(:differentiable_vector_calculus, imgfile, caption)</code></pre>
<p>If the surface of the mountain is given by a function <span class="math inline">\(z=f(x,y)\)</span> then the climbers move along a single path parameterized, say, by <span class="math inline">\(\vec{\gamma}(t) = \langle x(t), y(t)\rangle\)</span>, as set up by the Sherpas.</p>
<p>Consider the composition <span class="math inline">\((f\circ\vec\gamma)(t)\)</span>.</p>
<p>For a climber with GPS coordinates <span class="math inline">\((x,y)\)</span>. What describes her elevation?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` f(x,y)``",
    raw"`` (f\circ\vec\gamma)(x,y)``",
    raw"`` \vec\gamma(x,y)``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>A climber leaves base camp at <span class="math inline">\(t_0\)</span>. At time <span class="math inline">\(t &gt; t_0\)</span>, what describes her elevation?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` (f\circ\vec\gamma)(t)``",
    raw"`` \vec\gamma(t)``",
    raw"`` f(t)``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>What does the vector-valued function <span class="math inline">\(\vec{r}(t) = \langle x(t), y(t), (f\circ\vec\gamma(t))\rangle\)</span> describe:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "The three dimensional position of the climber",
    "The climbers gradient, pointing in the direction of greatest ascent"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>In the figure, the climbers are making a switch back, so as to avoid the steeper direct ascent. Mathematically <span class="math inline">\(\nabla{f}(\vec\gamma(t)) \cdot \vec\gamma'(t)\)</span> describes the directional derivative that they follow. Using <span class="math inline">\(\|\vec{u}\cdot\vec{v}\| = \|\vec{u}\|\|\vec{v}\|\cos(\theta)\)</span>, does this route:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    L"Keep $\cos(\theta)$ smaller than $1$, so that the slope taken is not too great",
    L"Keep $\cos(\theta)$ as close to $1$ as possible, so the slope taken is as big as possible",
    L"Keep $̧\cos(\theta)$ as close to $0$ as possible, so that they climbers don't waste energy going up and down"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Suppose our climber reaches the top at time <span class="math inline">\(t\)</span>. What would be <span class="math inline">\((f\circ\vec\gamma)'(t)\)</span>, assuming the derivative exists?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    L"It would be $0$, as the top would be maximum for $f\circ\vec\gamma$",
    L"It would be $\langle f_x, f_y\rangle$ and point towards the sky, the direction of greatest ascent",
    "It would not exist, as there would not be enough oxygen to compute it"
]
answ = 1
radioq(choices, answ)</code></pre>
<section id="question-9" class="level6">
<h6 class="anchored" data-anchor-id="question-9">Question</h6>
<p>Building sustainable hiking trails involves proper water management. Two rules of thumb are 1) the trail should not be steeper than 10 degrees 2) the outward slope (in the steepest downhill direction) should be around 5%. (A trail tread is not flat, but rather sloped downward, similar to the crown on a road, so that water will run to the downhill side of the tread, not along the tread, which would cause erosion. In the best possible world, the outslope will exceed the downward slope.)</p>
<p>Suppose a trail height is described parametrically by a composition <span class="math inline">\((f \circ \vec\gamma)(t))\)</span>, where <span class="math inline">\(\vec\gamma(t) = \langle x(t),y(t)\rangle\)</span>. The vector <span class="math inline">\(\vec{T}(t) = \langle x(t), y(t), \nabla{f}(\vec\gamma(t)) \rangle\)</span> describes the tangent to the trail at a point (<span class="math inline">\(\vec\gamma(t)\)</span>). Let <span class="math inline">\(\hat{T}(t)\)</span> be the unit normal, and <span class="math inline">\(\hat{P}(t)\)</span> be a unit normal in the direction of the <em>projection</em> of <span class="math inline">\(\vec{T}\)</span> onto the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane. (Make the third component of <span class="math inline">\(\vec{T}\)</span> <span class="math inline">\(0\)</span>, and then form a unit vector from that.)</p>
<p>What expression below captures point 1 that the steepness should be no more than 10 degrees (<span class="math inline">\(\pi/18\)</span> radians):</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
raw"`` |\hat{T} \cdot \hat{P}| \leq \cos(π/18)``",
    raw"`` |\hat{T} \cdot \hat{P}| \leq \sin(\pi/18)``",
    raw"`` |\hat{T} \cdot \hat{P}| \leq \pi/18``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>The normal to the surface <span class="math inline">\(z=f(x,y)\)</span> is <em>not</em> the normal to the trail tread. Suppose <span class="math inline">\(\vec{N}(t)\)</span> is a function that returns this. At the same point <span class="math inline">\(\vec\gamma(t)\)</span>, let <span class="math inline">\(\vec{M} = \langle -f_x, -f_y, 0\rangle\)</span> be a vector in 3 dimensions pointing downhill. Let “hats” indicate unit vectors. The outward slope is <span class="math inline">\(\pi/2\)</span> minus the angle between <span class="math inline">\(\hat{N}\)</span> and <span class="math inline">\(\hat{M}\)</span>. What condition will ensure this angle is <span class="math inline">\(5\)</span> degrees (<span class="math inline">\(\pi/36\)</span> radians)?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` |\hat{N} \cdot \hat{M}| \leq \cos(\pi/2 - π/36)``",
    raw"`` |\hat{N} \cdot \hat{M}| \leq \sin(\pi/2 - \pi/18)``",
    raw"`` |\hat{N} \cdot \hat{M}| \leq \pi/2 - \pi/18``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-10" class="level6">
<h6 class="anchored" data-anchor-id="question-10">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = x^2 \cdot(x - y^2)\)</span>. Let <span class="math inline">\(\vec{v} = \langle 1, 2\rangle\)</span>. Find the directional derivative in the direction of <span class="math inline">\(\vec{v}\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` \frac{\sqrt{5}}{5}\left(2 \cos{\left (3 \right )} - 7 \sin{\left (3 \right )}\right)``",
    raw"`` 2 \cos{\left (3 \right )} - 7 \sin{\left (3 \right )}``",
    raw"`` 4 x^{2} y \sin{\left (x - y^{2} \right )} - x^{2} \sin{\left (x - y^{2} \right )} + 2 x \cos{\left (x - y^{2} \right )}``"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-11" class="level6">
<h6 class="anchored" data-anchor-id="question-11">Question</h6>
<p>Let <span class="math inline">\(\vec{v}\)</span> be any non-zero vector. Does <span class="math inline">\(\nabla{f}(\vec{x})\cdot\vec{v}\)</span> give the rate of increase of <span class="math inline">\(f\)</span> per unit of distance in the direction of <span class="math inline">\(\vec{v}\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "Yes, by definition",
    L"No, not unless $\vec{v}$ were a unit vector"
]
answ = 2
radioq(choices, answ)</code></pre>
</section>
<section id="question-12" class="level6">
<h6 class="anchored" data-anchor-id="question-12">Question</h6>
<p>Let <span class="math inline">\(f(x,y,z) = x^4 + 2xz + 2xy + y^4\)</span> and <span class="math inline">\(\vec\gamma(t) = \langle t, t^2, t^3\rangle\)</span>. Using the chain rule, compute <span class="math inline">\((f\circ\vec\gamma)'(t)\)</span>.</p>
<p>The value of <span class="math inline">\(\nabla{f}(x,y,z)\)</span> is</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` \langle 4x^3 + 2x + 2y, 2x + 4y^3, 2x \rangle``",
    raw"`` \langle 4x^3, 2z, 2y\rangle``",
    raw"`` \langle x^3 + 2x + 2x, 2y+ y^3, 2x\rangle``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>The value of <span class="math inline">\(\vec\gamma'(t)\)</span> is:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` \langle 1, 2t, 3t^2\rangle``",
    raw"`` 1 + 2y + 3t^2``",
    raw"`` \langle 1,2, 3 \rangle``"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>The value of <span class="math inline">\((f\circ\vec\gamma)'(t)\)</span> is found by:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    L"Taking the dot product of  $\nabla{f}(\vec\gamma(t))$ and $\vec\gamma'(t)$",
    L"Taking the dot product of  $\nabla{f}(\vec\gamma'(t))$ and $\vec\gamma(t)$",
    L"Taking the dot product of  $\nabla{f}(x,y,z)$ and $\vec\gamma'(t)$"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-13" class="level6">
<h6 class="anchored" data-anchor-id="question-13">Question</h6>
<p>Let <span class="math inline">\(z = f(x,y)\)</span> be some unknown function,</p>
<p>From the figure, which drawn vector is the gradient at <span class="math inline">\((1/2, -3/4)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = 2 + x^2 - y^2
f(v) = f(v...)
pt = [1/2, -3/4]
xs = ys = range(-1, stop=1, length=50)
uvec(x) = x/norm(x)

gradf = ForwardDiff.gradient(f, pt)
surface(xs, ys, f, legend=false) #, aspect_ratio=:equal)
arrow!([pt...,0], [uvec(gradf)...,0], color=:blue, linewidth=3)
arrow!([pt...,0], [-1,0,0], color=:green, linewidth=3)
arrow!([pt..., f(pt...)], uvec([(-gradf)..., 1]), color=:red, linewidth=3)</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "The blue one",
    "The green one",
    "The red one"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>From the figure, which drawn vector is the gradient as <span class="math inline">\((1/2, -3/4)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
f(x,y) = 2 + x^2 - y^2
f(v) = f(v...)

uvec(v)=v/norm(v)
pt = [1/2, -3/4]
gradf = ForwardDiff.gradient(f, pt)
xs = ys = range(-3/2, stop=3/2, length=50)

contour(xs, ys, f, aspect_ratio=:equal)
arrow!(pt, [uvec(gradf)...], color=:blue, linewidth=3)
arrow!(pt, [-1, 0], color=:green, linewidth=3)
arrow!([0,0], pt, color=:red, linewidth=3)</code></pre>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "The blue one",
    "The green one",
    "The red one"
]
answ = 1
radioq(choices, answ)</code></pre>
</section>
<section id="question-14" class="level6">
<h6 class="anchored" data-anchor-id="question-14">Question</h6>
<p>For a function <span class="math inline">\(f(x,y)\)</span> and a point (as a vector, <span class="math inline">\(\vec{c}\)</span>) we consider this derived function:</p>
<p><span class="math display">\[
g(\vec{x}) = f(\vec{c}) + \nabla{f}(\vec{c}) \cdot(\vec{x} - \vec{c}) + \frac{1}{2}(\vec{x} - \vec{c})^tH(\vec{c})(\vec{x} - \vec{c}),
\]</span></p>
<p>where <span class="math inline">\(H(\vec{c})\)</span> is the Hessian.</p>
<p>Further, <em>suppose</em> <span class="math inline">\(\nabla{f}(\vec{c}) = \vec{0}\)</span>, so in fact:</p>
<p><span class="math display">\[
g(\vec{x}) = f(\vec{c}) + \frac{1}{2}(\vec{x} - \vec{c})^tH(\vec{c})(\vec{x} - \vec{c}).
\]</span></p>
<p>If <span class="math inline">\(f\)</span> is a linear function at <span class="math inline">\(\vec{c}\)</span>, what does this say about <span class="math inline">\(g\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    L"Linear means $H$ is the $0$ matrix, so $g(\vec{x})$ is the constant $f(\vec{c})$",
    L"Linear means $H$ is linear, so $g(\vec{x})$ describes a plane",
    L"Linear means $H$ is the $0$ matrix, so the gradient couldn't have been $\vec{0}$"
]
answ = 1
radioq(choices, answ)</code></pre>
<p>Suppose, <span class="math inline">\(H\)</span> has the magic property that for <em>any</em> vector <span class="math inline">\(\vec{v}^tH\vec{v} &lt; 0\)</span>. What does this imply:</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    L"That $g(\vec{x}) \geq f(\vec{c})$",
    L"That $g(\vec{x}) = f(\vec{c})$",
    L"That $g(\vec{x}) \leq f(\vec{c})$"
]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
</section>
<section id="question-15" class="level6">
<h6 class="anchored" data-anchor-id="question-15">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = x^3y^3\)</span>. Which partial derivative is identically <span class="math inline">\(0\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` \partial^4{f}/\partial{x^4}``",
    raw"`` \partial^4{f}/\partial{x^3}\partial{y}``",
    raw"`` \partial^4{f}/\partial{x^2}\partial{y^2}``",
    raw"`` \partial^4{f}/\partial{x^1}\partial{y^3}``"
]
answ = 1
radioq(choices, answ, keep_order=true)</code></pre>
</section>
<section id="question-16" class="level6">
<h6 class="anchored" data-anchor-id="question-16">Question</h6>
<p>Let <span class="math inline">\(f(x,y) = 3x^2 y\)</span>.</p>
<p>Which value is greater at the point <span class="math inline">\((1/2,2)\)</span>?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    raw"`` f_x``",
    raw"`` f_y``",
    raw"`` f_{xx}``",
    raw"`` f_{xy}``",
    raw"`` f_{yy}``"
]
x,y=1/2, 2
val, answ = findmax([6x*y, 3x^2, 6*y, 6x, 0])
radioq(choices, answ, keep_order=true)</code></pre>
</section>
<section id="question-17" class="level6">
<h6 class="anchored" data-anchor-id="question-17">Question</h6>
<p>The order of partial derivatives matters if the mixed partials are not continuous. Take</p>
<p><span class="math display">\[
f(x,y) = \frac{xy ( x^2 - y^2)}{x^2 + y^2}, \quad f(0,0) = 0
\]</span></p>
<p>Using the definition of the derivative from a limit, we have</p>
<p><span class="math display">\[
\frac{\partial \frac{\partial f}{\partial x}}{ \partial y} =
\lim_{\Delta y \rightarrow 0} \lim_{\Delta x \rightarrow 0}
\frac{f(x+\Delta x, y + \Delta y) - f(x, y+\Delta{y}) - f(x+\Delta x,y) + f(x,y)}{\Delta x \Delta y}.
\]</span></p>
<p>Whereas,</p>
<p><span class="math display">\[
\frac{\partial \frac{\partial f}{\partial y}}{ \partial x} =
\lim_{\Delta x \rightarrow 0} \lim_{\Delta y \rightarrow 0}
\frac{f(x+\Delta x, y + \Delta y) - f(x, y+\Delta{y}) - f(x+\Delta x,y) + f(x,y)}{\Delta x \Delta y}.
\]</span></p>
<p>At <span class="math inline">\((0,0)\)</span> what is $ $?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
answ = -1
numericq(answ)</code></pre>
<p>At <span class="math inline">\((0,0)\)</span> what is $ $?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
answ = 1
numericq(answ)</code></pre>
<p>Away from <span class="math inline">\((0,0)\)</span> the mixed partial is <span class="math inline">\(\frac{x^{6} + 9 x^{4} y^{2} - 9 x^{2} y^{4} - y^{6}}{x^{6} + 3 x^{4} y^{2} + 3 x^{2} y^{4} + y^{6}}\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
choices = [
    "As this is the ratio of continuous functions, it is continuous at the origin",
    L"This is not continuous at $(0,0)$, still the limit along the two paths $x=0$ and $y=0$ are equivalent.",
    L"This is not continuous at $(0,0)$, as the limit along the two paths $x=0$ and $y=0$ are not equivalent."
]
answ = 3
radioq(choices, answ)</code></pre>
</section>
<section id="question-18" class="level6">
<h6 class="anchored" data-anchor-id="question-18">Question</h6>
<p><a href="http://www.math.harvard.edu/~knill/teaching/summer2018/handouts/week3.pdf">Knill</a>. Clairaut’s theorem is the name given to the fact that if the partial derivatives are continuous, the mixed partials are equal, <span class="math inline">\(f_{xy} = f_{yx}\)</span>.</p>
<p>Consider the following code which computes the mixed partials for the discrete derivative:</p>
<pre class="{julia}"><code>#| hold: true
@syms x::real y::real Δ::real G()

Dx(f,h) = (subs(f, x=&gt;x+h) - f)/h
Dy(f,h) = (subs(f, y=&gt;y+h) - f)/h

Dy(Dx(G(x,y), Δ), Δ) - Dx(Dy(G(x,y), Δ), Δ)</code></pre>
<p>What does this simplify to?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
numericq(0)</code></pre>
<p>Is continuity required for this to be true?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
yesnoq(false)</code></pre>
</section>
<section id="question-19" class="level6">
<h6 class="anchored" data-anchor-id="question-19">Question</h6>
<p>(Examples and descriptions from Krill)</p>
<p>What equation does the function <span class="math inline">\(f(x,y) = x^3 - 3xy^2\)</span> satisfy?</p>
<pre class="{julia}"><code>#| echo: false
# 4 questions, don't edit this order!
ode_choices = [
L"The wave equation: $f_{tt} = f_{xx}$; governs motion of light or sound",
L"The heat equation: $f_t = f_{xx}$; describes diffusion of heat",
L"The Laplace equation: $f_{xx} + f_{yy} = 0$; determines shape of a membrane",
L"The advection equation: $f_t = f_x$; is used to model transport in a wire",
L"The eiconal equation: $f_x^2 + f_y^2 = 1$; is used to model evolution of a wave front in optics",
L"The Burgers equation: $f_t + ff_x = f_{xx}$; describes waves at the beach which break",
L"The KdV equation: $f_t + 6ff_x+ f_{xxx} = 0$; models water waves in a narrow channel",
L"The Schrodinger equation: $f_t = (i\hbar/(2m))f_xx$; used to describe a quantum particle of mass $m$"
]
answ′ = 3
radioq(ode_choices, answ′, keep_order=true)</code></pre>
<p>What equation does the function <span class="math inline">\(f(t, x) = sin(x-t) + sin(x+t)\)</span> satisfy?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
answ = 1
radioq(ode_choices, answ, keep_order=true)</code></pre>
<p>What equation does the function <span class="math inline">\(f(t, x) = e^{-(x+t)^2}\)</span> satisfy?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
answ = 4
radioq(ode_choices, answ, keep_order=true)</code></pre>
<p>What equation does the function <span class="math inline">\(f(x,y) = \cos(x) + \sin(y)\)</span> satisfy?</p>
<pre class="{julia}"><code>#| hold: true
#| echo: false
answ = 5
radioq(ode_choices, answ, keep_order=true)</code></pre>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>