<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 58&nbsp; 2D and 3D plots in Julia with Plots</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../integral_vector_calculus.html" rel="next">
<link href="../differentiable_vector_calculus/vector_fields.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#parametrically-described-curves-in-space" id="toc-parametrically-described-curves-in-space" class="nav-link active" data-scroll-target="#parametrically-described-curves-in-space"><span class="toc-section-number">58.1</span>  Parametrically described curves in space</a>
  <ul class="collapse">
  <li><a href="#plotting-a-space-curve-in-3-dimensions" id="toc-plotting-a-space-curve-in-3-dimensions" class="nav-link" data-scroll-target="#plotting-a-space-curve-in-3-dimensions"><span class="toc-section-number">58.1.1</span>  Plotting a space curve in 3 dimensions</a></li>
  <li><a href="#adding-a-vector" id="toc-adding-a-vector" class="nav-link" data-scroll-target="#adding-a-vector"><span class="toc-section-number">58.1.2</span>  Adding a vector</a></li>
  <li><a href="#setting-a-viewing-angle-for-3d-plots" id="toc-setting-a-viewing-angle-for-3d-plots" class="nav-link" data-scroll-target="#setting-a-viewing-angle-for-3d-plots"><span class="toc-section-number">58.1.3</span>  Setting a viewing angle for 3D plots</a></li>
  </ul></li>
  <li><a href="#visualizing-functions-from-r2-rightarrow-r" id="toc-visualizing-functions-from-r2-rightarrow-r" class="nav-link" data-scroll-target="#visualizing-functions-from-r2-rightarrow-r"><span class="toc-section-number">58.2</span>  Visualizing functions from <span class="math inline">\(R^2 \rightarrow R\)</span></a>
  <ul class="collapse">
  <li><a href="#contour-plots" id="toc-contour-plots" class="nav-link" data-scroll-target="#contour-plots"><span class="toc-section-number">58.2.1</span>  Contour plots</a></li>
  <li><a href="#combining-surface-plots-and-contour-plots" id="toc-combining-surface-plots-and-contour-plots" class="nav-link" data-scroll-target="#combining-surface-plots-and-contour-plots"><span class="toc-section-number">58.2.2</span>  Combining surface plots and contour plots</a></li>
  <li><a href="#gradient-and-surface-plots" id="toc-gradient-and-surface-plots" class="nav-link" data-scroll-target="#gradient-and-surface-plots"><span class="toc-section-number">58.2.3</span>  Gradient and surface plots</a></li>
  <li><a href="#the-tangent-plane" id="toc-the-tangent-plane" class="nav-link" data-scroll-target="#the-tangent-plane"><span class="toc-section-number">58.2.4</span>  The tangent plane</a></li>
  <li><a href="#parameterized-surface-plots" id="toc-parameterized-surface-plots" class="nav-link" data-scroll-target="#parameterized-surface-plots"><span class="toc-section-number">58.2.5</span>  Parameterized surface plots</a></li>
  <li><a href="#plotting-fxy-z-c" id="toc-plotting-fxy-z-c" class="nav-link" data-scroll-target="#plotting-fxy-z-c"><span class="toc-section-number">58.2.6</span>  Plotting F(x,y, z) = c</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/differentiable_vector_calculus/plots_plotting.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>This section uses these add-on packages:</p>
<pre class="{julia}"><code>using CalculusWithJulia
using Plots
import Contour: contours, levels, level, lines, coordinates
using LinearAlgebra
using ForwardDiff</code></pre>
<pre class="{julia}"><code>#| echo: false
#| results: "hidden"
using CalculusWithJulia.WeaveSupport
frontmatter = (
    title = "2D and 3D plots in Julia with Plots",
    description = "Calculus with Julia: 2D and 3D plots in Julia with Plots",
    tags = ["CalculusWithJulia", "differentiable_vector_calculus", "2d and 3d plots in julia with plots"],
);
nothing</code></pre>
<hr>
<p>This covers plotting the typical 2D and 3D plots in Julia with the <code>Plots</code> package.</p>
<p>We will make use of some helper functions that will simplify plotting provided by the <code>CalculusWithJulia</code> package. As well, we will need to manipulate contours directly, so pull in the <code>Contours</code> package, using <code>import</code> to avoid name collisions and explicitly listing the methods we will use.</p>
<section id="parametrically-described-curves-in-space" class="level2" data-number="58.1">
<h2 data-number="58.1" class="anchored" data-anchor-id="parametrically-described-curves-in-space"><span class="header-section-number">58.1</span> Parametrically described curves in space</h2>
<p>Let <span class="math inline">\(r(t)\)</span> be a vector-valued function with values in <span class="math inline">\(R^d\)</span>, <span class="math inline">\(d\)</span> being <span class="math inline">\(2\)</span> or <span class="math inline">\(3\)</span>. A familiar example is the equation for a line that travels in the direction of <span class="math inline">\(\vec{v}\)</span> and goes through the point <span class="math inline">\(P\)</span>: <span class="math inline">\(r(t) = P + t \cdot \vec{v}\)</span>. A <em>parametric plot</em> over <span class="math inline">\([a,b]\)</span> is the collection of all points <span class="math inline">\(r(t)\)</span> for <span class="math inline">\(a \leq t \leq b\)</span>.</p>
<p>In <code>Plots</code>, parameterized curves can be plotted through two interfaces, here illustrated for <span class="math inline">\(d=2\)</span>: <code>plot(f1, f2, a, b)</code> or <code>plot(xs, ys)</code>. The former is convenient for some cases, but typically we will have a function <code>r(t)</code> which is vector-valued, as opposed to a vector of functions. As such, we only discuss the latter.</p>
<p>An example helps illustrate. Suppose <span class="math inline">\(r(t) = \langle \sin(t), 2\cos(t) \rangle\)</span> and the goal is to plot the full ellipse by plotting over <span class="math inline">\(0 \leq t \leq 2\pi\)</span>. As with plotting of curves, the goal would be to take many points between <code>a</code> and <code>b</code> and from there generate the <span class="math inline">\(x\)</span> values and <span class="math inline">\(y\)</span> values.</p>
<p>Let’s see this with 5 points, the first and last being identical due to the curve:</p>
<pre class="{julia}"><code>r₂(t) = [sin(t), 2cos(t)]
ts = range(0, stop=2pi, length=5)</code></pre>
<p>Then we can create the <span class="math inline">\(5\)</span> points easily through broadcasting:</p>
<pre class="{julia}"><code>vs = r₂.(ts)</code></pre>
<p>This returns a vector of points (stored as vectors). The plotting function wants two collections: the set of <span class="math inline">\(x\)</span> values for the points and the set of <span class="math inline">\(y\)</span> values. The data needs to be generated differently or reshaped. The function <code>unzip</code> above takes data in this style and returns the desired format, returning a tuple with the <span class="math inline">\(x\)</span> values and <span class="math inline">\(y\)</span> values pulled out:</p>
<pre class="{julia}"><code>unzip(vs)</code></pre>
<p>To plot this, we “splat” the tuple so that <code>plot</code> gets the arguments separately:</p>
<pre class="{julia}"><code>plot(unzip(vs)...)</code></pre>
<p>This basic plot is lacking, of course, as there are not enough points. Using more initially is a remedy.</p>
<pre class="{julia}"><code>#| hold: true
ts = range(0, 2pi, length=100)
plot(unzip(r₂.(ts))...)</code></pre>
<p>As a convenience, <code>CalculusWithJulia</code> provides <code>plot_parametric</code> to produce this plot. The interval is specified with the <code>a..b</code> notation of <code>IntervalSets</code> (which is available when the <code>CalculusWithJulia</code> package is loaded), the points to plot are adaptively chosen:</p>
<pre class="{julia}"><code>plot_parametric(0..2pi, r₂)  # interval first</code></pre>
<section id="plotting-a-space-curve-in-3-dimensions" class="level3" data-number="58.1.1">
<h3 data-number="58.1.1" class="anchored" data-anchor-id="plotting-a-space-curve-in-3-dimensions"><span class="header-section-number">58.1.1</span> Plotting a space curve in 3 dimensions</h3>
<p>A parametrically described curve in 3D is similarly created. For example, a helix is described mathematically by <span class="math inline">\(r(t) = \langle \sin(t), \cos(t), t \rangle\)</span>. Here we graph two turns:</p>
<pre class="{julia}"><code>r₃(t) = [sin(t), cos(t), t]
plot_parametric(0..4pi, r₃)</code></pre>
</section>
<section id="adding-a-vector" class="level3" data-number="58.1.2">
<h3 data-number="58.1.2" class="anchored" data-anchor-id="adding-a-vector"><span class="header-section-number">58.1.2</span> Adding a vector</h3>
<p>The tangent vector indicates the instantaneous direction one would travel were they walking along the space curve. We can add a tangent vector to the graph. The <code>quiver!</code> function would be used to add a 2D vector, but <code>Plots</code> does not currently have a <code>3D</code> analog. In addition, <code>quiver!</code> has a somewhat cumbersome calling pattern when adding just one vector. The <code>CalculusWithJulia</code> package defines an <code>arrow!</code> function that uses <code>quiver</code> for 2D arrows and a simple line for 3D arrows. As a vector incorporates magnitude and direction, but not a position, <code>arrow!</code> needs both a point for the position and a vector.</p>
<p>Here is how we can visualize the tangent vector at a few points on the helix:</p>
<pre class="{julia}"><code>#| hold: true
plot_parametric(0..4pi, r₃, legend=false)
ts = range(0, 4pi, length=5)
for t in ts
   arrow!(r₃(t), r₃'(t))
end</code></pre>
<pre class="{julia}"><code>#| echo: false
note("""Adding many arrows this way would be inefficient.""")</code></pre>
</section>
<section id="setting-a-viewing-angle-for-3d-plots" class="level3" data-number="58.1.3">
<h3 data-number="58.1.3" class="anchored" data-anchor-id="setting-a-viewing-angle-for-3d-plots"><span class="header-section-number">58.1.3</span> Setting a viewing angle for 3D plots</h3>
<p>For 3D plots, the viewing angle can make the difference in visualizing the key features. In <code>Plots</code>, some backends allow the viewing angle to be set with the mouse by clicking and dragging. Not all do. For such, the <code>camera</code> argument is used, as in <code>camera(azimuthal, elevation)</code> where the angles are given in degrees. If the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span>-<span class="math inline">\(z\)</span> coorinates are given, then <code>elevation</code> or <em>inclination</em>, is the angle between the <span class="math inline">\(z\)</span> axis and the <span class="math inline">\(x-y\)</span> plane (so <code>90</code> is a top view) and <code>azimuthal</code> is the angle in the <span class="math inline">\(x-y\)</span> plane from the <span class="math inline">\(x\)</span> axes.</p>
</section>
</section>
<section id="visualizing-functions-from-r2-rightarrow-r" class="level2" data-number="58.2">
<h2 data-number="58.2" class="anchored" data-anchor-id="visualizing-functions-from-r2-rightarrow-r"><span class="header-section-number">58.2</span> Visualizing functions from <span class="math inline">\(R^2 \rightarrow R\)</span></h2>
<p>If a function <span class="math inline">\(f: R^2 \rightarrow R\)</span> then a graph of <span class="math inline">\((x,y,f(x,y))\)</span> can be represented in 3D. It will form a surface. Such graphs can be most simply made by specifying a set of <span class="math inline">\(x\)</span> values, a set of <span class="math inline">\(y\)</span> values and a function <span class="math inline">\(f\)</span>, as with:</p>
<pre class="{julia}"><code>xs = range(-2, stop=2, length=100)
ys = range(-pi, stop=pi, length=100)
f(x,y) = x*sin(y)
surface(xs, ys, f)</code></pre>
<p>Rather than pass in a function, values can be passed in. Here they are generated with a list comprehension. The <code>y</code> values are innermost to match the graphic when passing in a function object:</p>
<pre class="{julia}"><code>#| hold: true
zs = [f(x,y) for y in ys, x in xs]
surface(xs, ys, zs)</code></pre>
<p>Remembering if the <code>ys</code> or <code>xs</code> go first in the above can be hard. Alternatively, broadcasting can be used. The command <code>f.(xs,ys)</code> would return a vector, as the <code>xs</code> and <code>ys</code> match in shape–they are both column vectors. But the <em>transpose</em> of <code>xs</code> looks like a <em>row</em> vector and <code>ys</code> looks like a column vector, so broadcasting will create a matrix of values, as desired here:</p>
<pre class="{julia}"><code>surface(xs, ys, f.(xs', ys))</code></pre>
<p>This graph shows the tessalation algorithm. Here only the grid in the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane is just one cell:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-1, 1, length=2)
f(x,y) = x*y
surface(xs, ys, f)</code></pre>
<p>A more accurate graph, can be seen here:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-1, 1, length=100)
f(x,y) = x*y
surface(xs, ys, f)</code></pre>
<section id="contour-plots" class="level3" data-number="58.2.1">
<h3 data-number="58.2.1" class="anchored" data-anchor-id="contour-plots"><span class="header-section-number">58.2.1</span> Contour plots</h3>
<p>Returning to the</p>
<p>The contour plot of <span class="math inline">\(f:R^2 \rightarrow R\)</span> draws level curves, <span class="math inline">\(f(x,y)=c\)</span>, for different values of <span class="math inline">\(c\)</span> in the <span class="math inline">\(x-y\)</span> plane. They are produced in a similar manner as the surface plots:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-2,2, length=100)
f(x,y) = x*y
contour(xs, ys, f)</code></pre>
<p>The cross in the middle corresponds to <span class="math inline">\(c=0\)</span>, as when <span class="math inline">\(x=0\)</span> or <span class="math inline">\(y=0\)</span> then <span class="math inline">\(f(x,y)=0\)</span>.</p>
<p>Similarly, computed values for <span class="math inline">\(f(x,y)\)</span> can be passed in. Here we change the function:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - (x^2 + y^2)
xs = ys = range(-2,2, length=100)

zs = [f(x,y) for y in ys, x in xs]

contour(xs, ys, zs)</code></pre>
<p>The chosen levels can be specified by the user through the <code>levels</code> argument, as in:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - (x^2 + y^2)
xs = ys = range(-2,2, length=100)

zs = [f(x,y) for y in ys, x in xs]

contour(xs, ys, zs, levels = [-1.0, 0.0, 1.0])</code></pre>
<p>If only a single level is desired, as scalar value can be specified. Though not with all backends for <code>Plots</code>. For example, this next graphic shows the <span class="math inline">\(0\)</span>-level of the <a href="http://www-groups.dcs.st-and.ac.uk/~history/Curves/Devils.html">devil</a>’s curve.</p>
<pre class="{julia}"><code>#| hold: true
a, b = -1, 2
f(x,y) = y^4 - x^4 + a*y^2 + b*x^2
xs = ys = range(-5, stop=5, length=100)
contour(xs, ys, f, levels=[0.0])</code></pre>
<p>Contour plots are well known from the presence of contour lines on many maps. Contour lines indicate constant elevations. A peak is characterized by a series of nested closed paths. The following graph shows this for the peak at <span class="math inline">\((x,y)=(0,0)\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-pi/2, stop=pi/2, length=100)
f(x,y) = sinc(sqrt(x^2 + y^2))   # sinc(x) is sin(x)/x
contour(xs, ys, f)</code></pre>
<p>Contour plots can be filled with colors through the <code>contourf</code> function:</p>
<pre class="{julia}"><code>#| hold: true
xs = ys = range(-pi/2, stop=pi/2, length=100)
f(x,y) = sinc(sqrt(x^2 + y^2))

contourf(xs, ys, f)</code></pre>
</section>
<section id="combining-surface-plots-and-contour-plots" class="level3" data-number="58.2.2">
<h3 data-number="58.2.2" class="anchored" data-anchor-id="combining-surface-plots-and-contour-plots"><span class="header-section-number">58.2.2</span> Combining surface plots and contour plots</h3>
<p>In <code>PyPlot</code> it is possible to add a contour lines to the surface, or projected onto an axis. To replicate something similar, though not as satisfying, in <code>Plots</code> we use the <code>Contour</code> package.</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 + x^2 + y^2
xs = ys = range(-2, stop=2, length=100)
zs = [f(x,y) for y in ys, x in xs]

p = surface(xs, ys, zs, legend=false, fillalpha=0.5)

## we add to the graphic p, then plot
for cl in levels(contours(xs, ys, zs))
    lvl = level(cl) # the z-value of this contour level
    for line in lines(cl)
        _xs, _ys = coordinates(line) # coordinates of this line segment
        _zs = 0 * _xs
        plot!(p, _xs, _ys, lvl .+ _zs, alpha=0.5) # add on surface
        plot!(p, _xs, _ys, _zs, alpha=0.5)        # add on x-y plane
    end
end
p</code></pre>
<p>There is no hidden line calculuation, in place we give the contour lines a transparency through the argument <code>alpha=0.5</code>.</p>
</section>
<section id="gradient-and-surface-plots" class="level3" data-number="58.2.3">
<h3 data-number="58.2.3" class="anchored" data-anchor-id="gradient-and-surface-plots"><span class="header-section-number">58.2.3</span> Gradient and surface plots</h3>
<p>The surface plot of <span class="math inline">\(f: R^2 \rightarrow R\)</span> plots <span class="math inline">\((x, y, f(x,y))\)</span> as a surface. The <em>gradient</em> of <span class="math inline">\(f\)</span> is <span class="math inline">\(\langle \partial f/\partial x, \partial f/\partial y\rangle\)</span>. It is a two-dimensional object indicating the direction at a point <span class="math inline">\((x,y)\)</span> where the surface has the greatest ascent. Illurating the gradient and the surface on the same plot requires embedding the 2D gradient into the 3D surface. This can be done by adding a constant <span class="math inline">\(z\)</span> value to the gradient, such as <span class="math inline">\(0\)</span>.</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - (x^2 + y^2)
xs = ys = range(-2, stop=2, length=100)
zs = [f(x,y) for y in ys, x in xs]

surface(xs, ys, zs, camera=(40, 25), legend=false)
p = [-1, 1] # in the region graphed, [-2,2] × [-2, 2]

f(x) = f(x...)
v = ForwardDiff.gradient(f, p)


# add 0 to p and v (two styles)
push!(p, -15)
scatter!(unzip([p])..., markersize=3)

v = vcat(v, 0)
arrow!(p, v)</code></pre>
</section>
<section id="the-tangent-plane" class="level3" data-number="58.2.4">
<h3 data-number="58.2.4" class="anchored" data-anchor-id="the-tangent-plane"><span class="header-section-number">58.2.4</span> The tangent plane</h3>
<p>Let <span class="math inline">\(z = f(x,y)\)</span> describe a surface, and <span class="math inline">\(F(x,y,z) = f(x,y) - z\)</span>. The the gradient of <span class="math inline">\(F\)</span> at a point <span class="math inline">\(p\)</span> on the surface, <span class="math inline">\(\nabla F(p)\)</span>, will be normal to the surface and for a function, <span class="math inline">\(f(p) + \nabla f \cdot (x-p)\)</span> describes the tangent plane. We can visualize each, as follows:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y) = 2 - x^2 - y^2
f(v) = f(v...)
F(x,y,z) = z - f(x,y)
F(v) = F(v...)
p = [1/10, -1/10]
global p1 = vcat(p, f(p...)) # note F(p1) == 0
global n⃗ = ForwardDiff.gradient(F, p1)
global tl(x) = f(p) +  ForwardDiff.gradient(f, p) ⋅ (x - p)
tl(x,y) = tl([x,y])

xs = ys = range(-2, stop=2, length=100)
surface(xs, ys, f)
surface!(xs, ys, tl)
arrow!(p1, 5n⃗)</code></pre>
<p>From some viewing angles, the normal does not look perpendicular to the tangent plane. This is a quick verification for a randomly chosen point in the <span class="math inline">\(x-y\)</span> plane:</p>
<pre class="{julia}"><code>a, b = randn(2)
dot(n⃗, (p1 - [a,b, tl(a,b)]))</code></pre>
</section>
<section id="parameterized-surface-plots" class="level3" data-number="58.2.5">
<h3 data-number="58.2.5" class="anchored" data-anchor-id="parameterized-surface-plots"><span class="header-section-number">58.2.5</span> Parameterized surface plots</h3>
<p>As illustrated, we can plot surfaces of the form <span class="math inline">\((x,y,f(x,y)\)</span>. However, not all surfaces are so readily described. For example, if <span class="math inline">\(F(x,y,z)\)</span> is a function from <span class="math inline">\(R^3 \rightarrow R\)</span>, then <span class="math inline">\(F(x,y,z)=c\)</span> is a surface of interest. For example, the sphere of radius one is a solution to <span class="math inline">\(F(x,y,z)=1\)</span> where <span class="math inline">\(F(x,y,z) = x^2 + y^2 + z^2\)</span>.</p>
<p>Plotting such generally described surfaces is not so easy, but <em>parameterized</em> surfaces can be represented. For example, the sphere as a surface is not represented as a surface of a function, but can be represented in spherical coordinates as parameterized by two angles, essentially an “azimuth” and and “elevation”, as used with the <code>camera</code> argument.</p>
<p>Here we define functions that represent <span class="math inline">\((x,y,z)\)</span> coordinates in terms of the corresponding spherical coordinates <span class="math inline">\((r, \theta, \phi)\)</span>.</p>
<pre class="{julia}"><code># spherical: (radius r, inclination θ, azimuth φ)
X(r,theta,phi) = r * sin(theta) * sin(phi)
Y(r,theta,phi) = r * sin(theta) * cos(phi)
Z(r,theta,phi) = r * cos(theta)</code></pre>
<p>We can parameterize the sphere by plotting values for <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> produced by a sequence of values for <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>, holding <span class="math inline">\(r=1\)</span>:</p>
<pre class="{julia}"><code>#| hold: true
thetas = range(0, stop=pi,   length=50)
phis   = range(0, stop=pi/2, length=50)

xs = [X(1, theta, phi) for theta in thetas, phi in phis]
ys = [Y(1, theta, phi) for theta in thetas, phi in phis]
zs = [Z(1, theta, phi) for theta in thetas, phi in phis]

surface(xs, ys, zs)</code></pre>
<pre class="{julia}"><code>#| echo: false
note("The above may not work with all backends for `Plots`, even if those that support 3D graphics.")</code></pre>
<p>For convenience, the <code>plot_parametric</code> function from <code>CalculusWithJulia</code> can produce these plots using interval notation, <code>a..b</code>, and a function:</p>
<pre class="{julia}"><code>#| hold: true
F(theta, phi) = [X(1, theta, phi), Y(1, theta, phi), Z(1, theta, phi)]
plot_parametric(0..pi, 0..pi/2, F)</code></pre>
</section>
<section id="plotting-fxy-z-c" class="level3" data-number="58.2.6">
<h3 data-number="58.2.6" class="anchored" data-anchor-id="plotting-fxy-z-c"><span class="header-section-number">58.2.6</span> Plotting F(x,y, z) = c</h3>
<p>There is no built in functionality in <code>Plots</code> to create surface described by <span class="math inline">\(F(x,y,z) = c\)</span>. An example of how to provide some such functionality for <code>PyPlot</code> appears <a href="https://stackoverflow.com/questions/4680525/plotting-implicit-equations-in-3d">here</a>. The non-exported <code>plot_implicit_surface</code> function can be used to approximate this.</p>
<p>To use it, we see what happens when a sphere if rendered:</p>
<pre class="{julia}"><code>#| hold: true
f(x,y,z) = x^2 + y^2 + z^2 - 25
CalculusWithJulia.plot_implicit_surface(f)</code></pre>
<p>This figure comes from a February 14, 2019 article in the <a href="https://www.nytimes.com/2019/02/14/science/math-algorithm-valentine.html">New York Times</a>. It shows an equation for a “heart,” as the graphic will illustrate:</p>
<pre class="{julia}"><code>#| hold: true
a,b = 1,3
f(x,y,z) = (x^2+((1+b)*y)^2+z^2-1)^3-x^2*z^3-a*y^2*z^3
CalculusWithJulia.plot_implicit_surface(f, xlim=-2..2, ylim=-1..1, zlim=-1..2)</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../differentiable_vector_calculus/vector_fields.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../integral_vector_calculus.html" class="pagination-link">
        <span class="nav-page-text">Integral vector calculus</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>