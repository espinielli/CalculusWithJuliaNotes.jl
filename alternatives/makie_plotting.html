<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 67&nbsp; Calculus plots with Makie</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../misc/getting_started_with_julia.html" rel="next">
<link href="../alternatives/plotly_plotting.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#figures" id="toc-figures" class="nav-link active" data-scroll-target="#figures"><span class="toc-section-number">67.1</span>  Figures</a></li>
  <li><a href="#points-scatter" id="toc-points-scatter" class="nav-link" data-scroll-target="#points-scatter"><span class="toc-section-number">67.2</span>  Points (<code>scatter</code>)</a>
  <ul class="collapse">
  <li><a href="#point2-point3" id="toc-point2-point3" class="nav-link" data-scroll-target="#point2-point3"><span class="toc-section-number">67.2.1</span>  <code>Point2</code>, <code>Point3</code></a></li>
  <li><a href="#attributes" id="toc-attributes" class="nav-link" data-scroll-target="#attributes"><span class="toc-section-number">67.2.2</span>  Attributes</a></li>
  </ul></li>
  <li><a href="#curves" id="toc-curves" class="nav-link" data-scroll-target="#curves"><span class="toc-section-number">67.3</span>  Curves</a>
  <ul class="collapse">
  <li><a href="#plots-of-univariate-functions" id="toc-plots-of-univariate-functions" class="nav-link" data-scroll-target="#plots-of-univariate-functions"><span class="toc-section-number">67.3.1</span>  Plots of univariate functions</a></li>
  <li><a href="#text-annotations" id="toc-text-annotations" class="nav-link" data-scroll-target="#text-annotations"><span class="toc-section-number">67.3.2</span>  Text (<code>annotations</code>)</a></li>
  <li><a href="#plots-of-parametric-functions" id="toc-plots-of-parametric-functions" class="nav-link" data-scroll-target="#plots-of-parametric-functions"><span class="toc-section-number">67.3.3</span>  Plots of parametric functions</a></li>
  </ul></li>
  <li><a href="#surfaces" id="toc-surfaces" class="nav-link" data-scroll-target="#surfaces"><span class="toc-section-number">67.4</span>  Surfaces</a></li>
  <li><a href="#contour-plots-contour-contourf-heatmap" id="toc-contour-plots-contour-contourf-heatmap" class="nav-link" data-scroll-target="#contour-plots-contour-contourf-heatmap"><span class="toc-section-number">67.5</span>  Contour plots (<code>contour</code>, <code>contourf</code>, <code>heatmap</code>)</a>
  <ul class="collapse">
  <li><a href="#three-dimensional-contour-plots" id="toc-three-dimensional-contour-plots" class="nav-link" data-scroll-target="#three-dimensional-contour-plots"><span class="toc-section-number">67.5.1</span>  Three dimensional contour plots</a></li>
  <li><a href="#implicitly-defined-curves-and-surfaces" id="toc-implicitly-defined-curves-and-surfaces" class="nav-link" data-scroll-target="#implicitly-defined-curves-and-surfaces"><span class="toc-section-number">67.5.2</span>  Implicitly defined curves and surfaces</a></li>
  </ul></li>
  <li><a href="#vector-fields.-visualizations-of-fr2-rightarrow-r2" id="toc-vector-fields.-visualizations-of-fr2-rightarrow-r2" class="nav-link" data-scroll-target="#vector-fields.-visualizations-of-fr2-rightarrow-r2"><span class="toc-section-number">67.6</span>  Vector fields. Visualizations of <span class="math inline">\(f:R^2 \rightarrow R^2\)</span></a></li>
  <li><a href="#layoutables-and-observables" id="toc-layoutables-and-observables" class="nav-link" data-scroll-target="#layoutables-and-observables"><span class="toc-section-number">67.7</span>  Layoutables and Observables</a>
  <ul class="collapse">
  <li><a href="#layoutables" id="toc-layoutables" class="nav-link" data-scroll-target="#layoutables"><span class="toc-section-number">67.7.1</span>  Layoutables</a></li>
  <li><a href="#observables" id="toc-observables" class="nav-link" data-scroll-target="#observables"><span class="toc-section-number">67.7.2</span>  Observables</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/alternatives/makie_plotting.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<pre class="{julia}"><code>#| echo: false

import Logging
Logging.disable_logging(Logging.Info) # or e.g. Logging.Info
Logging.disable_logging(Logging.Warn)

import SymPy
function Base.show(io::IO, ::MIME"text/html", x::T) where {T &lt;: SymPy.SymbolicObject}
    println(io, "&lt;span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"&gt; ")
    println(io, "\\[")
    println(io, sympy.latex(x))
    println(io, "\\]")
    println(io, "&lt;/span&gt;")
end

# hack to work around issue
import Markdown
import CalculusWithJulia
function CalculusWithJulia.WeaveSupport.ImageFile(d::Symbol, f::AbstractString, caption; kwargs...)
    nm = joinpath("..", string(d), f)
    u = "![$caption]($nm)"
    Markdown.parse(u)
end

nothing</code></pre>
<p>The <a href="https://github.com/JuliaPlots/Makie.jl">Makie.jl webpage</a> says</p>
<blockquote class="blockquote">
<p>From the Japanese word Maki-e, which is a technique to sprinkle lacquer with gold and silver powder. Data is basically the gold and silver of our age, so let’s spread it out beautifully on the screen!</p>
</blockquote>
<p><code>Makie</code> itself is a metapackage for a rich ecosystem. We show how to use the interface provided by the <code>GLMakie</code> backend to produce the familiar graphics of calculus.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Examples and tutorials
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>Makie</code> is a sophisticated plotting package, and capable of an enormous range of plots (cf.&nbsp;<a href="https://makie.juliaplots.org/stable/examples/plotting_functions/">examples</a>.) <code>Makie</code> also has numerous <a href="https://makie.juliaplots.org/stable/tutorials/">tutorials</a> to learn from. These are far more extensive that what is described herein, as this section focuses just on the graphics from calculus.</p>
</div>
</div>
<section id="figures" class="level2" data-number="67.1">
<h2 data-number="67.1" class="anchored" data-anchor-id="figures"><span class="header-section-number">67.1</span> Figures</h2>
<p>Makie draws graphics onto a canvas termed a “scene” in the Makie documentation. A scene is an implementation detail, the basic (non-mutating) plotting commands described below return a <code>FigureAxisPlot</code> object, a compound object that combines a figure, an axes, and a plot object. The <code>show</code> method for these objects display the figure.</p>
<p>For <code>Makie</code> there are the <code>GLMakie</code>, <code>WGLMakie</code>, and <code>CairoMakie</code> backends for different types of canvases. In the following, we have used <code>GLMakie</code>. <code>WGLMakie</code> is useful for incorporating <code>Makie</code> plots into web-based technologies.</p>
<p>We begin by loading the main package and the <code>norm</code> function from the standard <code>LinearAlgebra</code> package:</p>
<pre class="{julia}"><code>using GLMakie
import LinearAlgebra: norm
</code></pre>
<p>The <code>Makie</code> developers have workarounds for the delayed time to first plot, but without utilizing these the time to load the package is lengthy.</p>
</section>
<section id="points-scatter" class="level2" data-number="67.2">
<h2 data-number="67.2" class="anchored" data-anchor-id="points-scatter"><span class="header-section-number">67.2</span> Points (<code>scatter</code>)</h2>
<p>The task of plotting the points, say <span class="math inline">\((1,2)\)</span>, <span class="math inline">\((2,3)\)</span>, <span class="math inline">\((3,2)\)</span> can be done different ways. Most plotting packages, and <code>Makie</code> is no exception, allow the following: form vectors of the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values then plot those with <code>scatter</code>:</p>
<pre class="{julia}"><code>xs = [1,2,3]
ys = [2,3,2]
scatter(xs, ys)</code></pre>
<p>The <code>scatter</code> function creates and returns an object, which when displayed shows the plot.</p>
<section id="point2-point3" class="level3" data-number="67.2.1">
<h3 data-number="67.2.1" class="anchored" data-anchor-id="point2-point3"><span class="header-section-number">67.2.1</span> <code>Point2</code>, <code>Point3</code></h3>
<p>When learning about points on the Cartesian plane, a “<code>t</code>”-chart is often produced:</p>
<pre><code>x | y
-----
1 | 2
2 | 3
3 | 2</code></pre>
<p>The <code>scatter</code> usage above used the columns. The rows are associated with the points, and these too can be used to produce the same graphic. Rather than make vectors of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> (and optionally <span class="math inline">\(z\)</span>) coordinates, it is more idiomatic to create a vector of “points.” <code>Makie</code> utilizes a <code>Point</code> type to store a 2 or 3 dimensional point. The <code>Point2</code> and <code>Point3</code> constructors will be utilized.</p>
<p><code>Makie</code> uses a GPU, when present, to accelerate the graphic rendering. GPUs employ 32-bit numbers. Julia uses an <code>f0</code> to indicate 32-bit floating points. Hence the alternate types <code>Point2f0</code> to store 2D points as 32-bit numbers and <code>Points3f0</code> to store 3D points as 32-bit numbers are seen in the documentation for Makie.</p>
<p>We can plot a vector of points in as direct manner as vectors of their coordinates:</p>
<pre class="{julia}"><code>pts = [Point2(1,2), Point2(2,3), Point2(3,2)]
scatter(pts)</code></pre>
<p>A typical usage is to generate points from some vector-valued function. Say we have a parameterized function <code>r</code> taking <span class="math inline">\(R\)</span> into <span class="math inline">\(R^2\)</span> defined by:</p>
<pre class="{julia}"><code>r(t) = [sin(t), cos(t)]</code></pre>
<p>Then broadcasting values gives a vector of vectors, each identified with a point:</p>
<pre class="{julia}"><code>ts = [1,2,3]
r.(ts)</code></pre>
<p>We can broadcast <code>Point2</code> over this to create a vector of <code>Point</code> objects:</p>
<pre class="{julia}"><code>pts = Point2.(r.(ts))</code></pre>
<p>These then can be plotted directly:</p>
<pre class="{julia}"><code>scatter(pts)</code></pre>
<p>The ploting of points in three dimesions is essentially the same, save the use of <code>Point3</code> instead of <code>Point2</code>.</p>
<pre class="{julia}"><code>r(t) = [sin(t), cos(t), t]
ts = range(0, 4pi, length=100)
pts = Point3.(r.(ts))
scatter(pts; markersize=5)</code></pre>
<hr>
<p>To plot points generated in terms of vectors of coordinates, the component vectors must be created. The “<code>t</code>”-table shows how, simply loop over each column and add the corresponding <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> (or <span class="math inline">\(z\)</span>) value. This utility function does exactly that, returning the vectors in a tuple.</p>
<pre class="{julia}"><code>unzip(vs) = Tuple([vs[j][i] for j in eachindex(vs)] for i in eachindex(vs[1]))</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the <code>CalculusWithJulia</code> package, <code>unzip</code> is implemented using <code>SplitApplyCombine.invert</code>.</p>
</div>
</div>
<p>We might have then:</p>
<pre class="{julia}"><code>scatter(unzip(r.(ts))...; markersize=5)</code></pre>
<p>where splatting is used to specify the <code>xs</code>, <code>ys</code>, and <code>zs</code> to <code>scatter</code>.</p>
<p>(Compare to <code>scatter(Point3.(r.(ts)))</code> or <code>scatter(Point3∘r).(ts))</code>.)</p>
</section>
<section id="attributes" class="level3" data-number="67.2.2">
<h3 data-number="67.2.2" class="anchored" data-anchor-id="attributes"><span class="header-section-number">67.2.2</span> Attributes</h3>
<p>A point is drawn with a “marker” with a certain size and color. These attributes can be adjusted, as in the following:</p>
<pre class="{julia}"><code>scatter(xs, ys;
        marker=[:x,:cross, :circle], markersize=25,
        color=:blue)</code></pre>
<p>Marker attributes include</p>
<ul>
<li><code>marker</code> a symbol, shape.</li>
<li><code>marker_offset</code> offset coordinates</li>
<li><code>markersize</code> size (radius pixels) of marker</li>
</ul>
<p>A single value will be repeated. A vector of values of a matching size will specify the attribute on a per point basis.</p>
</section>
</section>
<section id="curves" class="level2" data-number="67.3">
<h2 data-number="67.3" class="anchored" data-anchor-id="curves"><span class="header-section-number">67.3</span> Curves</h2>
<p>The curves of calculus are lines. The <code>lines</code> command of <code>Makie</code> will render a curve by connecting a series of points with straight-line segments. By taking a sufficient number of points the connect-the-dot figure can appear curved.</p>
<section id="plots-of-univariate-functions" class="level3" data-number="67.3.1">
<h3 data-number="67.3.1" class="anchored" data-anchor-id="plots-of-univariate-functions"><span class="header-section-number">67.3.1</span> Plots of univariate functions</h3>
<p>The basic plot of univariate calculus is the graph of a function <span class="math inline">\(f\)</span> over an interval <span class="math inline">\([a,b]\)</span>. This is implemented using a familiar strategy: produce a series of representative values between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>; produce the corresponding <span class="math inline">\(f(x)\)</span> values; plot these as points and connect the points with straight lines.</p>
<p>To create regular values between <code>a</code> and <code>b</code> typically the <code>range</code> function or the range operator (<code>a:h:b</code>) are employed. The the related <code>LinRange</code> function is also an option.</p>
<p>For example:</p>
<pre class="{julia}"><code>f(x) = sin(x)
a, b = 0, 2pi
xs = range(a, b, length=250)
lines(xs, f.(xs))</code></pre>
<p><code>Makie</code> also will read the interval notation of <code>IntervalSets</code> and select its own set of intermediate points:</p>
<pre class="{julia}"><code>lines(a..b, f)</code></pre>
<p>As with <code>scatter</code>, <code>lines</code> returns an object that produces a graphic when displayed.</p>
<p>As with <code>scatter</code>, <code>lines</code> can can also be drawn using a vector of points:</p>
<pre class="{julia}"><code>pts = [Point2(x, f(x)) for x ∈ xs]
lines(pts)</code></pre>
<p>(Though the advantage isn’t clear here, this will be useful when the points are generated in different manners.)</p>
<p>When a <code>y</code> value is <code>NaN</code> or infinite, the connecting lines are not drawn:</p>
<pre class="{julia}"><code>xs = 1:5
ys = [1,2,NaN, 4, 5]
lines(xs, ys)</code></pre>
<p>As with other plotting packages, this is useful to represent discontinuous functions, such as what occurs at a vertical asymptote or a step function.</p>
<section id="adding-to-a-figure-lines-scatter" class="level4">
<h4 class="anchored" data-anchor-id="adding-to-a-figure-lines-scatter">Adding to a figure (<code>lines!</code>, <code>scatter!</code>, …)</h4>
<p>To <em>add</em> or <em>modify</em> a scene can be done using a mutating version of a plotting primitive, such as <code>lines!</code> or <code>scatter!</code>. The names follow <code>Julia</code>’s convention of using an <code>!</code> to indicate that a function modifies an argument, in this case the underlying figure.</p>
<p>Here is one way to show two plots at once:</p>
<pre class="{julia}"><code>xs = range(0, 2pi, length=100)
lines(xs, sin.(xs))
lines!(xs, cos.(xs))
current_figure()</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Current figure
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>current_figure</code> call is needed to have the figure display, as the returned value of <code>lines!</code> is not a figure object. (Figure objects display when shown as the output of a cell.)</p>
</div>
</div>
<p>We will see soon how to modify the line attributes so that the curves can be distinguished.</p>
<p>The following shows the construction details in the graphic:</p>
<pre class="{julia}"><code>xs = range(0, 2pi, length=10)
lines(xs, sin.(xs))
scatter!(xs, sin.(xs);
         markersize=10)
current_figure()</code></pre>
<p>As an example, this shows how to add the tangent line to a graph. The slope of the tangent line being computed by <code>ForwardDiff.derivative</code>.</p>
<pre class="{julia}"><code>import ForwardDiff
f(x) = x^x
a, b= 0, 2
c = 0.5
xs = range(a, b, length=200)

tl(x) = f(c) + ForwardDiff.derivative(f, c) * (x-c)

lines(xs, f.(xs))
lines!(xs, tl.(xs), color=:blue)
current_figure()</code></pre>
<p>This example, modified from a <a href="https://discourse.julialang.org/t/how-to-plot-step-functions-x-correctly-in-julia/84087/5">discourse</a> post by user <code>@rafael.guerra</code>, shows how to plot a step function (<code>floor</code>) using <code>NaN</code>s to create line breaks. The marker colors set for <code>scatter!</code> use <code>:white</code> to match the background color.</p>
<pre class="{julia}"><code>x = -5:5
δ = 5eps() # for rounding purposes; our interval is [i,i+1) ≈ [i, i+1-δ]
xx = Float64[]
for i ∈ x[1:end-1]
    append!(xx, (i, i+1 - δ, NaN))
end
yy = floor.(xx)

lines(xx, yy)
scatter!(xx, yy, color=repeat([:black, :white, :white], length(xx)÷3))

current_figure()</code></pre>
</section>
</section>
<section id="text-annotations" class="level3" data-number="67.3.2">
<h3 data-number="67.3.2" class="anchored" data-anchor-id="text-annotations"><span class="header-section-number">67.3.2</span> Text (<code>annotations</code>)</h3>
<p>Text can be placed at a point, as a marker is. To place text, the desired text and a position need to be specified along with any adjustments to the default attributes.</p>
<p>For example:</p>
<pre class="{julia}"><code>xs = 1:5
pts = Point2.(xs, xs)
scatter(pts)
annotations!("Point " .* string.(xs), pts;
             textsize = 50 .- 2*xs,
             rotation = 2pi ./ xs)

current_figure()</code></pre>
<p>The graphic shows that <code>textsize</code> adjusts the displayed size and <code>rotation</code> adjusts the orientation. (The graphic also shows a need to manually override the limits of the <code>y</code> axis, as the <code>Point 5</code> is chopped off; the <code>ylims!</code> function to do so will be shown later.)</p>
<p>Attributes for <code>text</code>, among many others, include:</p>
<ul>
<li><code>align</code> Specify the text alignment through <code>(:pos, :pos)</code>, where <code>:pos</code> can be <code>:left</code>, <code>:center</code>, or <code>:right</code>.</li>
<li><code>rotation</code> to indicate how the text is to be rotated</li>
<li><code>textsize</code> the font point size for the text</li>
<li><code>font</code> to indicate the desired font</li>
</ul>
<section id="line-attributes" class="level4">
<h4 class="anchored" data-anchor-id="line-attributes">Line attributes</h4>
<p>In a previous example, we added the argument <code>color=:blue</code> to the <code>lines!</code> call. This was to set an attribute for the line being drawn. Lines have other attributes that allow different ones to be distinguished, as above where colors indicate the different graphs.</p>
<p>Other attributes can be seen from the help page for <code>lines</code>, and include:</p>
<ul>
<li><code>color</code> set with a symbol, as above, or a string</li>
<li><code>label</code> a label for the line to display in a legend</li>
<li><code>linestyle</code> available styles are set by a symbol, one of <code>:dash</code>, <code>:dot</code>, <code>:dashdot</code>, or <code>:dashdotdot</code>.</li>
<li><code>linewidth</code> width of line</li>
<li><code>transparency</code> the <code>alpha</code> value, a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, smaller numbers for more transparent.</li>
</ul>
</section>
<section id="simple-legends" class="level4">
<h4 class="anchored" data-anchor-id="simple-legends">Simple legends</h4>
<p>A simple legend displaying labels given to each curve can be produced by <code>axislegend</code>. For example:</p>
<pre class="{julia}"><code>xs = 0..pi
lines(xs, x -&gt; sin(x^2), label="sin(x^2)")
lines!(xs, x -&gt; sin(x)^2, label = "sin(x)^2")
axislegend()

current_figure()</code></pre>
<p>Later, we will see how to control the placement of a legend within a figure.</p>
</section>
<section id="titles-axis-labels-axis-ticks" class="level4">
<h4 class="anchored" data-anchor-id="titles-axis-labels-axis-ticks">Titles, axis labels, axis ticks</h4>
<p>The basic plots we have seen are of type <code>FigureAxisPlot</code>. The “axis” part controls attributes of the plot such as titles, labels, tick positions, etc. These values can be set in different manners. On construction we can pass values to a named argument <code>axis</code> using a named tuple.</p>
<p>For example:</p>
<pre class="{julia}"><code>xs = 0..2pi
lines(xs, sin;
      axis=(title="Plot of sin(x)", xlabel="x", ylabel="sin(x)")
      )</code></pre>
<p>To access the <code>axis</code> element of a plot <strong>after</strong> the plot is constructed, values can be assigned to the <code>axis</code> property of the <code>FigureAxisPlot</code> object. For example:</p>
<pre class="{julia}"><code>xs = 0..2pi
p = lines(xs, sin;
          axis=(title="Plot of sin(x)", xlabel="x", ylabel="sin(x)")
          )
p.axis.xticks = MultiplesTicks(5, pi, "π") # label 5 times using `pi`

current_figure()</code></pre>
<p>The ticks are most easily set as a collection of values. Above, the <code>MultiplesTicks</code> function was used to label with multiples of <span class="math inline">\(\pi\)</span>.</p>
<p>Later we will discuss how <code>Makie</code> allows for subsequent modification of several parts of the plot (not just the ticks) including the data.</p>
</section>
<section id="figure-resolution-x-and-y-limits" class="level4">
<h4 class="anchored" data-anchor-id="figure-resolution-x-and-y-limits">Figure resolution, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> limits</h4>
<p>As just mentioned, the basic plots we have seen are of type <code>FigureAxisPlot</code>. The “figure” part can be used to adjust the background color or the resolution. As with attributes for the axis, these too can be passed to a simple constructor:</p>
<pre class="{julia}"><code>lines(xs, sin;
      axis=(title="Plot of sin(x)", xlabel="x", ylabel="sin(x)"),
      figure=(;resolution=(300, 300))
      )</code></pre>
<p>The <code>;</code> in the tuple passed to <code>figure</code> is one way to create a <em>named</em> tuple with a single element. Alternatively, <code>(resolution=(300,300), )</code> – with a trailing comma – could have been used.</p>
<p>To set the limits of the graph there are shorthand functions <code>xlims!</code>, <code>ylims!</code>, and <code>zlims!</code>. This might prove useful if vertical asymptotes are encountered, as in this example:</p>
<pre class="{julia}"><code>f(x) = 1/x
a,b = -1, 1
xs = range(-1, 1, length=200)
lines(xs, f.(xs))
ylims!(-10, 10)

current_figure()</code></pre>
<p>This still leaves the artifact due to the vertical asymptote at <span class="math inline">\(0\)</span> having different values from the left and the right.</p>
</section>
</section>
<section id="plots-of-parametric-functions" class="level3" data-number="67.3.3">
<h3 data-number="67.3.3" class="anchored" data-anchor-id="plots-of-parametric-functions"><span class="header-section-number">67.3.3</span> Plots of parametric functions</h3>
<p>A space curve is a plot of a function <span class="math inline">\(f:R^2 \rightarrow R\)</span> or <span class="math inline">\(f:R^3 \rightarrow R\)</span>.</p>
<p>To construct a curve from a set of points, we have a similar pattern in both <span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span> dimensions:</p>
<pre class="{julia}"><code>r(t) = [sin(2t), cos(3t)]
ts = range(0, 2pi, length=200)
pts = Point2.(r.(ts))  # or (Point2∘r).(ts)
lines(pts)</code></pre>
<p>Or</p>
<pre class="{julia}"><code>r(t) = [sin(2t), cos(3t), t]
ts = range(0, 2pi, length=200)
pts = Point3.(r.(ts))
lines(pts)</code></pre>
<p>Alternatively, vectors of the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> components can be produced and then plotted using the pattern <code>lines(xs, ys)</code> or <code>lines(xs, ys, zs)</code>. For example, using <code>unzip</code>, as above, we might have done the prior example with:</p>
<pre class="{julia}"><code>xs, ys, zs = unzip(r.(ts))
lines(xs, ys, zs)</code></pre>
<section id="aspect-ratio" class="level4">
<h4 class="anchored" data-anchor-id="aspect-ratio">Aspect ratio</h4>
<p>A simple plot of a parametrically defined circle will show an ellipse, as the aspect ratio of the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis is not <span class="math inline">\(1\)</span>. To enforce this, we can pass a value of <code>aspect=1</code> to the underlying “Axis” object. For example:</p>
<pre class="{julia}"><code>ts = range(0, 2pi, length=100)
xs, ys = sin.(ts), cos.(ts)
lines(xs, ys; axis=(; aspect = 1))</code></pre>
</section>
<section id="tangent-vectors-arrows" class="level4">
<h4 class="anchored" data-anchor-id="tangent-vectors-arrows">Tangent vectors (<code>arrows</code>)</h4>
<p>A tangent vector along a curve can be drawn quite easily using the <code>arrows</code> function. There are different interfaces for <code>arrows</code>, but we show the one which uses a vector of positions and a vector of “vectors”. For the latter, we utilize the <code>derivative</code> function from <code>ForwardDiff</code>:</p>
<pre class="{julia}"><code>r(t) = [sin(t), cos(t)] # vector, not tuple
ts = range(0, 4pi, length=200)
lines(Point2.(r.(ts)))

nts = 0:pi/4:2pi
us = r.(nts)
dus = ForwardDiff.derivative.(r, nts)

arrows!(Point2.(us), Point2.(dus))

current_figure()</code></pre>
<p>In 3 dimensions the differences are minor:</p>
<pre class="{julia}"><code>r(t) = [sin(t), cos(t), t] # vector, not tuple
ts = range(0, 4pi, length=200)
lines(Point3.(r.(ts)))

nts = 0:pi/2:(4pi-pi/2)
us = r.(nts)
dus = ForwardDiff.derivative.(r, nts)

arrows!(Point3.(us), Point3.(dus))

current_figure()</code></pre>
</section>
<section id="arrow-attributes" class="level4">
<h4 class="anchored" data-anchor-id="arrow-attributes">Arrow attributes</h4>
<p>Attributes for <code>arrows</code> include</p>
<ul>
<li><code>arrowsize</code> to adjust the size</li>
<li><code>lengthscale</code> to scale the size</li>
<li><code>arrowcolor</code> to set the color</li>
<li><code>arrowhead</code> to adjust the head</li>
<li><code>arrowtail</code> to adjust the tail</li>
</ul>
</section>
</section>
</section>
<section id="surfaces" class="level2" data-number="67.4">
<h2 data-number="67.4" class="anchored" data-anchor-id="surfaces"><span class="header-section-number">67.4</span> Surfaces</h2>
<p>Plots of surfaces in <span class="math inline">\(3\)</span> dimensions are useful to help understand the behavior of multivariate functions.</p>
<section id="surfaces-defined-through-zfxy" class="level4">
<h4 class="anchored" data-anchor-id="surfaces-defined-through-zfxy">Surfaces defined through <span class="math inline">\(z=f(x,y)\)</span></h4>
<p>The “<code>peaks</code>” function defined below has a few prominent peaks:</p>
<pre class="{julia}"><code>function peaks(x, y)
    p = 3*(1-x)^2*exp(-x^2 - (y+1)^2)
    p -= 10(x/5-x^3-y^5)*exp(-x^2-y^2)
    p -= 1/3*exp(-(x+1)^2-y^2)
    p
end</code></pre>
<p>Here we see how <code>peaks</code> can be visualized over the region <span class="math inline">\([-5,5]\times[-5,5]\)</span>:</p>
<pre class="{julia}"><code>xs = ys = range(-5, 5, length=25)
surface(xs, ys, peaks)</code></pre>
<p>The calling pattern <code>surface(xs, ys, f)</code> implies a rectangular grid over the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> plane defined by <code>xs</code> and <code>ys</code> with <span class="math inline">\(z\)</span> values given by <span class="math inline">\(f(x,y)\)</span>.</p>
<p>Alternatively a “matrix” of <span class="math inline">\(z\)</span> values can be specified. For a function <code>f</code>, this is conveniently generated by the pattern <code>f.(xs, ys')</code>, the <code>'</code> being important to get a matrix of all <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> pairs through <code>Julia</code>’s broadcasting syntax.</p>
<pre class="{julia}"><code>zs = peaks.(xs, ys')
surface(xs, ys, zs)</code></pre>
<p>To see how this graph is constructed, the points <span class="math inline">\((x,y,f(x,y))\)</span> are plotted over the grid and displayed.</p>
<p>Here we downsample to illustrate:</p>
<pre class="{julia}"><code>xs = ys = range(-5, 5, length=5)
pts = [Point3(x, y, peaks(x,y)) for x in xs for y in ys]
scatter(pts, markersize=25)</code></pre>
<p>These points are then connected. The <code>wireframe</code> function illustrates just the frame:</p>
<pre class="{julia}"><code>wireframe(xs, ys, peaks.(xs, ys'); linewidth=5)</code></pre>
<p>The <code>surface</code> call triangulates the frame and fills in the shading:</p>
<pre class="{julia}"><code>surface!(xs, ys, peaks.(xs, ys'))
current_figure()</code></pre>
</section>
<section id="parametrically-defined-surfaces" class="level4">
<h4 class="anchored" data-anchor-id="parametrically-defined-surfaces">Parametrically defined surfaces</h4>
<p>A surface may be parametrically defined through a function <span class="math inline">\(r(u,v) = (x(u,v), y(u,v), z(u,v))\)</span>. For example, the surface generated by <span class="math inline">\(z=f(x,y)\)</span> is of the form with <span class="math inline">\(r(u,v) = (u,v,f(u,v))\)</span>.</p>
<p>The <code>surface</code> function and the <code>wireframe</code> function can be used to display such surfaces. In previous usages, the <code>x</code> and <code>y</code> values were vectors from which a 2-dimensional grid is formed. For parametric surfaces, a grid for the <code>x</code> and <code>y</code> values must be generated. This function will do so:</p>
<pre class="{julia}"><code>function parametric_grid(us, vs, r)
    n,m = length(us), length(vs)
    xs, ys, zs = zeros(n,m), zeros(n,m), zeros(n,m)
    for (i, uᵢ) in pairs(us)
        for (j, vⱼ) in pairs(vs)
            x,y,z = r(uᵢ, vⱼ)
            xs[i,j] = x
            ys[i,j] = y
            zs[i,j] = z
        end
    end
    (xs, ys, zs)
end</code></pre>
<p>With the data suitably massaged, we can directly plot either a <code>surface</code> or <code>wireframe</code> plot.</p>
<hr>
<p>As an aside, The above can be done more campactly with nested list comprehensions:</p>
<pre><code>xs, ys, zs = [[pt[i] for pt in r.(us, vs')] for i in 1:3]</code></pre>
<p>Or using the <code>unzip</code> function directly after broadcasting:</p>
<pre><code>xs, ys, zs = unzip(r.(us, vs'))</code></pre>
<hr>
<p>For example, a sphere can be parameterized by <span class="math inline">\(r(u,v) = (\sin(u)\cos(v), \sin(u)\sin(v), \cos(u))\)</span> and visualized through:</p>
<pre class="{julia}"><code>r(u,v) = [sin(u)*cos(v), sin(u)*sin(v), cos(u)]
us = range(0, pi, length=25)
vs = range(0, pi/2, length=25)
xs, ys, zs = parametric_grid(us, vs, r)

surface(xs, ys, zs)
wireframe!(xs, ys, zs)
current_figure()</code></pre>
<p>A surface of revolution for <span class="math inline">\(g(u)\)</span> revolved about the <span class="math inline">\(z\)</span> axis can be visualized through:</p>
<pre class="{julia}"><code>g(u) = u^2 * exp(-u)
r(u,v) = (g(u)*sin(v), g(u)*cos(v), u)
us = range(0, 3, length=10)
vs = range(0, 2pi, length=10)
xs, ys, zs = parametric_grid(us, vs, r)

surface(xs, ys, zs)
wireframe!(xs, ys, zs)
current_figure()</code></pre>
<p>A torus with big radius <span class="math inline">\(2\)</span> and inner radius <span class="math inline">\(1/2\)</span> can be visualized as follows</p>
<pre class="{julia}"><code>r1, r2 = 2, 1/2
r(u,v) = ((r1 + r2*cos(v))*cos(u), (r1 + r2*cos(v))*sin(u), r2*sin(v))
us = vs = range(0, 2pi, length=25)
xs, ys, zs = parametric_grid(us, vs, r)

surface(xs, ys, zs)
wireframe!(xs, ys, zs)
current_figure()</code></pre>
<p>A Möbius strip can be produced with:</p>
<pre class="{julia}"><code>ws = range(-1/4, 1/4, length=8)
thetas = range(0, 2pi, length=30)
r(w, θ) = ((1+w*cos(θ/2))*cos(θ), (1+w*cos(θ/2))*sin(θ), w*sin(θ/2))
xs, ys, zs = parametric_grid(ws, thetas, r)

surface(xs, ys, zs)
wireframe!(xs, ys, zs)
current_figure()</code></pre>
</section>
</section>
<section id="contour-plots-contour-contourf-heatmap" class="level2" data-number="67.5">
<h2 data-number="67.5" class="anchored" data-anchor-id="contour-plots-contour-contourf-heatmap"><span class="header-section-number">67.5</span> Contour plots (<code>contour</code>, <code>contourf</code>, <code>heatmap</code>)</h2>
<p>For a function <span class="math inline">\(z = f(x,y)\)</span> an alternative to a surface plot, is a contour plot. That is, for different values of <span class="math inline">\(c\)</span> the level curves <span class="math inline">\(f(x,y)=c\)</span> are drawn.</p>
<p>For a function <span class="math inline">\(f(x,y)\)</span>, the syntax for generating a contour plot follows that for <code>surface</code>.</p>
<p>For example, using the <code>peaks</code> function, previously defined, we have a contour plot over the region <span class="math inline">\([-5,5]\times[-5,5]\)</span> is generated through:</p>
<pre class="{julia}"><code>xs = ys = range(-5, 5, length=100)
contour(xs, ys, peaks)</code></pre>
<p>The default of <span class="math inline">\(5\)</span> levels can be adjusted using the <code>levels</code> keyword:</p>
<pre class="{julia}"><code>contour(xs, ys, peaks; levels = 20)</code></pre>
<p>The <code>levels</code> argument can also specify precisely what levels are to be drawn.</p>
<p>The contour graph makes identification of peaks and valleys easy as the limits of patterns of nested contour lines.</p>
<p>A <em>filled</em> contour plot is produced by <code>contourf</code>:</p>
<pre class="{julia}"><code>contourf(xs, ys, peaks)</code></pre>
<p>A related, but alternative visualization, using color to represent magnitude is a heatmap, produced by the <code>heatmap</code> function. The calling syntax is similar to <code>contour</code> and <code>surface</code>:</p>
<pre class="{julia}"><code>heatmap(xs, ys, peaks)</code></pre>
<p>This graph shows peaks and valleys through “hotspots” on the graph.</p>
<p>The <code>MakieGallery</code> package includes an example of a surface plot with both a wireframe and 2D contour graph added. It is replicated here using the <code>peaks</code> function scaled by <span class="math inline">\(5\)</span>.</p>
<p>The function and domain to plot are described by:</p>
<pre class="{julia}"><code>xs = ys = range(-5, 5, length=51)
zs = peaks.(xs, ys') / 5;</code></pre>
<p>The <code>zs</code> were generated, as <code>wireframe</code> does not provide the interface for passing a function.</p>
<p>The <code>surface</code> and <code>wireframe</code> are produced as follows. Here we manually create the figure and axis object so that we can set the viewing angle through the <code>elevation</code> argument to the axis object:</p>
<pre class="{julia}"><code>fig = Figure()
ax3 = Axis3(fig[1,1];
            elevation=pi/9, azimuth=pi/16)
surface!(ax3, xs, ys, zs)
wireframe!(ax3, xs, ys, zs;
           overdraw = true, transparency = true,
           color = (:black, 0.1))
current_figure()</code></pre>
<p>To add the contour, a simple call via <code>contour!(scene, xs, ys, zs)</code> will place the contour at the <span class="math inline">\(z=0\)</span> level which will make it hard to read. Rather, placing at the “bottom” of the figure is desirable. To identify that the minimum value, is identified (and rounded) and the argument <code>transformation = (:xy, zmin)</code> is passed to <code>contour!</code>:</p>
<pre class="{julia}"><code>ezs = extrema(zs)
zmin, zmax = floor(first(ezs)), ceil(last(ezs))
contour!(ax3, xs, ys, zs;
         levels = 15, linewidth = 2,
         transformation = (:xy, zmin))
zlims!(zmin, zmax)
current_figure()</code></pre>
<p>The <code>transformation</code> plot attribute sets the “plane” (one of <code>:xy</code>, <code>:yz</code>, or <code>:xz</code>) at a location, in this example <code>zmin</code>.</p>
<p>The manual construction of a figure and an axis object will be further discussed later.</p>
<section id="three-dimensional-contour-plots" class="level3" data-number="67.5.1">
<h3 data-number="67.5.1" class="anchored" data-anchor-id="three-dimensional-contour-plots"><span class="header-section-number">67.5.1</span> Three dimensional contour plots</h3>
<p>The <code>contour</code> function can also plot <span class="math inline">\(3\)</span>-dimensional contour plots. Concentric spheres, contours of <span class="math inline">\(x^2 + y^2 + z^2 = c\)</span> for <span class="math inline">\(c &gt; 0\)</span> are presented by the following:</p>
<pre class="{julia}"><code>f(x,y,z) = x^2 + y^2 + z^2
xs = ys = zs = range(-3, 3, length=100)

contour(xs, ys, zs, f)</code></pre>
</section>
<section id="implicitly-defined-curves-and-surfaces" class="level3" data-number="67.5.2">
<h3 data-number="67.5.2" class="anchored" data-anchor-id="implicitly-defined-curves-and-surfaces"><span class="header-section-number">67.5.2</span> Implicitly defined curves and surfaces</h3>
<p>Suppose <span class="math inline">\(f\)</span> is a scalar-valued function. If <code>f</code> takes two variables for its input, then the equation <span class="math inline">\(f(x,y) = 0\)</span> implicitly defines <span class="math inline">\(y\)</span> as a function of <span class="math inline">\(x\)</span>; <span class="math inline">\(y\)</span> can be visualized <em>locally</em> with a curve. If <span class="math inline">\(f\)</span> takes three variables for its input, then the equation <span class="math inline">\(f(x,y,z)=0\)</span> implicitly defines <span class="math inline">\(z\)</span> as a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>; <span class="math inline">\(z\)</span> can be visualized <em>locally</em> with a surface.</p>
<section id="implicitly-defined-curves" class="level4">
<h4 class="anchored" data-anchor-id="implicitly-defined-curves">Implicitly defined curves</h4>
<p>The graph of an equation is the collection of all <span class="math inline">\((x,y)\)</span> values satisfying the equation. This is more general than the graph of a function, which can be viewed as the graph of the equation <span class="math inline">\(y=f(x)\)</span>. An equation in <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> can be graphed if the set of solutions to a related equation <span class="math inline">\(f(x,y)=0\)</span> can be identified, as one can move all terms to one side of an equation and define <span class="math inline">\(f\)</span> as the rule of the side with the terms. The implicit function theorem ensures that under some conditions, <em>locally</em> near a point <span class="math inline">\((x, y)\)</span>, the value <span class="math inline">\(y\)</span> can be represented as a function of <span class="math inline">\(x\)</span>. So, the graph of the equation <span class="math inline">\(f(x,y)=0\)</span> can be produced by stitching together these local function representations.</p>
<p>The contour graph can produce these graphs by setting the <code>levels</code> argument to <code>[0]</code>.</p>
<pre class="{julia}"><code>f(x,y) = x^3 + x^2 + x + 1 - x*y        # solve x^3 + x^2 + x + 1 = x*y
xs = range(-5, 5, length=100)
ys = range(-10, 10, length=100)

contour(xs, ys, f.(xs, ys'); levels=[0])</code></pre>
<p>The <code>implicitPlots.jl</code> function uses the <code>Contour</code> package along with a <code>Plots</code> recipe to plot such graphs. Here we see how to use <code>Makie</code> in a similar manner:</p>
<pre class="{julia}"><code>#| eval: false
import Contour

function implicit_plot(xs, ys, f; kwargs...)
    fig = Figure()
    ax = Axis(fig[1,1])
    implicit_plot!(ax, xs, ys, f; kwargs...)
    fig
end

function implicit_plot!(ax, xs, ys, f; kwargs...)
    z = [f(x, y) for x in xs, y in ys]
    cs = Contour.contour(collect(xs), collect(ys), z, 0.0)
    ls = Contour.lines(cs)

    isempty(ls) &amp;&amp; error("empty")

    for l ∈ ls
        us, vs = Contour.coordinates(l)
        lines!(ax, us, vs; kwargs...)
    end

end</code></pre>
</section>
<section id="implicitly-defined-surfaces-fxyz0" class="level4">
<h4 class="anchored" data-anchor-id="implicitly-defined-surfaces-fxyz0">Implicitly defined surfaces, <span class="math inline">\(F(x,y,z)=0\)</span></h4>
<p>To plot the equation <span class="math inline">\(F(x,y,z)=0\)</span>, for <span class="math inline">\(F\)</span> a scalar-valued function, again the implicit function theorem says that, under conditions, near any solution <span class="math inline">\((x,y,z)\)</span>, <span class="math inline">\(z\)</span> can be represented as a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, so the graph will look likes surfaces stitched together. The <code>Implicit3DPlotting</code> package takes an approach like <code>ImplicitPlots</code> to represent these surfaces. It replaces the <code>Contour</code> package computation with a <span class="math inline">\(3\)</span>-dimensional alternative provided through the <code>Meshing</code> and <code>GeometryBasics</code> packages.</p>
<p>The <code>Implicit3DPlotting</code> package needs some maintenance, so we borrow the main functionality and wrap it into a function:</p>
<pre class="{julia}"><code>import Meshing
import GeometryBasics

function make_mesh(xlims, ylims, zlims, f,
                   M = Meshing.MarchingCubes(); # or  Meshing.MarchingTetrahedra()
                   samples=(35, 35, 35),
                   )

    lims = extrema.((xlims, ylims, zlims))
    Δ = xs -&gt; last(xs) - first(xs)
    xs = Vec(first.(lims))
    Δxs = Vec(Δ.(lims))

    GeometryBasics.Mesh(f, Rect(xs, Δxs), M; samples = samples)
end</code></pre>
<p>The <code>make_mesh</code> function creates a mesh that can be visualized with the <code>wireframe</code> or <code>mesh</code> plotting functions.</p>
<p>This example, plotting an implicitly defined sphere, comes from the documentation of <code>Implicit3DPlotting</code>. The <code>f</code> in <code>make_mesh</code> is a scalar-valued function of a vector:</p>
<pre class="{julia}"><code>f(x) = sum(x.^2) - 1
xs = ys = zs = (-5, 5)
m = make_mesh(xs, ys, zs, f)
wireframe(m)</code></pre>
<p>Here we visualize an intersection of a sphere with another figure:</p>
<pre class="{julia}"><code>r₂(x) = sum(x.^2) - 5/4 # a sphere
r₄(x) = sum(x.^4) - 1
xs = ys = zs = -2:2
m2,m4 = make_mesh(xs, ys, zs, r₂), make_mesh(xs, ys, zs, r₄)

wireframe(m4, color=:yellow)
wireframe!(m2, color=:red)
current_figure()</code></pre>
<p>This example comes from <a href="https://en.wikipedia.org/wiki/Implicit_surface">Wikipedia</a> showing an implicit surface of genus <span class="math inline">\(2\)</span>:</p>
<pre class="{julia}"><code>f(x,y,z) = 2y*(y^2 -3x^2)*(1-z^2) + (x^2 +y^2)^2 - (9z^2-1)*(1-z^2)
zs = ys = xs = range(-5/2, 5/2, length=100)
m = make_mesh(xs, ys, zs, x -&gt; f(x...))
wireframe(m)</code></pre>
<p>(This figure does not render well through <code>contour(xs, ys, zs, f, levels=[0])</code>, as the hole is not shown.)</p>
<p>For one last example from Wikipedia, we have the Cassini oval which “can be defined as the point set for which the <em>product</em> of the distances to <span class="math inline">\(n\)</span> given points is constant.” That is:</p>
<pre class="{julia}"><code>function cassini(λ, ps = ((1,0,0), (-1, 0, 0)))
    n = length(ps)
    x -&gt; prod(norm(x .- p) for p ∈ ps) - λ^n
end
xs = ys = zs = range(-2, 2, length=100)
m = make_mesh(xs, ys, zs, cassini(1.05))
wireframe(m)</code></pre>
</section>
</section>
</section>
<section id="vector-fields.-visualizations-of-fr2-rightarrow-r2" class="level2" data-number="67.6">
<h2 data-number="67.6" class="anchored" data-anchor-id="vector-fields.-visualizations-of-fr2-rightarrow-r2"><span class="header-section-number">67.6</span> Vector fields. Visualizations of <span class="math inline">\(f:R^2 \rightarrow R^2\)</span></h2>
<p>The vector field <span class="math inline">\(f(x,y) = \langle y, -x \rangle\)</span> can be visualized as a set of vectors, <span class="math inline">\(f(x,y)\)</span>, positioned at a grid. These arrows can be visualized with the <code>arrows</code> function. The <code>arrows</code> function is passed a vector of points for the anchors and a vector of points representing the vectors.</p>
<p>We can generate these on a regular grid through:</p>
<pre class="{julia}"><code>f(x, y) = [y, -x]
xs = ys = -5:5
pts = vec(Point2.(xs, ys'))
dus = vec(Point2.(f.(xs, ys')));
first(pts), first(dus)  # show an example</code></pre>
<p>Broadcasting over <code>(xs, ys')</code> ensures each pair of possible values is encountered. The <code>vec</code> call reshapes an array into a vector.</p>
<p>Calling <code>arrows</code> on the prepared data produces the graphic:</p>
<pre class="{julia}"><code>arrows(pts, dus)</code></pre>
<p>The grid seems rotated at first glance; but is also confusing. This is due to the length of the vectors as the <span class="math inline">\((x,y)\)</span> values get farther from the origin. Plotting the <em>normalized</em> values (each will have length <span class="math inline">\(1\)</span>) can be done easily using <code>norm</code> (which is found in the standard <code>LinearAlgebra</code> library):</p>
<pre class="{julia}"><code>dvs = dus ./ norm.(dus)
arrows(pts, dvs)</code></pre>
<p>The rotational pattern becomes much clearer now.</p>
<p>The <code>streamplot</code> function also illustrates this phenomenon. This implements an “algorithm [that] puts an arrow somewhere and extends the streamline in both directions from there. Then, it chooses a new position (from the remaining ones), repeating the the exercise until the streamline gets blocked, from which on a new starting point, the process repeats.”</p>
<p>The <code>streamplot</code> function expects a <code>Point</code> not a pair of values, so we adjust <code>f</code> slightly and call the function using the pattern <code>streamplot(g, xs, ys)</code>:</p>
<pre class="{julia}"><code>f(x, y) = [y, -x]
g(xs) = Point2(f(xs...))

streamplot(g, -5..5, -5..5)</code></pre>
<p>(We used interval notation to set the viewing range, a range could also be used.)</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The calling pattern of <code>streamplot</code> is different than other functions, such as <code>surface</code>, in that the function comes first.</p>
</div>
</div>
</section>
<section id="layoutables-and-observables" class="level2" data-number="67.7">
<h2 data-number="67.7" class="anchored" data-anchor-id="layoutables-and-observables"><span class="header-section-number">67.7</span> Layoutables and Observables</h2>
<section id="layoutables" class="level3" data-number="67.7.1">
<h3 data-number="67.7.1" class="anchored" data-anchor-id="layoutables"><span class="header-section-number">67.7.1</span> Layoutables</h3>
<p><code>Makie</code> makes it really easy to piece together figures from individual plots. To illustrate, we create a graphic consisting of a plot of a function, its derivative, and its second derivative. In our graphic, we also leave space for a label.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Layout <a href="https://makie.juliaplots.org/stable/tutorials/layout-tutorial/">Tutorial</a> has <em>much</em> more detail on this subject.</p>
</div>
</div>
<p>The basic plotting commands, like <code>lines</code>, return a <code>FigureAxisPlot</code> object. For laying out our own graphic, we manage the figure and axes manually. The commands below create a figure, then assign axes to portions of the figure:</p>
<pre class="{julia}"><code>F = Figure()
af   = F[2,1:2]   = Axis(F)
afp  = F[3,1:end] = Axis(F)
afpp = F[4,:]     = Axis(F)</code></pre>
<p>The axes are named <code>af</code>, <code>afp</code> and <code>afpp</code>, as they will hold the respective graphs. The key here is the use of matrix notation to layout the graphic in a grid. The first one is row 2 and columns 1 through 2; the second row 3 and again all columns, the third is row 4 and all columns.</p>
<p>In this figure, we want the <span class="math inline">\(x\)</span>-axis for each of the three graphics to be linked. This command ensures that:</p>
<pre class="{julia}"><code>linkxaxes!(af, afp, afpp);</code></pre>
<p>By linking axes, if one is updated, say through <code>xlims!</code>, the others will be as well.</p>
<p>We now plot our functions. The key here is the mutating form of <code>lines!</code> takes an axis object to mutate as its first argument:</p>
<pre class="{julia}"><code>f(x) = 8x^4 - 8x^2 + 1
fp(x) = 32x^3 - 16x
fpp(x) = 96x^2 - 16

xs = -1..1
lines!(af,   xs, f)
lines!(afp,  xs, fp)
lines!(afp,  xs, zero, color=:blue)
lines!(afpp, xs, fpp)
lines!(afpp, xs, zero, color=:blue);</code></pre>
<p>We can give title information to each axis:</p>
<pre class="{julia}"><code>af.title = "f"
afp.title = "fp"
afpp.title = "fpp";</code></pre>
<p>Finally, we add a label in the first row, but for illustration purposes, only use the first column.</p>
<pre class="{julia}"><code>Label(F[1,1], """
Plots of f and its first and second derivatives.
When the first derivative is zero, the function
f has relative extrema. When the second derivative
is zero, the function f has an inflection point.
""");</code></pre>
<p>Finally we display the figure:</p>
<pre class="{julia}"><code>F</code></pre>
</section>
<section id="observables" class="level3" data-number="67.7.2">
<h3 data-number="67.7.2" class="anchored" data-anchor-id="observables"><span class="header-section-number">67.7.2</span> Observables</h3>
<p>The basic components of a plot in <code>Makie</code> can be updated <a href="https://makie.juliaplots.org/stable/documentation/nodes/index.html#observables_interaction">interactively</a>. <code>Makie</code> uses the <code>Observables</code> package which allows complicated interactions to be modeled quite naturally. In the following we give a simple example.</p>
<p>In Makie, an <code>Observable</code> is a structure that allows its value to be updated, similar to an array. When changed, observables can trigger an event. Observables can rely on other observables, so events can be cascaded.</p>
<p>This simple example shows how an observable <code>h</code> can be used to create a collection of points representing a secant line. The figure shows the value for <code>h=3/2</code>.</p>
<pre class="{julia}"><code>f(x) = sqrt(x)
c = 1
xs = 0..3
h = Observable(3/2)

points = lift(h) do h
    xs = [0,c,c+h,3]
    tl = x -&gt; f(c) + (f(c+h)-f(c))/h * (x-c)
    [Point2(x, tl(x)) for x ∈ xs]
end

lines(xs, f)
lines!(points)
current_figure()</code></pre>
<p>We can update the value of <code>h</code> using <code>setindex!</code> notation (square brackets). For example, to see that the secant line is a good approximation to the tangent line as <span class="math inline">\(h \rightarrow 0\)</span> we can set <code>h</code> to be <code>1/4</code> and replot:</p>
<pre class="{julia}"><code>h[] = 1/4
current_figure()</code></pre>
<p>The line <code>h[] = 1/4</code> updated <code>h</code> which then updated <code>points</code> (a points is lifted up from <code>h</code>) which updated the graphic. (In these notes, we replot to see the change, but in an interactive session, the current <em>displayed</em> figure would be updated; no replotting would be necessary.)</p>
<p>Finally, this example shows how to add a slider to adjust the value of <code>h</code> with a mouse. The slider object is positioned along with a label using the grid reference, as before.</p>
<pre class="{julia}"><code>f(x) = sqrt(x)
c = 1
xs = 0..3

F = Figure()
ax = Axis(F[1,1:2])
h = Slider(F[2,2], range = 0.01:0.01:1.5, startvalue = 1.5)
Label(F[2,1], "Adjust slider to change `h`";
      justification = :left)

points = lift(h.value) do h
    xs = [0,c,c+h,3]
    tl = x-&gt; f(c) + (f(c+h)-f(c))/h * (x-c)
    [Point2(x, tl(x)) for x ∈ xs]
end

lines!(ax, xs, f)
lines!(ax, points)
current_figure()</code></pre>
<p>The slider value is “lifted” by its <code>value</code> component, as shown. Otherwise, the above is fairly similar to just using an observable for <code>h</code>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../alternatives/plotly_plotting.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../misc/getting_started_with_julia.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>