<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculus with Julia - 65&nbsp; The SciML suite of packages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../alternatives/plotly_plotting.html" rel="next">
<link href="../alternatives/symbolics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">Precalculus Concepts</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/numbers_types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/logical_expressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/ranges.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Graph of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Inverse of a Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">Limits</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">Derivatives</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve Sketching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor Polynomials and other Approximating Polynomials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">Integrals</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem or Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration By Parts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial Fractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of Mass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface Area</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">ODEs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">ODEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Euler’s method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">Differential vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Polar Coordinates and Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">Integral vector calculus</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Line and Surface Integrals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">The Gradient, Divergence, and Curl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Green’s Theorem, Stokes’ Theorem, and the Divergence Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Quick Review of Vector Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">Alternative packages</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Julia interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#symbolic-math-symbolics" id="toc-symbolic-math-symbolics" class="nav-link active" data-scroll-target="#symbolic-math-symbolics"><span class="toc-section-number">65.1</span>  Symbolic math (<code>Symbolics</code>)</a></li>
  <li><a href="#solving-equations" id="toc-solving-equations" class="nav-link" data-scroll-target="#solving-equations"><span class="toc-section-number">65.2</span>  Solving equations</a>
  <ul class="collapse">
  <li><a href="#linearsolve" id="toc-linearsolve" class="nav-link" data-scroll-target="#linearsolve"><span class="toc-section-number">65.2.1</span>  <code>LinearSolve</code></a></li>
  <li><a href="#nonlinearsolve" id="toc-nonlinearsolve" class="nav-link" data-scroll-target="#nonlinearsolve"><span class="toc-section-number">65.2.2</span>  <code>NonlinearSolve</code></a></li>
  <li><a href="#higher-dimensions" id="toc-higher-dimensions" class="nav-link" data-scroll-target="#higher-dimensions"><span class="toc-section-number">65.2.3</span>  Higher dimensions</a></li>
  <li><a href="#using-modelingtoolkit-to-model-a-non-linear-problem" id="toc-using-modelingtoolkit-to-model-a-non-linear-problem" class="nav-link" data-scroll-target="#using-modelingtoolkit-to-model-a-non-linear-problem"><span class="toc-section-number">65.2.4</span>  Using <code>ModelingToolkit</code> to model a non-linear problem</a></li>
  </ul></li>
  <li><a href="#optimization-optimization.jl" id="toc-optimization-optimization.jl" class="nav-link" data-scroll-target="#optimization-optimization.jl"><span class="toc-section-number">65.3</span>  Optimization (<code>Optimization.jl</code>)</a>
  <ul class="collapse">
  <li><a href="#two-dimensional" id="toc-two-dimensional" class="nav-link" data-scroll-target="#two-dimensional"><span class="toc-section-number">65.3.1</span>  Two dimensional</a></li>
  </ul></li>
  <li><a href="#integration-integrals.jl" id="toc-integration-integrals.jl" class="nav-link" data-scroll-target="#integration-integrals.jl"><span class="toc-section-number">65.4</span>  Integration (<code>Integrals.jl</code>)</a>
  <ul class="collapse">
  <li><a href="#higher-dimension-integrals" id="toc-higher-dimension-integrals" class="nav-link" data-scroll-target="#higher-dimension-integrals"><span class="toc-section-number">65.4.1</span>  Higher dimension integrals</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/alternatives/SciML.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>The <code>Julia</code> ecosystem advances rapidly. For much of it, the driving force is the <a href="https://github.com/SciML">SciML</a> organization (Scientific Machine Learning).</p>
<p>In this section we describe some packages provided by this organization that could be used as alternatives to the ones utilized in these notes. Members of this organization created many packages for solving different types of differential equations, and have branched out from there. Many newer efforts of this organization have been to write uniform interfaces to other packages in the ecosystem, some of which are discussed below. We don’t discuss this key promise of SciML: “Performance is considered a priority, and performance issues are considered bugs,” as we don’t pursue features like in-place modification, sparsity, etc. Interested readers should consult the relevant packages documentation.</p>
<p>The basic structure to use these packages is the “problem-algorithm-solve” interface described in <a href="../ODEs/solve.html">The problem-algorithm-solve interface</a> sectino. We also discussed this interface a bit in <a href="../ODEs/differential_equations.html">ODEs</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These packages are in a process of rapid development and change to them is expected.</p>
</div>
</div>
<section id="symbolic-math-symbolics" class="level2" data-number="65.1">
<h2 data-number="65.1" class="anchored" data-anchor-id="symbolic-math-symbolics"><span class="header-section-number">65.1</span> Symbolic math (<code>Symbolics</code>)</h2>
<p>The <code>Symbolics</code>, <code>SymbolicUtils</code>, and <code>ModelingToolkit</code> packages are provided by this organization. These can be viewed as an alternative to <code>SymPy</code>, which is used throughout this set of notes. See the section on <a href="./symbolics.html">Symbolics</a> for some additional details, the package <a href="https://symbolics.juliasymbolics.org/stable/">documentation</a>, or the documentation for <a href="https://github.com/JuliaSymbolics/SymbolicUtils.jl">SymbolicsUtils</a>.</p>
</section>
<section id="solving-equations" class="level2" data-number="65.2">
<h2 data-number="65.2" class="anchored" data-anchor-id="solving-equations"><span class="header-section-number">65.2</span> Solving equations</h2>
<p>Solving one or more equations (simultaneously) is different in the linear case (where solutions are readily found – though performance can distinguish approaches) and the nonlinear case – where for most situations, numeric approaches are required.</p>
<section id="linearsolve" class="level3" data-number="65.2.1">
<h3 data-number="65.2.1" class="anchored" data-anchor-id="linearsolve"><span class="header-section-number">65.2.1</span> <code>LinearSolve</code></h3>
<p>The <code>LinearSolve</code> package aims to generalize the solving of linear equations. For many cases these are simply represented as matrix equations of the form <code>Ax=b</code>, from which <code>Julia</code> (borrowing from MATLAB) offers the interface <code>A \ b</code> to yield <code>x</code>. There are scenarios that don’t naturally fit this structure and perhaps problems where different tolerances need to be specified, and the <code>LinearSolve</code> package aims to provide a common interface to handle these scenarios. As this set of notes doesn’t bump into such, this package is not described here. In the symbolic case, the <code>Symbolics.solve_for</code> function was described in <a href="./symbolics.html">Symbolics</a>.</p>
</section>
<section id="nonlinearsolve" class="level3" data-number="65.2.2">
<h3 data-number="65.2.2" class="anchored" data-anchor-id="nonlinearsolve"><span class="header-section-number">65.2.2</span> <code>NonlinearSolve</code></h3>
<p>The <code>NonlinearSolve</code> package can be seen as an alternative to the use of the <code>Roots</code> package in this set of notes. The package presents itself as “Fast implementations of root finding algorithms in Julia that satisfy the SciML common interface.”</p>
<p>The package is loaded through the following command:</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">NonlinearSolve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Unlike <code>Roots</code>, the package handles problems beyond the univariate case, as such, the simplest problems have a little extra setup required.</p>
<p>For example, suppose we want to use this package to solve for zeros of <span class="math inline">\(f(x) = x^5 - x - 1\)</span>. We could do so a few different ways.</p>
<p>An approach that most closely mirrors that of <code>Roots</code> would be:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> x<span class="op">^</span><span class="fl">5</span> <span class="op">-</span> x <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(f, <span class="fl">1.0</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>u: 1.1673039782614187</code></pre>
</div>
</div>
<p>The <code>NewtonRaphson</code> method uses a derivative of <code>f</code>, which <code>NonlinearSolve</code> computes using automatic differentiation.</p>
<p>However, it is more performant and not much more work to allow for a vector of starting values. For this, <code>f</code> can be defined as:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(u, p) <span class="op">=</span> @. (u<span class="op">^</span><span class="fl">5</span> <span class="op">-</span> u <span class="op">-</span> <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>f (generic function with 1 method)</code></pre>
</div>
</div>
<p>The function definition expects a container for the “<code>x</code>” variables and allows the passing of a container to hold parameters. We could have used the dotted operations for the power and each subtraction to allow vectorization of these basic math operations, as <code>u</code> is a container of values. The <code>@.</code> macro makes adding the “dots” quite easy, as illustrated above. It converts “every function call or operator in expr into a <code>dot call</code>.”</p>
<p>A problem is set up with this function and an initial guess. The <code>@SVector</code> specification for the guess is for performance purposes and is provided by the <code>StaticArrays</code> package.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StaticArrays</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="pp">@SVector</span>[<span class="fl">1.0</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(f, u0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">NonlinearProblem</span> with uType <span class="ansi-cyan-fg">SVector{1, Float64}</span>. In-place: <span class="ansi-cyan-fg">false</span>
u0: 1-element SVector{1, Float64} with indices SOneTo(1):
 1.0</pre>
</div>
</div>
</div>
<p>The problem is solved by calling <code>solve</code> with an appropriate method specified. Here we use Newton’s method.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>u: 1-element SVector{1, Float64} with indices SOneTo(1):
 1.1673039782614187</code></pre>
</div>
</div>
<p>Again, the derivative of <code>f</code> is computed automatically.</p>
<p>The basic interface for retrieving the numeric solution from the solution object is to use indexing:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>soln[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>1.1673039782614187</code></pre>
</div>
</div>
<hr>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This interface is more performant than <code>Roots</code>, though it isn’t an apples to oranges comparison, as different stopping criteria are used by the two. In order to compare, we help out the call to <code>NonlinearProblem</code> to indicate the problem is non-mutating by adding a “<code>false</code>”, as follows:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">solve</span>(<span class="fu">NonlinearProblem</span><span class="dt">{false}</span>(f, <span class="pp">@SVector</span>[<span class="fl">1.0</span>]), <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  365.044 ns (0 allocations: 0 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>u: 1-element SVector{1, Float64} with indices SOneTo(1):
 1.1673039782614187</code></pre>
</div>
</div>
<p>As compared to:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Roots</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">ForwardDiff</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">5</span> <span class="op">-</span> x <span class="op">-</span> <span class="fl">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gp</span>(x) <span class="op">=</span> ForwardDiff.<span class="fu">derivative</span>(g, x)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">solve</span>(Roots.<span class="fu">ZeroProblem</span>((g, gp), <span class="fl">1.0</span>), Roots.<span class="fu">Newton</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  410.430 ns (0 allocations: 0 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>1.1673039782614187</code></pre>
</div>
</div>
</div>
</div>
<p>This problem can also be solved using a bracketing method. The package has both <code>Bisection</code> and <code>Falsi</code> as possible methods. To use a bracketing method, the initial bracket must be specified.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> (<span class="fl">1.0</span>, <span class="fl">2.0</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(f, u0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">NonlinearProblem</span> with uType <span class="ansi-cyan-fg">Tuple{Float64, Float64}</span>. In-place: <span class="ansi-cyan-fg">false</span>
u0: (1.0, 2.0)</pre>
</div>
</div>
</div>
<p>And</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">Bisection</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>u: 1.1673039782614185</code></pre>
</div>
</div>
<hr>
<p>Incorporating parameters is readily done. For example to solve <span class="math inline">\(f(x) = \cos(x) - x/p\)</span> for different values of <span class="math inline">\(p\)</span> we might have:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> @. <span class="fu">cos</span>(x) <span class="op">-</span> x<span class="op">/</span>p</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> (<span class="fl">0</span>, <span class="cn">pi</span><span class="op">/</span><span class="fl">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(f, u0, p)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">Bisection</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>u: 1.0298665293222586</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>insignificant</em> difference in stopping criteria used by <code>NonlinearSolve</code> and <code>Roots</code> is illustrated in this example, where the value returned by <code>NonlinearSolve</code> differs by one floating point value:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>an <span class="op">=</span> <span class="fu">solve</span>(<span class="fu">NonlinearProblem</span><span class="dt">{false}</span>(f, u0, p), <span class="fu">Bisection</span>())</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ar <span class="op">=</span> <span class="fu">solve</span>(Roots.<span class="fu">ZeroProblem</span>(f, u0), Roots.<span class="fu">Bisection</span>(); p<span class="op">=</span>p)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nextfloat</span>(an[]) <span class="op">==</span> ar, <span class="fu">f</span>(an[], p), <span class="fu">f</span>(ar, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(true, 2.220446049250313e-16, 0.0)</code></pre>
</div>
</div>
</div>
</div>
<p>We can solve for several parameters at once, by using a matching number of initial positions as follows:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="pp">@SVector</span>[<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(f, u0, ps)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>u: 4-element SVector{4, Float64} with indices SOneTo(4):
 0.7390851332151607
 1.0298665293222589
 1.1701209500026262
 1.2523532340025887</code></pre>
</div>
</div>
</section>
<section id="higher-dimensions" class="level3" data-number="65.2.3">
<h3 data-number="65.2.3" class="anchored" data-anchor-id="higher-dimensions"><span class="header-section-number">65.2.3</span> Higher dimensions</h3>
<p>We solve now for a point on the surface of the following <code>peaks</code> function where the gradient is <span class="math inline">\(0\)</span>. (The gradient here will be a vector-valued function from <span class="math inline">\(R^2\)</span> to <span class="math inline">\(R^2.\)</span>) First we define the function:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">_peaks</span>(x, y)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> (<span class="fl">1</span> <span class="op">-</span> x)<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> (y <span class="op">+</span> <span class="fl">1</span>)<span class="op">^</span><span class="fl">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    p <span class="op">-=</span> <span class="fl">10</span> <span class="op">*</span> (x <span class="op">/</span> <span class="fl">5</span> <span class="op">-</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span> y<span class="op">^</span><span class="fl">5</span>) <span class="op">*</span> <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> y<span class="op">^</span><span class="fl">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    p <span class="op">-=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span> <span class="op">*</span> <span class="fu">exp</span>(<span class="fu">-</span>(x <span class="op">+</span> <span class="fl">1</span>)<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> y<span class="op">^</span><span class="fl">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">peaks</span>(u) <span class="op">=</span> <span class="fu">_peaks</span>(u[<span class="fl">1</span>], u[<span class="fl">2</span>])  <span class="co"># pass container, take first two components</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>peaks (generic function with 1 method)</code></pre>
</div>
</div>
<p>The gradient can be computed different ways within <code>Julia</code>, but here we use the fact that the <code>ForwardDiff</code> package is loaded by <code>NonlinearSolve</code>. Once the function is defined, the pattern is similar to above. We provide a starting point, create a problem, then solve:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">∇peaks</span>(x, p<span class="op">=</span><span class="cn">nothing</span>) <span class="op">=</span> NonlinearSolve.ForwardDiff.<span class="fu">gradient</span>(peaks, x)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> <span class="pp">@SVector</span>[<span class="fl">1.0</span>, <span class="fl">1.0</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(∇peaks, u0)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>u: 2-element SVector{2, Float64} with indices SOneTo(2):
 1.098272834335093
 0.8544609795247524</code></pre>
</div>
</div>
<p>We can see that this identified value is a “zero” through:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">∇peaks</span>(u.u)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>2-element SVector{2, Float64} with indices SOneTo(2):
 -8.257283745649602e-16
 -6.951904329977054e-16</code></pre>
</div>
</div>
</section>
<section id="using-modelingtoolkit-to-model-a-non-linear-problem" class="level3" data-number="65.2.4">
<h3 data-number="65.2.4" class="anchored" data-anchor-id="using-modelingtoolkit-to-model-a-non-linear-problem"><span class="header-section-number">65.2.4</span> Using <code>ModelingToolkit</code> to model a non-linear problem</h3>
<p>Nonlinear problems can also be approached symbolically using the <code>ModelingToolkit</code> package. There is one additional step necessary.</p>
<p>As an example, we look to solve numerically for the zeros of <span class="math inline">\(x^5-x-\alpha\)</span> for a parameter <span class="math inline">\(\alpha\)</span>. We can describe this equation as follows:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ModelingToolkit</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@variables</span> x</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="pp">@parameters</span> α</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>eq <span class="op">=</span> x<span class="op">^</span><span class="fl">5</span> <span class="op">-</span> x <span class="op">-</span> α <span class="op">~</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>x^5 - x - α ~ 0</code></pre>
</div>
</div>
<p>The extra step is to specify a “<code>NonlinearSystem</code>.” It is a system, as in practice one or more equations can be considered. The <code>NonlinearSystem</code>constructor handles the details where the equation, the variable, and the parameter are specified. Below this is done using vectors with just one element:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ns <span class="op">=</span> <span class="fu">NonlinearSystem</span>([eq], [x], [α], name<span class="op">=:</span>ns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div class="ansi-escaped-output">
<pre><span class="ansi-bold">Model ns with 1 </span><span class="ansi-bold">equations</span>
<span class="ansi-bold">States (1):</span>
  x
<span class="ansi-bold">Parameters (1):</span>
  α</pre>
</div>
</div>
</div>
<p>The <code>name</code> argument is special. The name of the object (<code>ns</code>) is assigned through <code>=</code>, but the system must also know this same name. However, the name on the left is not known when the name on the right is needed, so it is up to the user to keep them synchronized. The <code>@named</code> macro handles this behind the scenes by simply rewriting the syntax of the assignment:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@named</span> ns <span class="op">=</span> <span class="fu">NonlinearSystem</span>([eq], [x], [α])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div class="ansi-escaped-output">
<pre><span class="ansi-bold">Model ns with 1 </span><span class="ansi-bold">equations</span>
<span class="ansi-bold">States (1):</span>
  x
<span class="ansi-bold">Parameters (1):</span>
  α</pre>
</div>
</div>
</div>
<p>With the system defined, we can pass this to <code>NonlinearProblem</code>, as was done with a function. The parameter is specified here, and in this case is <code>α =&gt; 1.0</code>. The initial guess is <code>[1.0]</code>:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">NonlinearProblem</span>(ns, [<span class="fl">1.0</span>], [α <span class="op">=&gt;</span> <span class="fl">1.0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">NonlinearProblem</span> with uType <span class="ansi-cyan-fg">Vector{Float64}</span>. In-place: <span class="ansi-cyan-fg">true</span>
u0: 1-element Vector{Float64}:
 1.0</pre>
</div>
</div>
</div>
<p>The problem is solved as before:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">NewtonRaphson</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: `vendor()` is deprecated, use `BLAS.get_config()` and inspect the output instead
│   caller = (::NonlinearSolve.DefaultLinSolve)(x::Vector{Float64}, A::Matrix{Float64}, b::Vector{Float64}, update_matrix::Bool; tol::Nothing, kwargs::Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}) at utils.jl:124
└ @ NonlinearSolve /Users/verzani/.julia/packages/NonlinearSolve/hDIt1/src/utils.jl:124</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>u: 1-element Vector{Float64}:
 1.1673040828230086</code></pre>
</div>
</div>
</section>
</section>
<section id="optimization-optimization.jl" class="level2" data-number="65.3">
<h2 data-number="65.3" class="anchored" data-anchor-id="optimization-optimization.jl"><span class="header-section-number">65.3</span> Optimization (<code>Optimization.jl</code>)</h2>
<p>We describe briefly the <code>Optimization</code> package which provides a common interface to <em>numerous</em> optimization packages in the <code>Julia</code> ecosystem. We discuss only the interface for <code>Optim.jl</code> defined in <code>OptimizationOptimJL</code>.</p>
<p>We begin with a standard example from first semester calculus:</p>
<blockquote class="blockquote">
<p>Among all rectangles of fixed perimeter, find the one with the <em>maximum</em> area.</p>
</blockquote>
<p>If the perimeter is taken to be <span class="math inline">\(25\)</span>, the mathematical setup has a constraint (<span class="math inline">\(P=25=2x+2y\)</span>) and an objective (<span class="math inline">\(A=xy\)</span>) to maximize. In this case, the function to <em>maximize</em> is <span class="math inline">\(A(x) = x \cdot (25-2x)/2\)</span>. This is easily done different ways, such as finding the one critical point and identifying this as the point of maximum.</p>
<p>To do this last step using the <code>Optimization</code> package, we must first load the package <strong>and</strong> the underlying backend glue code we intend to use:</p>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optimization</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">OptimizationOptimJL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Our objective function is defined using an intermediate function derived from the constraint:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">height</span>(x) <span class="op">=</span> @. (<span class="fl">25</span> <span class="op">-</span> <span class="fl">2</span>x)<span class="op">/</span><span class="fl">2</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">A</span>(x, p<span class="op">=</span><span class="cn">nothing</span>) <span class="op">=</span> @.(<span class="op">-</span> x <span class="op">*</span> <span class="fu">height</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>A (generic function with 2 methods)</code></pre>
</div>
</div>
<p>The minus sign is needed here as optimization routines find <em>minimums</em>, not maximums.</p>
<p>Next, we define an optimization function with information on how its derivatives will be taken. The following uses <code>ForwardDiff</code>, which is a good choice in the typical calculus setting, where there are a small number of inputs (just <span class="math inline">\(1\)</span> here.)</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> <span class="fu">OptimizationFunction</span>(A, Optimization.<span class="fu">AutoForwardDiff</span>())</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> [<span class="fl">4.0</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">OptimizationProblem</span>(F, x0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">OptimizationProblem</span>. In-place: <span class="ansi-cyan-fg">true</span>
u0: 1-element Vector{Float64}:
 4.0</pre>
</div>
</div>
</div>
<p>The problem is solved through the common interface with a specified method, in this case <code>Newton</code>:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">Newton</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>u: 1-element Vector{Float64}:
 6.25</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We use the method <code>Newton</code> and not <code>NewtonRaphson</code>, as above. Both methods are similar, but they come from different packages – the latter for solving non-linear equation(s), the former for solving optimization problems.</p>
</div>
</div>
<p>The solution is an object containing the identified answer and more. To get the value, use index notation:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>soln[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>6.25</code></pre>
</div>
</div>
<p>The corresponding <span class="math inline">\(y\)</span> value and area are found by:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>xstar <span class="op">=</span> soln[]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">height</span>(xstar), <span class="fu">A</span>(xstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>(6.25, -39.0625)</code></pre>
</div>
</div>
<p>The <code>minimum</code> property also holds the identified minimum:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>soln.minimum  <span class="co"># compare with A(soln[], nothing)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>-39.0625</code></pre>
</div>
</div>
<p>The package is a wrapper around other packages. The output of the underlying package is presented in the <code>original</code> property:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>soln.original</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code> * Status: success

 * Candidate solution
    Final objective value:     -3.906250e+01

 * Found with
    Algorithm:     Newton's Method

 * Convergence measures
    |x - x'|               = 2.25e+00 ≰ 0.0e+00
    |x - x'|/|x'|          = 3.60e-01 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.06e+00 ≰ 0.0e+00
    |f(x) - f(x')|/|f(x')| = 1.30e-01 ≰ 0.0e+00
    |g(x)|                 = 0.00e+00 ≤ 1.0e-08

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    1
    f(x) calls:    2
    ∇f(x) calls:   2
    ∇²f(x) calls:  1</code></pre>
</div>
</div>
<hr>
<p>This problem can also be approached symbolically, using <code>ModelingToolkit</code>.</p>
<p>For example, we set up the problem with:</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ModelingToolkit</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@parameters</span> P</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@variables</span> x</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> (P <span class="op">-</span> <span class="fl">2</span>x)<span class="op">/</span><span class="fl">2</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>Area <span class="op">=</span> <span class="op">-</span> x<span class="op">*</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>-x*((1//2)*P - x)</code></pre>
</div>
</div>
<p>The above should be self explanatory. To put into a form to pass to <code>solve</code> we define a “system” by specifying our objective function, the variables, and the parameters.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@named</span> sys <span class="op">=</span> <span class="fu">OptimizationSystem</span>(Area, [x], [P])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div class="ansi-escaped-output">
<pre><span class="ansi-bold">Model sys</span>
<span class="ansi-bold">States (1):</span>
  x
<span class="ansi-bold">Parameters (1):</span>
  P</pre>
</div>
</div>
</div>
<p>(This step is different, as before an <code>OptimizationFunction</code> was defined; we use <code>@named</code>, as above, to ensure the system has the same name as the identifier, <code>sys</code>.)</p>
<p>This system is passed to <code>OptimizationProblem</code> along with a specification of the initial condition (<span class="math inline">\(x=4\)</span>) and the perimeter (<span class="math inline">\(P=25\)</span>). A vector of pairs is used below:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">OptimizationProblem</span>(sys, [x <span class="op">=&gt;</span> <span class="fl">4.0</span>], [P <span class="op">=&gt;</span> <span class="fl">25.0</span>]; grad<span class="op">=</span><span class="cn">true</span>, hess<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">OptimizationProblem</span>. In-place: <span class="ansi-cyan-fg">true</span>
u0: 1-element Vector{Float64}:
 4.0</pre>
</div>
</div>
</div>
<p>The keywords <code>grad=true</code> and <code>hess=true</code> instruct for automatic derivatives to be taken as needed. These are needed in the choice of method, <code>Newton</code>, below.</p>
<p>Solving this problem then follows the same pattern as before, again with <code>Newton</code> we have:</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">Newton</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>u: 1-element Vector{Float64}:
 6.25</code></pre>
</div>
</div>
<p>(A derivative-free method like <code>NelderMead()</code> could be used and then the <code>grad</code> and <code>hess</code> keywords above would be unnecessary, though not harmful.)</p>
<hr>
<p>The related calculus problem:</p>
<blockquote class="blockquote">
<p>Among all rectangles with a fixed area, find the one with <em>minimum</em> perimeter</p>
</blockquote>
<p>could be similarly approached:</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@parameters</span> Area</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@variables</span> x</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Area<span class="op">/</span>x  <span class="co"># from A = xy</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fl">2</span>x <span class="op">+</span> <span class="fl">2</span>y</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@named</span> sys <span class="op">=</span> <span class="fu">OptimizationSystem</span>(P, [x], [Area])</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> [x <span class="op">=&gt;</span> <span class="fl">4.0</span>]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> [Area <span class="op">=&gt;</span> <span class="fl">25.0</span>]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">OptimizationProblem</span>(sys, u0, p; grad<span class="op">=</span><span class="cn">true</span>, hess<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">LBFGS</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>u: 1-element Vector{Float64}:
 5.000000000274741</code></pre>
</div>
</div>
<p>We used an initial guess of <span class="math inline">\(x=4\)</span> above. The <code>LBFGS</code> method is a computationally efficient modification of the Broyden-Fletcher-Goldfarb-Shanno algorithm … It is a quasi-Newton method that updates an approximation to the Hessian using past approximations as well as the gradient.” On this problem it performs similarly to <code>Newton</code>, though in general may be preferable for higher-dimensional problems.</p>
<section id="two-dimensional" class="level3" data-number="65.3.1">
<h3 data-number="65.3.1" class="anchored" data-anchor-id="two-dimensional"><span class="header-section-number">65.3.1</span> Two dimensional</h3>
<p>Scalar functions of two input variables can have their minimum value identified in the same manner using <code>Optimization.jl</code>.</p>
<p>For example, consider the function</p>
<p><span class="math display">\[
f(x,y) = (x + 2y - 7)^2 + (2x + y - 5)^2
\]</span></p>
<p>We wish to minimize this function.</p>
<p>We begin by defining a function in <code>Julia</code>:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f</span>(u, p)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> u</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    (x <span class="op">+</span> <span class="fl">2</span>y <span class="op">-</span> <span class="fl">7</span>)<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> (<span class="fl">2</span>x <span class="op">+</span> y <span class="op">-</span> <span class="fl">5</span>)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>f (generic function with 1 method)</code></pre>
</div>
</div>
<p>We turn this into an optimization function by specifying how derivatives will be taken, as we will the <code>LBFGS</code> algorithm below:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ff <span class="op">=</span> <span class="fu">OptimizationFunction</span>(f, Optimization.<span class="fu">AutoForwardDiff</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(::OptimizationFunction{true, Optimization.AutoForwardDiff{nothing}, typeof(f), Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}) (generic function with 1 method)</code></pre>
</div>
</div>
<p>We will begin our search at the origin. We have to be mindful to use floating point numbers here:</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> [<span class="fl">0.0</span>, <span class="fl">0.0</span>] <span class="co"># or zeros(2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>2-element Vector{Float64}:
 0.0
 0.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">OptimizationProblem</span>(ff, u0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">OptimizationProblem</span>. In-place: <span class="ansi-cyan-fg">true</span>
u0: 2-element Vector{Float64}:
 0.0
 0.0</pre>
</div>
</div>
</div>
<p>Finally, we solve the values:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">LBFGS</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>u: 2-element Vector{Float64}:
 1.0000000000000004
 3.0</code></pre>
</div>
</div>
<p>The value of <span class="math inline">\((1, 3)\)</span> agrees with the contour graph, as it is a point in the interior of the contour for the smallest values displayed.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0</span>, <span class="fl">2</span>, length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> <span class="fu">range</span>(<span class="fl">2</span>, <span class="fl">4</span>, length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(xs, ys,  (x,y) <span class="op">-&gt;</span> <span class="fu">f</span>((x,y), <span class="cn">nothing</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<p><img src="SciML_files/figure-html/cell-41-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>We could also use a <em>derivative-free</em> method, and skip a step:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">OptimizationProblem</span>(f, u0) <span class="co"># skip making an OptimizationFunction</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">NelderMead</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>u: 2-element Vector{Float64}:
 1.0000084245371434
 2.9999988246128764</code></pre>
</div>
</div>
</section>
</section>
<section id="integration-integrals.jl" class="level2" data-number="65.4">
<h2 data-number="65.4" class="anchored" data-anchor-id="integration-integrals.jl"><span class="header-section-number">65.4</span> Integration (<code>Integrals.jl</code>)</h2>
<p>The <code>Integrals</code> package provides a common interface to different numeric integration packages in the <code>Julia</code> ecosystem. For example, <code>QuadGK</code> and <code>HCubature</code>. The value of this interface, over those two packages, is its non-differentiated access to other packages, which for some uses may be more performant.</p>
<p>The package follows the same <code>problem-algorithm-solve</code> interface, as already seen.</p>
<p>The interface is designed for <span class="math inline">\(1\)</span>-and-higher dimensional integrals.</p>
<p>The package is loaded with</p>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Integrals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For a simple definite integral, such as <span class="math inline">\(\int_0^\pi \sin(x)dx\)</span>, we have:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, <span class="fl">0.0</span>, <span class="cn">pi</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">QuadGKJL</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>u: 2.0</code></pre>
</div>
</div>
<p>To get access to the answer, we can use indexing notation:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>soln[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>2.0</code></pre>
</div>
</div>
<p>Comparing to just using <code>QuadGK</code>, the same definite integral would be estimated with:</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QuadGK</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(sin, <span class="fl">0</span>, <span class="cn">pi</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>(2.0, 1.7905676941154525e-12)</code></pre>
</div>
</div>
<p>The estimated upper bound on the error from <code>QuadGK</code>, is available through the <code>resid</code> property on the <code>Integrals</code> output:</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>soln.resid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>1.7905676941154525e-12</code></pre>
</div>
</div>
<p>The <code>Integrals</code> solution is a bit more verbose, but it is more flexible. For example, the <code>HCubature</code> package provides a similar means to compute <span class="math inline">\(n\)</span>- dimensional integrals. For this problem, the modifications would be:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> <span class="fu">sin</span>.(x)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, [<span class="fl">0.0</span>], [<span class="cn">pi</span>])</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">HCubatureJL</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>u: 1-element SVector{1, Float64} with indices SOneTo(1):
 2.0000000000000004</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>soln[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>2.0000000000000004</code></pre>
</div>
</div>
<p>The estimated maximum error is also given by <code>resid</code>:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>soln.resid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>1.7896795156957523e-12</code></pre>
</div>
</div>
<hr>
<p>As well, suppose we wanted to parameterize our function and then differentiate.</p>
<p>Consider <span class="math inline">\(d/dp \int_0^\pi \sin(px) dx\)</span>. We can do this integral directly to get</p>
<p><span class="math display">\[
\begin{align*}
\frac{d}{dp} \int_0^\pi \sin(px)dx
&amp;= \frac{d}{dp}\left( \frac{-1}{p} \cos(px)\Big\rvert_0^\pi\right)\\
&amp;= \frac{d}{dp}\left( -\frac{\cos(p\cdot\pi)-1}{p}\right)\\
&amp;= \frac{\cos(p\cdot \pi) - 1)}{p^2} + \frac{\pi\cdot\sin(p\cdot\pi)}{p}
\end{align*}
\]</span></p>
<p>Using <code>Integrals</code> with <code>QuadGK</code> we have:</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> <span class="fu">sin</span>(p<span class="op">*</span>x)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">∫sinpx</span>(p)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, <span class="fl">0.0</span>, <span class="cn">pi</span>, p)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">solve</span>(prob, <span class="fu">QuadGKJL</span>())</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>∫sinpx (generic function with 1 method)</code></pre>
</div>
</div>
<p>We can compute values at both <span class="math inline">\(p=1\)</span> and <span class="math inline">\(p=2\)</span>:</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">∫sinpx</span>(<span class="fl">1</span>), <span class="fu">∫sinpx</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>(fill(2.0), fill(-1.6146076008187368e-16))</code></pre>
</div>
</div>
<p>To find the derivative in <span class="math inline">\(p\)</span> , we have:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>ForwardDiff.<span class="fu">derivative</span>(∫sinpx, <span class="fl">1</span>), ForwardDiff.<span class="fu">derivative</span>(∫sinpx, <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>(fill(-1.9999999999999993), fill(-6.975736996017264e-16))</code></pre>
</div>
</div>
<p>(In <code>QuadGK</code>, the following can be differentiated <code>∫sinpx(p) = quadgk(x -&gt; sin(p*x), 0, pi)[1]</code> as well. <code>Integrals</code> gives a consistent interface.</p>
<section id="higher-dimension-integrals" class="level3" data-number="65.4.1">
<h3 data-number="65.4.1" class="anchored" data-anchor-id="higher-dimension-integrals"><span class="header-section-number">65.4.1</span> Higher dimension integrals</h3>
<p>The power of a common interface is the ability to swap backends and the uniformity for different dimensions. Here we discuss integrals of scalar-valued and vector-valued functions.</p>
<section id="f-rn-rightarrow-r" class="level4">
<h4 class="anchored" data-anchor-id="f-rn-rightarrow-r"><span class="math inline">\(f: R^n \rightarrow R\)</span></h4>
<p>The area under a surface generated by <span class="math inline">\(z=f(x,y)\)</span> over a rectangular region <span class="math inline">\([a,b]\times[c,d]\)</span> can be readily computed. The two coding implementations require <span class="math inline">\(f\)</span> to be expressed as a function of a vector–<em>and</em> a parameter–and the interval to be expressed using two vectors, one for the left endpoints (<code>[a,c]</code>) and on for the right endpoints (<code>[b,d]</code>).</p>
<p>For example, the area under the function <span class="math inline">\(f(x,y) = 1 + x^2 + 2y^2\)</span> over <span class="math inline">\([-1/2, 1/2] \times [-1,1]\)</span> is computed by:</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, y) <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">2</span>y<span class="op">^</span><span class="fl">2</span>  <span class="co"># match math</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fxp</span>(x, p) <span class="op">=</span> <span class="fu">f</span>(x[<span class="fl">1</span>], x[<span class="fl">2</span>]) <span class="co"># prepare for IntegralProblem</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>ls <span class="op">=</span> [<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>]           <span class="co"># left endpoints</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>rs <span class="op">=</span> [<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span>]             <span class="co"># right endpoints</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(fxp, ls, rs)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">HCubatureJL</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>u: 3.5</code></pre>
</div>
</div>
<p>Of course, we could have directly defined the function (<code>fxp</code>) using indexing of the <code>x</code> variable.</p>
<hr>
<p>For non-rectangular domains a change of variable is required.</p>
<p>For example, an integral to assist in finding the volume of a sphere might be</p>
<p><span class="math display">\[
V = 2 \iint_R \sqrt{\rho^2 - x^2 - y^2} dx dy
\]</span></p>
<p>where <span class="math inline">\(R\)</span> is the disc of radius <span class="math inline">\(\rho\)</span> in the <span class="math inline">\(x-y\)</span> plane.</p>
<p>The usual approach is to change to polar-coordinates and write this integral as</p>
<p><span class="math display">\[
V = \int_0^{2\pi}\int_0^\rho \sqrt{\rho^2 - r^2} r dr d\theta
\]</span></p>
<p>the latter being an integral over a rectangular domain.</p>
<p>To compute this transformed integral, we might have:</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vol_sphere</span>(ρ)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f</span>(rθ, p) <span class="op">=</span> <span class="fu">sqrt</span>(ρ<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> rθ[<span class="fl">1</span>]<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> rθ[<span class="fl">1</span>]</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    ls <span class="op">=</span> [<span class="fl">0</span>,<span class="fl">0</span>]</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> [ρ, <span class="fl">2</span>pi]</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, ls, rs)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">solve</span>(prob, <span class="fu">HCubatureJL</span>())</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">vol_sphere</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>u: 16.75516082024234</code></pre>
</div>
</div>
<p>If it is possible to express the region to integrate as <span class="math inline">\(G(R)\)</span> where <span class="math inline">\(R\)</span> is a rectangular region, then the change of variables formula,</p>
<p><span class="math display">\[
\iint_{G(R)} f(x) dA = \iint_R (f\circ G)(u) |det(J_G(u)| dU
\]</span></p>
<p>turns the integral into the non-rectangular domain <span class="math inline">\(G(R)\)</span> into one over the rectangular domain <span class="math inline">\(R\)</span>. The key is to <em>identify</em> <span class="math inline">\(G\)</span> and to compute the Jacobian. The latter is simply accomplished with <code>ForwardDiff.jacobian</code>.</p>
<p>For an example, we find the moment of inertia about the axis of the unit square tilted counter-clockwise an angle <span class="math inline">\(0 \leq \alpha \leq \pi/2\)</span>.</p>
<p>The counter clockwise rotation of a unit square by angle <span class="math inline">\(\alpha\)</span> is described by</p>
<p><span class="math display">\[
G(u, v) = \langle \cos(\alpha)\cdot u - \sin(\alpha)\cdot v, \sin(\alpha)\cdot u, +\cos(\alpha)\cdot v \rangle
\]</span></p>
<p>So we have <span class="math inline">\(\iint_{G(R)} x^2 dA\)</span> is computed by the following with <span class="math inline">\(\alpha=\pi/4\)</span>:</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">LinearAlgebra</span>: det</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">𝑓</span>(uv) <span class="op">=</span> uv[<span class="fl">1</span>]<span class="op">^</span><span class="fl">2</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">G</span>(uv)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    α <span class="op">=</span> <span class="cn">pi</span><span class="op">/</span><span class="fl">4</span> <span class="co"># could be made a parameter</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    u,v <span class="op">=</span> uv</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">cos</span>(α)<span class="op">*</span>u <span class="op">-</span> <span class="fu">sin</span>(α)<span class="op">*</span>v, <span class="fu">sin</span>(α)<span class="op">*</span>u <span class="op">+</span> <span class="fu">cos</span>(α)<span class="op">*</span>v]</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(u, p) <span class="op">=</span> (𝑓<span class="op">∘</span>G)(u) <span class="op">*</span> <span class="fu">det</span>(ForwardDiff.<span class="fu">jacobian</span>(G, u))</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, [<span class="fl">0</span>,<span class="fl">0</span>], [<span class="fl">1</span>,<span class="fl">1</span>])</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">HCubatureJL</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>u: 0.08333333333333331</code></pre>
</div>
</div>
</section>
<section id="f-rn-rightarrow-rm" class="level4">
<h4 class="anchored" data-anchor-id="f-rn-rightarrow-rm"><span class="math inline">\(f: R^n \rightarrow R^m\)</span></h4>
<p>The <code>Integrals</code> package provides an interface for vector-valued functions. By default, the number of dimensions in the output is assumed to be <span class="math inline">\(1\)</span>, but the <code>nout</code> argument can adjust that.</p>
<p>Let <span class="math inline">\(f\)</span> be vector valued with components <span class="math inline">\(f_1, f_2, \dots, f_m\)</span>, then the output below is the vector with components <span class="math inline">\(\iint_R f_1 dV, \iint_R f_2 dV, \dots, \iint_R f_m dV\)</span>.</p>
<p>For a trivial example, we have:</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x, p) <span class="op">=</span> [x[<span class="fl">1</span>], x[<span class="fl">2</span>]<span class="op">^</span><span class="fl">2</span>]</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">IntegralProblem</span>(f, [<span class="fl">0</span>,<span class="fl">0</span>],[<span class="fl">3</span>,<span class="fl">4</span>], nout<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(prob, <span class="fu">HCubatureJL</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>u: 2-element Vector{Float64}:
 18.0
 63.999999999999986</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../alternatives/symbolics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../alternatives/plotly_plotting.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, John Verzani</div>
  </div>
</footer>



</body></html>